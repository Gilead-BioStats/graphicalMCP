<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A multiple comparison procedure (or multiple test procedure)
    is a a statistical analysis method for determining efficacy of
    multiple drugs, or multiple doses of the same drug, in a single
    clinical trial. (Bretz et al., 2011) laid out a graph-based approach to
    these multiple comparison procedures, in which the weights of the
    vertices and edges of the graph are determined independently of the
    particular statistical test used to assess results. This is a
    low-dependency implementation of the methods described in that and
    subsequent papers.">
<title>Graphical Approach for Multiple Comparison Procedures â€¢ graphicalMCP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Graphical Approach for Multiple Comparison Procedures">
<meta property="og:description" content="A multiple comparison procedure (or multiple test procedure)
    is a a statistical analysis method for determining efficacy of
    multiple drugs, or multiple doses of the same drug, in a single
    clinical trial. (Bretz et al., 2011) laid out a graph-based approach to
    these multiple comparison procedures, in which the weights of the
    vertices and edges of the graph are determined independently of the
    particular statistical test used to assess results. This is a
    low-dependency implementation of the methods described in that and
    subsequent papers.">
<meta property="og:image" content="https://urban-sniffle-p11zlpj.pages.github.io/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/case-study.html">case-study</a>
    <a class="dropdown-item" href="articles/test_power_considerations_2011.html">test_power_considerations_2011</a>
    <a class="dropdown-item" href="articles/testing-power-basics.html">Testing basics</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="graphicalmcp-">graphicalMCP <a class="anchor" aria-label="anchor" href="#graphicalmcp-"></a>
</h1>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A multiple comparison procedure (MCP) is a statistical analysis method that allows for assessing the efficacy of multiple endpoints, some of which are dependent on each other, in a single clinical trial. Endpoints can be different doses, treatment of different conditions, or combined superiority &amp; non-inferiority testing.</p>
<p>In <a href="https://onlinelibrary.wiley.com/doi/10.1002/bimj.201000239" class="external-link">Bretz et al (2011)</a>, a graphical method to MCPs was described, which separates the weighting of the dependency graph from the particular statistical test used to assess each endpoint. This package is a low-dependency implementation of those methods.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>graphicalMCP is not on CRAN, so install it from GitHub with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="http://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"Gilead-BioStats/graphicalMCP"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<div class="section level3">
<h3 id="initial-graph">Initial graph<a class="anchor" aria-label="anchor" href="#initial-graph"></a>
</h3>
<p>The base object in graphicalMCP is an <code>initial_graph</code>, which is a weighted, directed graph represented by a matrix of transition (edge) weights, and a vector of hypothesis (vertex) weights.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://urban-sniffle-p11zlpj.pages.github.io/">graphicalMCP</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A graphical multiple comparison procedure with two primary hypotheses (H1</span></span>
<span><span class="co"># and H2) and two secondary hypotheses (H3 and H4)</span></span>
<span><span class="co"># See Figure 1 in Bretz, F., Posch, M., Glimm, E., Klinglmueller, F., Maurer,</span></span>
<span><span class="co"># W., &amp; Rohmeyer, K. (2011). Graphical approaches for multiple comparison</span></span>
<span><span class="co"># procedures using weighted Bonferroni, Simes, or parametric tests. Biometrical</span></span>
<span><span class="co"># Journal, 53(6), 894-913.</span></span>
<span><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span></span>
<span><span class="va">g_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_graph.html">create_graph</a></span><span class="op">(</span><span class="va">hypotheses</span>, <span class="va">transitions</span>, <span class="va">names</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g_dose</span></span>
<span><span class="co">#&gt; An initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; A1: 0.5000</span></span>
<span><span class="co">#&gt; A2: 0.5000</span></span>
<span><span class="co">#&gt; B1: 0.0000</span></span>
<span><span class="co">#&gt; B2: 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;        A1     A2     B1     B2</span></span>
<span><span class="co">#&gt; A1 0.0000 0.0000 1.0000 0.0000</span></span>
<span><span class="co">#&gt; A2 0.0000 0.0000 0.0000 1.0000</span></span>
<span><span class="co">#&gt; B1 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; B2 1.0000 0.0000 0.0000 0.0000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="update-graph">Update graph<a class="anchor" aria-label="anchor" href="#update-graph"></a>
</h3>
<p>Hypotheses can be rejected from the MCP using <code><a href="reference/update_graph.html">update_graph()</a></code>. Updated weights and transitions are calculated according to the weighting strategy in <a href="https://onlinelibrary.wiley.com/doi/10.1002/bimj.201000239" class="external-link">Bretz et al (2011)</a></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/update_graph.html">update_graph</a></span><span class="op">(</span><span class="va">g_dose</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; A1: 0.5000</span></span>
<span><span class="co">#&gt; A2: 0.5000</span></span>
<span><span class="co">#&gt; B1: 0.0000</span></span>
<span><span class="co">#&gt; B2: 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;        A1     A2     B1     B2</span></span>
<span><span class="co">#&gt; A1 0.0000 0.0000 1.0000 0.0000</span></span>
<span><span class="co">#&gt; A2 0.0000 0.0000 0.0000 1.0000</span></span>
<span><span class="co">#&gt; B1 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypotheses kept ---</span></span>
<span><span class="co">#&gt;    A1    A2    B1   B2</span></span>
<span><span class="co">#&gt;  TRUE FALSE FALSE TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; An initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; A1: 0.5000</span></span>
<span><span class="co">#&gt; A2: 0.0000</span></span>
<span><span class="co">#&gt; B1: 0.0000</span></span>
<span><span class="co">#&gt; B2: 0.5000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;        A1     A2     B1     B2</span></span>
<span><span class="co">#&gt; A1 0.0000 0.0000 0.0000 1.0000</span></span>
<span><span class="co">#&gt; A2 0.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; B1 0.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; B2 1.0000 0.0000 0.0000 0.0000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-weights">Generate weights<a class="anchor" aria-label="anchor" href="#generate-weights"></a>
</h3>
<p>The weights of all sub-graphs can be calculated with <code><a href="reference/generate_weights.html">generate_weights()</a></code>. This uses more efficient code under the hood than <code><a href="reference/update_graph.html">update_graph()</a></code> in order to be performant for larger graphs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/generate_weights.html">generate_weights</a></span><span class="op">(</span><span class="va">g_dose</span><span class="op">)</span></span>
<span><span class="co">#&gt;    A1 A2 B1 B2  A1  A2  B1  B2</span></span>
<span><span class="co">#&gt; 1   1  1  1  1 0.5 0.5 0.0 0.0</span></span>
<span><span class="co">#&gt; 2   1  1  1  0 0.5 0.5 0.0 0.0</span></span>
<span><span class="co">#&gt; 3   1  1  0  1 0.5 0.5 0.0 0.0</span></span>
<span><span class="co">#&gt; 4   1  1  0  0 0.5 0.5 0.0 0.0</span></span>
<span><span class="co">#&gt; 5   1  0  1  1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt; 6   1  0  1  0 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 7   1  0  0  1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt; 8   1  0  0  0 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 9   0  1  1  1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt; 10  0  1  1  0 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt; 11  0  1  0  1 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 12  0  1  0  0 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 13  0  0  1  1 0.0 0.0 0.5 0.5</span></span>
<span><span class="co">#&gt; 14  0  0  1  0 0.0 0.0 1.0 0.0</span></span>
<span><span class="co">#&gt; 15  0  0  0  1 0.0 0.0 0.0 1.0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="test-hypotheses">Test hypotheses<a class="anchor" aria-label="anchor" href="#test-hypotheses"></a>
</h3>
<p>A mixture of statistical tests are supported in graphicalMCP. A graph can be tested against a given alpha with <code><a href="reference/testing.html">test_graph()</a></code>. A report is then generated, showing the graph &amp; test results.</p>
<p>In this example, a weighted Bonferroni test is applied to all hypotheses, with a threshold of 0.05. We can reject a given intersection hypothesis if any of the individual hypotheses within that sub-graph passes the test assigned to it. We can then reject a hypothesis globally if all intersection hypotheses containing that hypothesis are rejected. For instance, in this example we can reject every intersection hypothesis except the one containing only B1 &amp; B2 (Row 3 of <code>test_results</code>). Thus, we can reject the null hypotheses for A1 &amp; A2, but we cannot reject the null hypotheses for B1 &amp; B2.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/testing.html">test_graph</a></span><span class="op">(</span></span>
<span>  <span class="va">g_dose</span>,</span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.01</span>, <span class="fl">.02</span>, <span class="fl">.03</span>, <span class="fl">.05</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>  test_types <span class="op">=</span> <span class="st">"b"</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     A2     B1     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.0000 1.0000 0.0000</span></span>
<span><span class="co">#&gt;   A2 0.0000 0.0000 0.0000 1.0000</span></span>
<span><span class="co">#&gt;   B1 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          A1   A2   B1   B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.01 0.02 0.03 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1-A2-B1-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test summary ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1         0.02   TRUE</span></span>
<span><span class="co">#&gt;           A2         0.04   TRUE</span></span>
<span><span class="co">#&gt;           B1         0.06  FALSE</span></span>
<span><span class="co">#&gt;           B2         0.06  FALSE</span></span></code></pre></div>
<p>Simes and parametric testing methods are also supported, using the <code>test_types</code> argument. Try setting the <code>verbose</code> and <code>critical</code> flags for a more detailed report on testing.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/testing.html">test_graph</a></span><span class="op">(</span></span>
<span>  <span class="va">g_dose</span>,</span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.01</span>, <span class="fl">.02</span>, <span class="fl">.03</span>, <span class="fl">.05</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"s"</span><span class="op">)</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  critical <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     A2     B1     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.0000 1.0000 0.0000</span></span>
<span><span class="co">#&gt;   A2 0.0000 0.0000 0.0000 1.0000</span></span>
<span><span class="co">#&gt;   B1 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          A1   A2   B1   B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.01 0.02 0.03 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation matrix:     A1  A2 B1 B2</span></span>
<span><span class="co">#&gt;                       A1 1.0 0.5 NA NA</span></span>
<span><span class="co">#&gt;                       A2 0.5 1.0 NA NA</span></span>
<span><span class="co">#&gt;                       B1  NA  NA NA NA</span></span>
<span><span class="co">#&gt;                       B2  NA  NA NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   parametric: (A1-A2)</span></span>
<span><span class="co">#&gt;        simes: (B1-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test summary ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1         0.02   TRUE</span></span>
<span><span class="co">#&gt;           A2         0.04   TRUE</span></span>
<span><span class="co">#&gt;           B1         0.05   TRUE</span></span>
<span><span class="co">#&gt;           B2         0.05   TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test details - Adjusted p ------------------------------------------------------</span></span>
<span><span class="co">#&gt;       A1  A2  B1  B2 padj_grp1 padj_grp2 p_adj_inter res</span></span>
<span><span class="co">#&gt;   1  0.5 0.5 0.0 0.0  0.018706      1.00    0.018706   1</span></span>
<span><span class="co">#&gt;   2  0.5 0.5 0.0  NA  0.018706      1.00    0.018706   1</span></span>
<span><span class="co">#&gt;   3  0.5 0.5  NA 0.0  0.018706      1.00    0.018706   1</span></span>
<span><span class="co">#&gt;   4  0.5 0.5  NA  NA  0.018706      1.00    0.018706   1</span></span>
<span><span class="co">#&gt;   5  0.5  NA 0.0 0.5  0.020000      0.10    0.020000   1</span></span>
<span><span class="co">#&gt;   6  1.0  NA 0.0  NA  0.010000      1.00    0.010000   1</span></span>
<span><span class="co">#&gt;   7  0.5  NA  NA 0.5  0.020000      0.10    0.020000   1</span></span>
<span><span class="co">#&gt;   8  1.0  NA  NA  NA  0.010000      1.00    0.010000   1</span></span>
<span><span class="co">#&gt;   9   NA 0.5 0.5 0.0  0.040000      0.06    0.040000   1</span></span>
<span><span class="co">#&gt;   10  NA 0.5 0.5  NA  0.040000      0.06    0.040000   1</span></span>
<span><span class="co">#&gt;   11  NA 1.0  NA 0.0  0.020000      1.00    0.020000   1</span></span>
<span><span class="co">#&gt;   12  NA 1.0  NA  NA  0.020000      1.00    0.020000   1</span></span>
<span><span class="co">#&gt;   13  NA  NA 0.5 0.5  1.000000      0.05    0.050000   1</span></span>
<span><span class="co">#&gt;   14  NA  NA 1.0  NA  1.000000      0.03    0.030000   1</span></span>
<span><span class="co">#&gt;   15  NA  NA  NA 1.0  1.000000      0.05    0.050000   1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test details - Critical values -------------------------------------------------</span></span>
<span><span class="co">#&gt;    intersection hypothesis       test    p &lt;=        c *   w * alpha   res</span></span>
<span><span class="co">#&gt;               1         A1 parametric 0.01 &lt;= 1.106454 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               1         A2 parametric 0.02 &lt;= 1.106454 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               1         B1      simes 0.03 &lt;=            0.0 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               1         B2      simes 0.05 &lt;=            0.0 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               2         A1 parametric 0.01 &lt;= 1.106454 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               2         A2 parametric 0.02 &lt;= 1.106454 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               2         B1      simes 0.03 &lt;=            0.0 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               3         A1 parametric 0.01 &lt;= 1.106454 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               3         A2 parametric 0.02 &lt;= 1.106454 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               3         B2      simes 0.05 &lt;=            0.0 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               4         A1 parametric 0.01 &lt;= 1.106454 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               4         A2 parametric 0.02 &lt;= 1.106454 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               5         A1 parametric 0.01 &lt;=        1 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               5         B1      simes 0.03 &lt;=            0.0 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               5         B2      simes 0.05 &lt;=            0.5 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               6         A1 parametric 0.01 &lt;=        1 * 1.0 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               6         B1      simes 0.03 &lt;=            0.0 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               7         A1 parametric 0.01 &lt;=        1 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               7         B2      simes 0.05 &lt;=            0.5 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               8         A1 parametric 0.01 &lt;=        1 * 1.0 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               9         A2 parametric 0.02 &lt;=        1 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               9         B1      simes 0.03 &lt;=            0.5 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               9         B2      simes 0.05 &lt;=            0.5 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;              10         A2 parametric 0.02 &lt;=        1 * 0.5 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;              10         B1      simes 0.03 &lt;=            0.5 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;              11         A2 parametric 0.02 &lt;=        1 * 1.0 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;              11         B2      simes 0.05 &lt;=            0.0 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;              12         A2 parametric 0.02 &lt;=        1 * 1.0 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;              13         B1      simes 0.03 &lt;=            0.5 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;              13         B2      simes 0.05 &lt;=            1.0 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;              14         B1      simes 0.03 &lt;=            1.0 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;              15         B2      simes 0.05 &lt;=            1.0 *  0.05  TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="power-simulations">Power simulations<a class="anchor" aria-label="anchor" href="#power-simulations"></a>
</h2>
<p>Itâ€™s not always obvious from a given graph structure how easy or difficult it will be to reject each hypothesis. One way to understand this better is to run a power simulation. The essence of a power simulation is to generate many different p-values using some chosen distribution, then test the graph against each set of p-values to see how it performs.</p>
<div class="section level3">
<h3 id="bonferroni">Bonferroni<a class="anchor" aria-label="anchor" href="#bonferroni"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/calculate_power.html">calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">g_dose</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     A2     B1     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.0000 1.0000 0.0000</span></span>
<span><span class="co">#&gt;   A2 0.0000 0.0000 0.0000 1.0000</span></span>
<span><span class="co">#&gt;   B1 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1-A2-B1-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ----------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations with multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;   Simulation means:  1  1  1  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simulation covariance:    A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;                          A1  1  0  0  0</span></span>
<span><span class="co">#&gt;                          A2  0  1  0  0</span></span>
<span><span class="co">#&gt;                          B1  0  0  1  0</span></span>
<span><span class="co">#&gt;                          B2  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Success is defined as rejecting any of [A1, A2]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation --------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                                   A1      A2      B1     B2</span></span>
<span><span class="co">#&gt;        Power to reject each: 0.16956 0.17023 0.02943 0.0291</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Expected rejections: 0.39832</span></span>
<span><span class="co">#&gt;   Power to reject 1 or more: 0.3074</span></span>
<span><span class="co">#&gt;         Power to reject all: 0.00294</span></span>
<span><span class="co">#&gt;      Probability of success: 0.3074</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation details -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   p_sim_A1 p_sim_A2 p_sim_B1 p_sim_B2 rej_A1 rej_A2 rej_B1 rej_B2</span></span>
<span><span class="co">#&gt;   0.734324 0.066643 0.072314 0.192624  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.219480 0.000344 0.579458 0.276940  FALSE   TRUE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.259436 0.000584 0.302898 0.332274  FALSE   TRUE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.804838 0.003552 0.044241 0.003158  FALSE   TRUE  FALSE   TRUE</span></span>
<span><span class="co">#&gt;   0.584070 0.008772 0.287811 0.120703  FALSE   TRUE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.645343 0.076597 0.583397 0.123549  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   ...</span></span></code></pre></div>
<p>The <code><a href="reference/example-graphs.html">simple_successive_2()</a></code> function creates a parallel gate-keeping graph, but some weight is transferred between the primary hypotheses, rather than each passing weight on to its respective secondary hypothesis. This causes the primary hypotheses to be rejected slightly more often, and the secondary hypotheses less often.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">g_dose_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/example-graphs.html">simple_successive_2</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="reference/calculate_power.html">calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">g_dose_2</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     A2     B1     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   A2 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   B1 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1-A2-B1-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ----------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations with multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;   Simulation means:  1  1  1  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simulation covariance:    A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;                          A1  1  0  0  0</span></span>
<span><span class="co">#&gt;                          A2  0  1  0  0</span></span>
<span><span class="co">#&gt;                          B1  0  0  1  0</span></span>
<span><span class="co">#&gt;                          B2  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Success is defined as rejecting any of [A1, A2]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation --------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                                   A1      A2      B1      B2</span></span>
<span><span class="co">#&gt;        Power to reject each: 0.17694 0.17667 0.02229 0.02256</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Expected rejections: 0.39846</span></span>
<span><span class="co">#&gt;   Power to reject 1 or more: 0.30739</span></span>
<span><span class="co">#&gt;         Power to reject all: 0.00294</span></span>
<span><span class="co">#&gt;      Probability of success: 0.30739</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation details -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   p_sim_A1 p_sim_A2 p_sim_B1 p_sim_B2 rej_A1 rej_A2 rej_B1 rej_B2</span></span>
<span><span class="co">#&gt;   0.121233 0.625074 0.185369 0.365154  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.003418 0.005331 0.471701 0.088073   TRUE   TRUE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.414792 0.145246 0.353021 0.207961  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.054151 0.447358 0.044497 0.026981  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.381960 0.203325 0.197936 0.004214  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.308600 0.110535 0.043437 0.043006  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   ...</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-tests">Other tests<a class="anchor" aria-label="anchor" href="#other-tests"></a>
</h3>
<p>Bonferroni testing uses a shortcut to make testing, and therefore power, run very fast (&lt;1s up to a 10-graph/100K-simulation). However, power simulations can be run with any test strategy. Note that other testing strategies will cause a substantial increase in the time a power simulation takes. In rough ascending order of time impact: parametric tests, multiple groups, Simes tests.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/calculate_power.html">calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">g_dose_2</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     A2     B1     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   A2 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   B1 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parametric testing correlation:    A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;                                   A1  1  0  0  0</span></span>
<span><span class="co">#&gt;                                   A2  0  1  0  0</span></span>
<span><span class="co">#&gt;                                   B1  0  0  1  0</span></span>
<span><span class="co">#&gt;                                   B2  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   parametric: (A1-A2-B1-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ----------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations with multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;   Simulation means:  1  1  1  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simulation covariance:    A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;                          A1  1  0  0  0</span></span>
<span><span class="co">#&gt;                          A2  0  1  0  0</span></span>
<span><span class="co">#&gt;                          B1  0  0  1  0</span></span>
<span><span class="co">#&gt;                          B2  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Success is defined as rejecting any of [A1, A2]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation --------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                                   A1      A2      B1      B2</span></span>
<span><span class="co">#&gt;        Power to reject each: 0.18042 0.17984 0.02352 0.02318</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Expected rejections: 0.40696</span></span>
<span><span class="co">#&gt;   Power to reject 1 or more: 0.31237</span></span>
<span><span class="co">#&gt;         Power to reject all: 0.00293</span></span>
<span><span class="co">#&gt;      Probability of success: 0.31237</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation details -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   p_sim_A1 p_sim_A2 p_sim_B1 p_sim_B2 rej_A1 rej_A2 rej_B1 rej_B2</span></span>
<span><span class="co">#&gt;   0.059851 0.214734 0.087130 0.085869  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.669420 0.019747 0.417605 0.338864  FALSE   TRUE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.415546 0.132561 0.026116 0.007222  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.028955 0.411062 0.972080 0.684987  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.004987 0.434737 0.409300 0.068290   TRUE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.056020 0.631518 0.354720 0.157413  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   ...</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/calculate_power.html">calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">g_dose_2</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="st">"s"</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     A2     B1     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   A2 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   B1 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   simes: (A1-A2-B1-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ----------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations with multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;   Simulation means:  1  1  1  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simulation covariance:    A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;                          A1  1  0  0  0</span></span>
<span><span class="co">#&gt;                          A2  0  1  0  0</span></span>
<span><span class="co">#&gt;                          B1  0  0  1  0</span></span>
<span><span class="co">#&gt;                          B2  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Success is defined as rejecting any of [A1, A2]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation --------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                                   A1     A2      B1      B2</span></span>
<span><span class="co">#&gt;        Power to reject each: 0.18334 0.1833 0.02481 0.02559</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Expected rejections: 0.41704</span></span>
<span><span class="co">#&gt;   Power to reject 1 or more: 0.31522</span></span>
<span><span class="co">#&gt;         Power to reject all: 0.00481</span></span>
<span><span class="co">#&gt;      Probability of success: 0.31522</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation details -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   p_sim_A1 p_sim_A2 p_sim_B1 p_sim_B2 rej_A1 rej_A2 rej_B1 rej_B2</span></span>
<span><span class="co">#&gt;   0.009093 0.002317 0.120415 0.243067   TRUE   TRUE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.122093 0.033363 0.193634 0.602013  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.032154 0.214218 0.029764 0.371079  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.060998 0.207009 0.726477 0.721505  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.420560 0.636468 0.172388 0.198972  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.252351 0.079659 0.024400 0.088242  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   ...</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/calculate_power.html">calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">g_dose_2</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     A2     B1     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   A2 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   B1 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parametric testing correlation:    A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;                                   A1  1  0  0  0</span></span>
<span><span class="co">#&gt;                                   A2  0  1  0  0</span></span>
<span><span class="co">#&gt;                                   B1  0  0  1  0</span></span>
<span><span class="co">#&gt;                                   B2  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;        simes: (A1-A2)</span></span>
<span><span class="co">#&gt;   parametric: (B1-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ----------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations with multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;   Simulation means:  1  1  1  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simulation covariance:    A1 A2 B1 B2</span></span>
<span><span class="co">#&gt;                          A1  1  0  0  0</span></span>
<span><span class="co">#&gt;                          A2  0  1  0  0</span></span>
<span><span class="co">#&gt;                          B1  0  0  1  0</span></span>
<span><span class="co">#&gt;                          B2  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Success is defined as rejecting any of [A1, A2]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation --------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                                   A1      A2      B1      B2</span></span>
<span><span class="co">#&gt;        Power to reject each: 0.18379 0.18369 0.02414 0.02331</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Expected rejections: 0.41493</span></span>
<span><span class="co">#&gt;   Power to reject 1 or more: 0.31749</span></span>
<span><span class="co">#&gt;         Power to reject all: 0.00349</span></span>
<span><span class="co">#&gt;      Probability of success: 0.31749</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation details -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   p_sim_A1 p_sim_A2 p_sim_B1 p_sim_B2 rej_A1 rej_A2 rej_B1 rej_B2</span></span>
<span><span class="co">#&gt;   0.235136 0.542285 0.050847 0.347626  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.019190 0.193386 0.026304 0.412830   TRUE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.120857 0.109389 0.012917 0.068154  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.005220 0.133472 0.389114 0.108096   TRUE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.617954 0.258738 0.140075 0.111332  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.002952 0.036309 0.475232 0.506712   TRUE   TRUE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   ...</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="related-work">Related work<a class="anchor" aria-label="anchor" href="#related-work"></a>
</h2>
<p>These methods were originally implemented in R after the 2011 paper in the gMCP package, which is still available on CRAN today:</p>
<ul>
<li><code>install.packages("gMCP")</code></li>
<li><a href="https://github.com/kornl/gMCP" class="external-link uri">https://github.com/kornl/gMCP</a></li>
</ul>
<p>However, because development has ceased on this original package, we hope to re-implement the methods with a clearer distinction between weighting procedures and test procedures; with fewer dependencies, in particular shedding the Java dependency; with the simpler, more transparent S3 class framework; and with improvements to the accuracy of the parametric and Simes test methods.</p>
<p>A portion of Simes testing is also implemented in the lrstat package (<code>install.packages("lrstat")</code>) with similar speed to graphicalMCP.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Gilead-BioStats/graphicalMCP/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Gilead-BioStats/graphicalMCP/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing graphicalMCP</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Dong Xi <br><small class="roles"> Author, maintainer </small>  </li>
<li>Ethan Brockmann <br><small class="roles"> Author </small>  </li>
<li>Gilead Biostatistics <br><small class="roles"> Copyright holder, funder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=graphicalMCP" class="external-link"><img src="https://www.r-pkg.org/badges/version/graphicalMCP" alt="CRAN status"></a></li>
<li><a href="https://app.codecov.io/gh/Gilead-BioStats/graphicalMCP?branch=s3-graph_mcp" class="external-link"><img src="https://codecov.io/gh/Gilead-BioStats/graphicalMCP/branch/s3-graph_mcp/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/Gilead-BioStats/graphicalMCP/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/Gilead-BioStats/graphicalMCP/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dong Xi, Ethan Brockmann, Gilead Biostatistics.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
