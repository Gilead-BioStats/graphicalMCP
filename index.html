<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="A multiple comparison procedure (or multiple test procedure)
    is a a statistical analysis method for determining efficacy of
    multiple drugs, or multiple doses of the same drug, in a single
    clinical trial. (Bretz et al., 2011) laid out a graph-based approach
    to these multiple comparison procedures, in which the weights of the
    vertices and edges of the graph are determined independently of the
    particular statistical test used to assess results. This is a
    low-dependency implementation of the methods described in that and
    subsequent papers.">
<title>Graphical Approach for Multiple Comparison Procedures â€¢ graphicalMCP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Graphical Approach for Multiple Comparison Procedures">
<meta property="og:description" content="A multiple comparison procedure (or multiple test procedure)
    is a a statistical analysis method for determining efficacy of
    multiple drugs, or multiple doses of the same drug, in a single
    clinical trial. (Bretz et al., 2011) laid out a graph-based approach
    to these multiple comparison procedures, in which the weights of the
    vertices and edges of the graph are determined independently of the
    particular statistical test used to assess results. This is a
    low-dependency implementation of the methods described in that and
    subsequent papers.">
<meta property="og:image" content="https://urban-sniffle-p11zlpj.pages.github.io/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/graphicalMCP.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/case-study.html">Case Study</a>
    <a class="dropdown-item" href="articles/performance.html">Generating the closure tree</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<!-- badges: end -->
<div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="graphicalmcp-">graphicalMCP <a class="anchor" aria-label="anchor" href="#graphicalmcp-"></a>
</h1>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A multiple comparison procedure (MCP) is a statistical analysis method that allows for assessing the efficacy of multiple endpoints, some of which are dependent on each other, in a single clinical trial. Endpoints can be different doses, treatment of different conditions, combined superiority &amp; non-inferiority testing, or many others. A key feature is that MCPs strongly control the type-I error rate at level alpha.</p>
<p>In <a href="https://onlinelibrary.wiley.com/doi/10.1002/bimj.201000239" class="external-link">Bretz et al (2011)</a>, a graphical method for MCPs is described, which separates the weighting of the dependency graph from the particular statistical test used to assess each endpoint. This package is a low-dependency implementation of those methods.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>graphicalMCP is not on CRAN, so install it from GitHub with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="http://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"Gilead-BioStats/graphicalMCP@dev"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<div class="section level3">
<h3 id="initial-graph">Initial graph<a class="anchor" aria-label="anchor" href="#initial-graph"></a>
</h3>
<p>The base object in graphicalMCP is an <code>initial_graph</code>, which is a weighted, directed graph represented by a matrix of transition (edge) weights, and a vector of hypothesis (vertex) weights.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://urban-sniffle-p11zlpj.pages.github.io/">graphicalMCP</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A graphical multiple comparison procedure with two primary hypotheses (H1</span></span>
<span><span class="co"># and H2) and two secondary hypotheses (H3 and H4)</span></span>
<span><span class="co"># See Figure 1 in Bretz, F., Posch, M., Glimm, E., Klinglmueller, F., Maurer,</span></span>
<span><span class="co"># W., &amp; Rohmeyer, K. (2011). Graphical approaches for multiple comparison</span></span>
<span><span class="co"># procedures using weighted Bonferroni, Simes, or parametric tests. Biometrical</span></span>
<span><span class="co"># Journal, 53(6), 894-913.</span></span>
<span><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">hyp_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H1"</span>, <span class="st">"H2"</span>, <span class="st">"H3"</span>, <span class="st">"H4"</span><span class="op">)</span></span>
<span><span class="va">example_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/graph_create.html">graph_create</a></span><span class="op">(</span><span class="va">hypotheses</span>, <span class="va">transitions</span>, <span class="va">hyp_names</span><span class="op">)</span></span>
<span></span>
<span><span class="va">example_graph</span></span>
<span><span class="co">#&gt; Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; H1: 0.5</span></span>
<span><span class="co">#&gt; H2: 0.5</span></span>
<span><span class="co">#&gt; H3: 0.0</span></span>
<span><span class="co">#&gt; H4: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;     H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;  H1  0  0  1  0</span></span>
<span><span class="co">#&gt;  H2  0  0  0  1</span></span>
<span><span class="co">#&gt;  H3  0  1  0  0</span></span>
<span><span class="co">#&gt;  H4  1  0  0  0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="update-graph">Update graph<a class="anchor" aria-label="anchor" href="#update-graph"></a>
</h3>
<p>Hypotheses can be deleted from the MCP using <code><a href="reference/graph_update.html">graph_update()</a></code>. Updated weights and transitions are calculated according to the weighting strategy in Algorithm 1 of <a href="https://onlinelibrary.wiley.com/doi/10.1002/bimj.201000239" class="external-link">Bretz et al (2011)</a>. We distinguish <em>deleting</em> from <em>rejecting</em> in the <a href="#glossary">glossary</a>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/graph_update.html">graph_update</a></span><span class="op">(</span><span class="va">example_graph</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; H1: 0.5</span></span>
<span><span class="co">#&gt; H2: 0.5</span></span>
<span><span class="co">#&gt; H3: 0.0</span></span>
<span><span class="co">#&gt; H4: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;     H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;  H1  0  0  1  0</span></span>
<span><span class="co">#&gt;  H2  0  0  0  1</span></span>
<span><span class="co">#&gt;  H3  0  1  0  0</span></span>
<span><span class="co">#&gt;  H4  1  0  0  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypotheses kept ---</span></span>
<span><span class="co">#&gt;    H1    H2    H3   H4</span></span>
<span><span class="co">#&gt;  TRUE FALSE FALSE TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updated graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; H1: 0.5</span></span>
<span><span class="co">#&gt; H2: 0.0</span></span>
<span><span class="co">#&gt; H3: 0.0</span></span>
<span><span class="co">#&gt; H4: 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;     H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;  H1  0  0  0  1</span></span>
<span><span class="co">#&gt;  H2  0  0  0  0</span></span>
<span><span class="co">#&gt;  H3  0  0  0  0</span></span>
<span><span class="co">#&gt;  H4  1  0  0  0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-weights">Generate weights<a class="anchor" aria-label="anchor" href="#generate-weights"></a>
</h3>
<p>The weights of all sub-graphs can be calculated with <code><a href="reference/graph_generate_weights.html">graph_generate_weights()</a></code>. This uses more efficient code under the hood than <code><a href="reference/graph_update.html">graph_update()</a></code> in order to be performant for larger graphs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/graph_generate_weights.html">graph_generate_weights</a></span><span class="op">(</span><span class="va">example_graph</span><span class="op">)</span></span>
<span><span class="co">#&gt;    H1 H2 H3 H4  H1  H2  H3  H4</span></span>
<span><span class="co">#&gt; 1   1  1  1  1 0.5 0.5 0.0 0.0</span></span>
<span><span class="co">#&gt; 2   1  1  1  0 0.5 0.5 0.0 0.0</span></span>
<span><span class="co">#&gt; 3   1  1  0  1 0.5 0.5 0.0 0.0</span></span>
<span><span class="co">#&gt; 4   1  1  0  0 0.5 0.5 0.0 0.0</span></span>
<span><span class="co">#&gt; 5   1  0  1  1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt; 6   1  0  1  0 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 7   1  0  0  1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt; 8   1  0  0  0 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 9   0  1  1  1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt; 10  0  1  1  0 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt; 11  0  1  0  1 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 12  0  1  0  0 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 13  0  0  1  1 0.0 0.0 0.5 0.5</span></span>
<span><span class="co">#&gt; 14  0  0  1  0 0.0 0.0 1.0 0.0</span></span>
<span><span class="co">#&gt; 15  0  0  0  1 0.0 0.0 0.0 1.0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="test-hypotheses">Test hypotheses<a class="anchor" aria-label="anchor" href="#test-hypotheses"></a>
</h3>
<p>A mixture of statistical tests are supported in graphicalMCP. A graph can be tested against a given significance level with <code><a href="reference/testing.html">graph_test_closure()</a></code>, which generates a report showing the graph &amp; test results. In this example, a weighted Bonferroni test is applied to all hypotheses, with a significance threshold of 0.025. We can reject the null hypotheses for H1 &amp; H2, but we cannot reject the null hypotheses for H3 &amp; H4.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/testing.html">graph_test_closure</a></span><span class="op">(</span></span>
<span>  <span class="va">example_graph</span>,</span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.01</span>, <span class="fl">.02</span>, <span class="fl">.03</span>, <span class="fl">.05</span><span class="op">)</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>  test_types <span class="op">=</span> <span class="st">"bonferroni"</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   H1: 0.5</span></span>
<span><span class="co">#&gt;   H2: 0.5</span></span>
<span><span class="co">#&gt;   H3: 0.0</span></span>
<span><span class="co">#&gt;   H4: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;   H1  0  0  1  0</span></span>
<span><span class="co">#&gt;   H2  0  0  0  1</span></span>
<span><span class="co">#&gt;   H3  0  1  0  0</span></span>
<span><span class="co">#&gt;   H4  1  0  0  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                          H1   H2   H3   H4</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.01 0.02 0.03 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (H1, H2, H3, H4)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test summary ($outputs) --------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           H1         0.02   TRUE</span></span>
<span><span class="co">#&gt;           H2         0.04  FALSE</span></span>
<span><span class="co">#&gt;           H3         0.06  FALSE</span></span>
<span><span class="co">#&gt;           H4         0.06  FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Final updated graph after removing rejected hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   H1:  NA</span></span>
<span><span class="co">#&gt;   H2: 0.5</span></span>
<span><span class="co">#&gt;   H3: 0.5</span></span>
<span><span class="co">#&gt;   H4: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;   H1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   H2 NA  0  0  1</span></span>
<span><span class="co">#&gt;   H3 NA  1  0  0</span></span>
<span><span class="co">#&gt;   H4 NA  0  1  0</span></span></code></pre></div>
<p>Other tests, such as parametric- and Simes-based testing, can be used in addition to, or instead of, Bonferroni. More testing algorithms will be added over time. Try setting the <code>verbose</code> and <code>test_values</code> flags for a more detailed report on testing.</p>
</div>
</div>
<div class="section level2">
<h2 id="power-simulations">Power simulations<a class="anchor" aria-label="anchor" href="#power-simulations"></a>
</h2>
<p>Itâ€™s not always obvious from a given graph structure how easy or difficult it will be to reject each hypothesis. One way to understand this better is to run a power simulation. The essence of a power simulation is to generate many different p-values using some chosen distribution, then test the graph against each set of p-values to see how it performs.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">example_graph</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.9</span>, <span class="fl">.9</span>, <span class="fl">.8</span>, <span class="fl">.8</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   H1: 0.5</span></span>
<span><span class="co">#&gt;   H2: 0.5</span></span>
<span><span class="co">#&gt;   H3: 0.0</span></span>
<span><span class="co">#&gt;   H4: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;   H1  0  0  1  0</span></span>
<span><span class="co">#&gt;   H2  0  0  0  1</span></span>
<span><span class="co">#&gt;   H3  0  1  0  0</span></span>
<span><span class="co">#&gt;   H4  1  0  0  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (H1, H2, H3, H4)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ($inputs) ------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations with multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    H1  H2  H3  H4</span></span>
<span><span class="co">#&gt;   Marginal power: 0.9 0.9 0.8 0.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation:    H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;                H1  1  0  0  0</span></span>
<span><span class="co">#&gt;                H2  0  1  0  0</span></span>
<span><span class="co">#&gt;                H3  0  0  1  0</span></span>
<span><span class="co">#&gt;                H4  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation ($power) -----------------------------------------------------</span></span>
<span><span class="co">#&gt;                                    H1      H2      H3      H4</span></span>
<span><span class="co">#&gt;                  Local power: 0.87692 0.87661 0.67054 0.67175</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Expected no. of rejections: 3.09582</span></span>
<span><span class="co">#&gt;    Power to reject 1 or more: 0.9749</span></span>
<span><span class="co">#&gt;          Power to reject all: 0.50298</span></span></code></pre></div>
<p>All valid test types are also valid for power simulations.</p>
</div>
<div class="section level2">
<h2 id="related-work">Related work<a class="anchor" aria-label="anchor" href="#related-work"></a>
</h2>
<p>These methods were originally implemented in R after the 2011 paper in the <a href="https://github.com/kornl/gMCP" class="external-link">gMCP package</a>, which is still available on CRAN today. There is also a lighter version of gMCP implemented in <a href="https://github.com/allenzhuaz/gMCPmini" class="external-link">gMCPmini</a> and its successor, <a href="https://github.com/Merck/gMCPLite" class="external-link">gMCPLite</a>. These two contain only a subset of the original functionality, but they remove the rJava dependency and add plotting functionality based on ggplot2.</p>
<p>However, because development has ceased on the original package, we hope to re-implement the methods with a clearer distinction between weighting procedures and test procedures; with fewer dependencies, in particular shedding the Java dependency; with the simpler, more transparent S3 class framework; and with improvements to the accuracy of the parametric and Simes test methods.</p>
<p>A portion of Simes testing is also implemented in the lrstat package (<code>install.packages("lrstat")</code>).</p>
</div>
<div class="section level2">
<h2 id="citation">Citation<a class="anchor" aria-label="anchor" href="#citation"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"graphicalMCP"</span><span class="op">)</span></span>
<span><span class="co">#&gt; To cite graphicalMCP in publications use:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Xi, D.; Brockmann, E. (2023). graphicalMCP: Graph-based multiple</span></span>
<span><span class="co">#&gt;   comparison procedures. version 0.1.0. Gilead Sciences, Inc. Foster</span></span>
<span><span class="co">#&gt;   City, California. https://github.com/Gilead-BioStats/graphicalMCP</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Frank Bretz, Martin Posch, Ekkehard Glimm, Florian Klinglmueller,</span></span>
<span><span class="co">#&gt;   Willi Maurer, Kornelius Rohmeyer (2011), Graphical approaches for</span></span>
<span><span class="co">#&gt;   multiple comparison procedures using weighted Bonferroni, Simes or</span></span>
<span><span class="co">#&gt;   parametric tests. Biometrical Journal 53 (6), pages 894--913, Wiley.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To see these entries in BibTeX format, use 'print(&lt;citation&gt;,</span></span>
<span><span class="co">#&gt; bibtex=TRUE)', 'toBibtex(.)', or set</span></span>
<span><span class="co">#&gt; 'options(citation.bibtex.max=999)'.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="acknowledgments">Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"></a>
</h2>
</div>
<div class="section level2">
<h2 id="glossary-of-terms">Glossary of terms<a class="anchor" aria-label="anchor" href="#glossary-of-terms"></a>
</h2>
<p>This package seeks to be both accurate and performant, of course. But beyond that, much thought has been put into the readability of the code. Whether being read by a user validating our methods, a developer extending the package to new uses, or a contributor helping enhance the package, we hope that the code contained here can serve as an educational document to grow peopleâ€™s understanding of the graphical approach to multiple comparison procedures.</p>
<p>To that end, there are several entities encountered in the world of graphical MCPs that we define here. Some of these are used only in the internal code of the package, but most are output from one or more exported functions. If you believe any definitions could be clarified or improved, please contact the package authors or submit an issue to the GitHub repository.</p>
<table style="width:99%;" class="table">
<colgroup>
<col style="width: 9%">
<col style="width: 57%">
<col style="width: 11%">
<col style="width: 9%">
<col style="width: 9%">
</colgroup>
<thead><tr class="header">
<th>
Entity
</th>
<th>
Definition
</th>
<th>
Aliases
</th>
<th>
Variable(s)
</th>
<th>
Related
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>
<strong>Graph</strong>
</td>
<td>
A set of nodes and edges representing a clinical trial design
</td>
<td>
</td>
<td>
<code>graph</code>
</td>
<td>
Hypotheses, Transitions
</td>
</tr>
<tr class="even">
<td>
</td>
<td>
<strong>Graphs</strong> are so central that two of their core qualities get their own common variable names: Hypothesis names, and number of hypotheses
</td>
<td>
</td>
<td>
<code>hyp_names</code>, <code>num_hyps</code>
</td>
<td>
</td>
</tr>
<tr class="odd">
<td>
<strong>Hypotheses</strong>
</td>
<td>
The weighted nodes in a <strong>graph</strong>. Each node represents a null hypothesis corresponding to a treatment endpoint, and its weight the local significance level.
</td>
<td>
weights, hypothesis weights
</td>
<td>
<code>hypotheses</code>
</td>
<td>
Weighting strategy, Transitions
</td>
</tr>
<tr class="even">
<td>
<strong>Transitions</strong>
</td>
<td>
The weighted edges in a <strong>graph</strong>. Each edge defines how to propagate local significance when a source node is deleted.
</td>
<td>
</td>
<td>
<code>transitions</code>
</td>
<td>
Hypotheses
</td>
</tr>
<tr class="odd">
<td>
<strong>Intersection</strong> <strong>hypothesis</strong>
</td>
<td>
A subset of <strong>hypotheses</strong> from a <strong>graph</strong>. Plural often implies all such subsets.
</td>
<td>
intersection, sub-graph(s), closure
</td>
<td>
<code>intersections</code>
</td>
<td>
Weighting strategy
</td>
</tr>
<tr class="even">
<td>
<strong>Weighting strategy</strong>
</td>
<td>
The set of all <strong>intersections</strong> and their <strong>weights</strong> according to Algorithm 1 in Bretz et al (2011)
</td>
<td>
intersection weights, closure weights
</td>
<td>
<code>weighting_strategy</code>
</td>
<td>
</td>
</tr>
<tr class="odd">
<td>
<strong>Adjusted weights</strong>
</td>
<td>
<p>
The set of <strong>weights</strong>, adjusted according to a testing algorithm:
</p>
<ul>
<li>
Bonferroni: No change
</li>
<li>
Simes: Sum weights for hypotheses with smaller p-values
</li>
<li>
Parametric: Multiply weights by c-value, based on the joint distribution
</li>
</ul>
</td>
<td>
</td>
<td>
<code>adjusted_weights</code>
</td>
<td>
</td>
</tr>
<tr class="even">
<td>
<strong>P-values</strong>
</td>
<td>
The set of p-values from a real or simulated clinical trial
</td>
<td>
</td>
<td>
<code>p</code>
</td>
<td>
Adjusted &amp; ordered p-values
</td>
</tr>
<tr class="odd">
<td>
<strong>Ordered p-values</strong>
</td>
<td>
<strong>P-values</strong> sorted from smallest to largest
</td>
<td>
</td>
<td>
<code>ordered_p</code>
</td>
<td>
(Adjusted) P-values
</td>
</tr>
<tr class="even">
<td>
<strong>Adjusted p-values</strong>
</td>
<td>
<strong>P-values</strong> that have been divided by <strong>adjusted weights</strong>, allowing direct comparison to <strong>alpha</strong> to determine significance
</td>
<td>
</td>
<td>
<code>adjusted_p</code>
</td>
<td>
(Ordered) P-values
</td>
</tr>
<tr class="odd">
<td>
<strong>Significance level</strong>
</td>
<td>
The threshold chosen for results of a clinical trial to be considered significant
</td>
<td>
</td>
<td>
<code>alpha</code>
</td>
<td>
P-values
</td>
</tr>
<tr class="even">
<td>
<strong>Test types</strong>
</td>
<td>
A specification of which testing algorithm to use - Bonferroni, Simes, and parametric are supported
</td>
<td>
tests
</td>
<td>
<code>test_types</code>
</td>
<td>
Testing strategy
</td>
</tr>
<tr class="odd">
<td>
<strong>Test groups</strong>
</td>
<td>
A partition of nodes in a <strong>graph</strong> specifying which <strong>hypotheses</strong> should be tested together
</td>
<td>
groups
</td>
<td>
<code>groups</code>, <code>test_groups</code>
</td>
<td>
Testing strategy
</td>
</tr>
<tr class="even">
<td>
<strong>Testing strategy</strong>
</td>
<td>
<strong>Test types</strong> and <strong>test groups</strong> combined
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr class="odd">
<td>
<strong>Marginal power</strong>
</td>
<td>
<p>
The mean of each null <strong>hypothesis</strong> in the underlying multivariate normal distribution of the null hypotheses. Closely related to the non-centrality parameter:
</p>
<p>
<code>ncp =<code>qnorm(1 - alpha) -</code>qnorm(1 - marginal_power)</code>
</p>
</td>
<td>
</td>
<td>
<code>marginal_power</code>
</td>
<td>
Correlation matrix
</td>
</tr>
<tr class="even">
<td>
<strong>Correlation matrix</strong>
</td>
<td>
Specification of correlations between <strong>hypotheses</strong>. Together with <strong>marginal power</strong>, this specifies the (known or assumed) underlying multivariate normal distribution of the null <strong>hypotheses</strong>.
</td>
<td>
</td>
<td>
<code>corr</code>, <code>test_corr</code>, <code>sim_corr</code>
</td>
<td>
Marginal power
</td>
</tr>
<tr class="odd">
<td>
<strong>Success</strong>
</td>
<td>
A specification of which null <strong>hypotheses</strong> must be rejected to consider a clinical trial a success
</td>
<td>
</td>
<td>
<code>sim_success</code>
</td>
<td>
</td>
</tr>
<tr class="even">
<td>
<strong>Power</strong>
</td>
<td>
Under a given <strong>graph</strong>, <strong>testing strategy</strong>, <strong>significance level</strong>, and underlying distribution, the estimated likelihood that a particular combination of null hypotheses will be rejected
</td>
<td>
</td>
<td>
<code>power_*</code>
</td>
<td>
Success
</td>
</tr>
<tr class="odd">
<td>
<em>Delete a <strong>hypothesis</strong></em>
</td>
<td>
Remove a <strong>hypothesis</strong> from a graph, and update the graph according to algorithm 1 of Bretz et al.Â (2011)
</td>
<td>
</td>
<td>
N/A
</td>
<td>
Reject a hypothesis
</td>
</tr>
<tr class="even">
<td>
<em>Reject a <strong>hypothesis</strong></em>
</td>
<td>
Under a given <strong>graph</strong>, <strong>testing strategy</strong>, and <strong>significance level</strong>, find a hypothesis (clinical endpoint) to be statistically significant, such that the null hypothesis can be rejected
</td>
<td>
</td>
<td>
</td>
<td>
Delete a hypothesis
</td>
</tr>
</tbody>
</table>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/Gilead-BioStats/graphicalMCP/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/Gilead-BioStats/graphicalMCP/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing graphicalMCP</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Dong Xi <br><small class="roles"> Author, maintainer </small>  </li>
<li>Ethan Brockmann <br><small class="roles"> Author </small>  </li>
<li>Gilead Biostatistics <br><small class="roles"> Copyright holder, funder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=graphicalMCP" class="external-link"><img src="https://www.r-pkg.org/badges/version/graphicalMCP" alt="CRAN status"></a></li>
<li><a href="https://app.codecov.io/gh/Gilead-BioStats/graphicalMCP?branch=s3-graph_mcp" class="external-link"><img src="https://codecov.io/gh/Gilead-BioStats/graphicalMCP/branch/s3-graph_mcp/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/Gilead-BioStats/graphicalMCP/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/Gilead-BioStats/graphicalMCP/actions/workflows/R-CMD-check.yaml/badge.svg?branch=feature-power" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dong Xi, Ethan Brockmann, Gilead Biostatistics.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
