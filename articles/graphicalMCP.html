<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="graphicalMCP">
<title>Get started • graphicalMCP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get started">
<meta property="og:description" content="graphicalMCP">
<meta property="og:image" content="https://urban-sniffle-p11zlpj.pages.github.io/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/graphicalMCP.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/graph-examples.html">Commonly-used graph examples</a>
    <a class="dropdown-item" href="../articles/shortuct-testing.html">Sequentially rejective graphical approaches based on Bonferroni tests</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Get started</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/graphicalMCP/blob/HEAD/vignettes/graphicalMCP.Rmd" class="external-link"><code>vignettes/graphicalMCP.Rmd</code></a></small>
      <div class="d-none name"><code>graphicalMCP.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://gsrmtp.r-forge.r-project.org/" class="external-link">gMCP</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://urban-sniffle-p11zlpj.pages.github.io/">graphicalMCP</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'graphicalMCP'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:gMCP':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     fallback</span></span></code></pre></div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>graphicalMCP is not on CRAN, so install it from GitHub with</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="http://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"Gilead-BioStats/graphicalMCP@dev"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="testing-a-graph">Testing a graph<a class="anchor" aria-label="anchor" href="#testing-a-graph"></a>
</h2>
<p>Start testing with a simple successive graph with two primary and two
secondary hypotheses.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example-graphs.html">simple_successive_2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"B1"</span>, <span class="st">"A2"</span>, <span class="st">"B2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.012</span>, <span class="fl">.005</span>, <span class="fl">.013</span>, <span class="fl">.0135</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss_graph</span></span>
<span><span class="co">#&gt; Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; A1: 0.5</span></span>
<span><span class="co">#&gt; B1: 0.5</span></span>
<span><span class="co">#&gt; A2: 0.0</span></span>
<span><span class="co">#&gt; B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;      A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;  A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;  B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;  A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;  B2 1.0 0.0 0.0 0.0</span></span></code></pre></div>
<div class="section level3">
<h3 id="bonferroni">Bonferroni<a class="anchor" aria-label="anchor" href="#bonferroni"></a>
</h3>
<p>This graph can be tested most simply with the default weighted
Bonferroni test. When testing at the global alpha level 0.025, we can
reject hypotheses A1 and B1, but not A2 or B2.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">graph_test_closure</a></span><span class="op">(</span><span class="va">ss_graph</span>, p <span class="op">=</span> <span class="va">p_values</span>, alpha <span class="op">=</span> <span class="fl">.025</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.0120 0.0050 0.0130 0.0135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1, B1, A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test summary ($outputs) --------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1        0.016   TRUE</span></span>
<span><span class="co">#&gt;           B1        0.010   TRUE</span></span>
<span><span class="co">#&gt;           A2        0.026  FALSE</span></span>
<span><span class="co">#&gt;           B2        0.026  FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Final updated graph after removing rejected hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1:  NA</span></span>
<span><span class="co">#&gt;   B1:  NA</span></span>
<span><span class="co">#&gt;   A2: 0.5</span></span>
<span><span class="co">#&gt;   B2: 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;   A1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   A2 NA NA  0  1</span></span>
<span><span class="co">#&gt;   B2 NA NA  1  0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simes">Simes<a class="anchor" aria-label="anchor" href="#simes"></a>
</h3>
<p>[I don’t like this paragraph, but I’m not sure why]</p>
<p>Simes testing relies on non-negative dependency between hypotheses to
increase the weights of some hypotheses. The strength of the Simes test
is most apparent when multiple p-values fall below the global alpha
level, but above their local alpha in some intersection(s). In the
following case, B1 &amp; B2 are rejected in the Bonferroni testing
procedure for intersection <code>B1 ∩ B2</code> because the p-value is
greater than <code>alpha * w</code> for each hypothesis in that case.
However, the Simes test rejects <code>B1 ∩ B2</code> because the weight
from B1 is added to the weight for B2.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">graph_test_closure</a></span><span class="op">(</span><span class="va">ss_graph</span>, p <span class="op">=</span> <span class="va">p_values</span>, alpha <span class="op">=</span> <span class="fl">.025</span>, test_types <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.0120 0.0050 0.0130 0.0135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   simes: (A1, B1, A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test summary ($outputs) --------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1       0.0135   TRUE</span></span>
<span><span class="co">#&gt;           B1       0.0100   TRUE</span></span>
<span><span class="co">#&gt;           A2       0.0135   TRUE</span></span>
<span><span class="co">#&gt;           B2       0.0135   TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Final updated graph after removing rejected hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: NA</span></span>
<span><span class="co">#&gt;   B1: NA</span></span>
<span><span class="co">#&gt;   A2: NA</span></span>
<span><span class="co">#&gt;   B2: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;   A1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   A2 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B2 NA NA NA NA</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parametric">Parametric<a class="anchor" aria-label="anchor" href="#parametric"></a>
</h3>
<p>If a correlation matrix for the test statistics is partially or fully
known, a parametric test can be used for any subsets whose correlation
matrix is fully known. Here B1 &amp; B2 get a <code>c</code> value
calculated that boosts their testing threshold slightly higher. This
also demonstrates how to use different test types for different groups
of hypotheses.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/testing.html">graph_test_closure</a></span><span class="op">(</span><span class="va">ss_graph</span>,</span>
<span>  p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>  corr <span class="op">=</span> <span class="va">corr1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.0120 0.0050 0.0130 0.0135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation matrix:     A2  B2</span></span>
<span><span class="co">#&gt;                       A2 1.0 0.5</span></span>
<span><span class="co">#&gt;                       B2 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1, B1)</span></span>
<span><span class="co">#&gt;   parametric: (A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test summary ($outputs) --------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1    0.0160000   TRUE</span></span>
<span><span class="co">#&gt;           B1    0.0100000   TRUE</span></span>
<span><span class="co">#&gt;           A2    0.0241385   TRUE</span></span>
<span><span class="co">#&gt;           B2    0.0241385   TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Final updated graph after removing rejected hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: NA</span></span>
<span><span class="co">#&gt;   B1: NA</span></span>
<span><span class="co">#&gt;   A2: NA</span></span>
<span><span class="co">#&gt;   B2: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;   A1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   A2 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B2 NA NA NA NA</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="adjusted-significance-vs-adjusted-p-values">Adjusted significance vs adjusted p-values<a class="anchor" aria-label="anchor" href="#adjusted-significance-vs-adjusted-p-values"></a>
</h3>
<p>There are two different testing methods - one which uses weights to
adjust the significance level, and another which adjusts the p-values.
The adjusted p-values method is sometimes more efficient, so it is the
standard method. Additional details about the adjusted p-values
calculation can be seen by setting <code>verbose = TRUE</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">graph_test_closure</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>  corr <span class="op">=</span> <span class="va">corr1</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.0120 0.0050 0.0130 0.0135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation matrix:     A2  B2</span></span>
<span><span class="co">#&gt;                       A2 1.0 0.5</span></span>
<span><span class="co">#&gt;                       B2 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;        simes: (A1, B1)</span></span>
<span><span class="co">#&gt;   parametric: (A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test summary ($outputs) --------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1    0.0160000   TRUE</span></span>
<span><span class="co">#&gt;           B1    0.0100000   TRUE</span></span>
<span><span class="co">#&gt;           A2    0.0241385   TRUE</span></span>
<span><span class="co">#&gt;           B2    0.0241385   TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Final updated graph after removing rejected hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: NA</span></span>
<span><span class="co">#&gt;   B1: NA</span></span>
<span><span class="co">#&gt;   A2: NA</span></span>
<span><span class="co">#&gt;   B2: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;   A1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   A2 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B2 NA NA NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted p details ($details) --------------------------------------------------</span></span>
<span><span class="co">#&gt;   Intersection         A1         B1         A2         B2 adj_p_grp1 adj_p_grp2</span></span>
<span><span class="co">#&gt;              1 0.50000000 0.50000000 0.00000000 0.00000000 0.01000000 1.00000000</span></span>
<span><span class="co">#&gt;              2 0.50000000 0.50000000 0.00000000         NA 0.01000000 1.00000000</span></span>
<span><span class="co">#&gt;              3 0.50000000 0.50000000         NA 0.00000000 0.01000000 1.00000000</span></span>
<span><span class="co">#&gt;              4 0.50000000 0.50000000         NA         NA 0.01000000 1.00000000</span></span>
<span><span class="co">#&gt;              5 0.75000000         NA 0.00000000 0.25000000 0.01600000 0.05400000</span></span>
<span><span class="co">#&gt;              6 1.00000000         NA 0.00000000         NA 0.01200000 1.00000000</span></span>
<span><span class="co">#&gt;              7 0.75000000         NA         NA 0.25000000 0.01600000 0.05400000</span></span>
<span><span class="co">#&gt;              8 1.00000000         NA         NA         NA 0.01200000 1.00000000</span></span>
<span><span class="co">#&gt;              9         NA 0.75000000 0.25000000 0.00000000 0.00666667 0.05200000</span></span>
<span><span class="co">#&gt;             10         NA 0.75000000 0.25000000         NA 0.00666667 0.05200000</span></span>
<span><span class="co">#&gt;   adj_p_inter reject_intersection</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01600000                TRUE</span></span>
<span><span class="co">#&gt;    0.01200000                TRUE</span></span>
<span><span class="co">#&gt;    0.01600000                TRUE</span></span>
<span><span class="co">#&gt;    0.01200000                TRUE</span></span>
<span><span class="co">#&gt;    0.00666667                TRUE</span></span>
<span><span class="co">#&gt;    0.00666667                TRUE</span></span>
<span><span class="co">#&gt;   ... (Use `print(x, rows = &lt;nn&gt;)` for more)</span></span></code></pre></div>
<p>The adjusted weights method tests every hypothesis in the closure,
rather than summarizing adjusted p-values before testing. Setting
<code>test_values = TRUE</code> displays the values used in each of
these tests. This can provide more detailed information about what
caused a hypothesis to fail than the adjusted p-values. However, it
comes with some cost in computation time. Note that the
<code>Intersection</code> columns in the adjusted p-value and adjusted
weights sections serve as a persistent index between datasets.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">graph_test_closure</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>  corr <span class="op">=</span> <span class="va">corr1</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  test_values <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.0120 0.0050 0.0130 0.0135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation matrix:     A2  B2</span></span>
<span><span class="co">#&gt;                       A2 1.0 0.5</span></span>
<span><span class="co">#&gt;                       B2 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;        simes: (A1, B1)</span></span>
<span><span class="co">#&gt;   parametric: (A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test summary ($outputs) --------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1    0.0160000   TRUE</span></span>
<span><span class="co">#&gt;           B1    0.0100000   TRUE</span></span>
<span><span class="co">#&gt;           A2    0.0241385   TRUE</span></span>
<span><span class="co">#&gt;           B2    0.0241385   TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Final updated graph after removing rejected hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: NA</span></span>
<span><span class="co">#&gt;   B1: NA</span></span>
<span><span class="co">#&gt;   A2: NA</span></span>
<span><span class="co">#&gt;   B2: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;   A1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   A2 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B2 NA NA NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted p details ($details) --------------------------------------------------</span></span>
<span><span class="co">#&gt;   Intersection         A1         B1         A2         B2 adj_p_grp1 adj_p_grp2</span></span>
<span><span class="co">#&gt;              1 0.50000000 0.50000000 0.00000000 0.00000000 0.01000000 1.00000000</span></span>
<span><span class="co">#&gt;              2 0.50000000 0.50000000 0.00000000         NA 0.01000000 1.00000000</span></span>
<span><span class="co">#&gt;              3 0.50000000 0.50000000         NA 0.00000000 0.01000000 1.00000000</span></span>
<span><span class="co">#&gt;              4 0.50000000 0.50000000         NA         NA 0.01000000 1.00000000</span></span>
<span><span class="co">#&gt;              5 0.75000000         NA 0.00000000 0.25000000 0.01600000 0.05400000</span></span>
<span><span class="co">#&gt;              6 1.00000000         NA 0.00000000         NA 0.01200000 1.00000000</span></span>
<span><span class="co">#&gt;              7 0.75000000         NA         NA 0.25000000 0.01600000 0.05400000</span></span>
<span><span class="co">#&gt;              8 1.00000000         NA         NA         NA 0.01200000 1.00000000</span></span>
<span><span class="co">#&gt;              9         NA 0.75000000 0.25000000 0.00000000 0.00666667 0.05200000</span></span>
<span><span class="co">#&gt;             10         NA 0.75000000 0.25000000         NA 0.00666667 0.05200000</span></span>
<span><span class="co">#&gt;   adj_p_inter reject_intersection</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01600000                TRUE</span></span>
<span><span class="co">#&gt;    0.01200000                TRUE</span></span>
<span><span class="co">#&gt;    0.01600000                TRUE</span></span>
<span><span class="co">#&gt;    0.01200000                TRUE</span></span>
<span><span class="co">#&gt;    0.00666667                TRUE</span></span>
<span><span class="co">#&gt;    0.00666667                TRUE</span></span>
<span><span class="co">#&gt;   ... (Use `print(x, rows = &lt;nn&gt;)` for more)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Detailed test values ($test_values) --------------------------------------------</span></span>
<span><span class="co">#&gt;   Intersection Hypothesis       Test      p &lt;= c_value * Weight * Alpha</span></span>
<span><span class="co">#&gt;              1         A1      simes 0.0120 &lt;=             1.00 * 0.025</span></span>
<span><span class="co">#&gt;              1         B1      simes 0.0050 &lt;=             0.50 * 0.025</span></span>
<span><span class="co">#&gt;              1         A2 parametric 0.0130 &lt;= 1.00000 *   0.00 * 0.025</span></span>
<span><span class="co">#&gt;              1         B2 parametric 0.0135 &lt;= 1.00000 *   0.00 * 0.025</span></span>
<span><span class="co">#&gt;              2         A1      simes 0.0120 &lt;=             1.00 * 0.025</span></span>
<span><span class="co">#&gt;              2         B1      simes 0.0050 &lt;=             0.50 * 0.025</span></span>
<span><span class="co">#&gt;              2         A2 parametric 0.0130 &lt;= 1.00000 *   0.00 * 0.025</span></span>
<span><span class="co">#&gt;              3         A1      simes 0.0120 &lt;=             1.00 * 0.025</span></span>
<span><span class="co">#&gt;              3         B1      simes 0.0050 &lt;=             0.50 * 0.025</span></span>
<span><span class="co">#&gt;              3         B2 parametric 0.0135 &lt;= 1.00000 *   0.00 * 0.025</span></span>
<span><span class="co">#&gt;   Inequality_holds</span></span>
<span><span class="co">#&gt;               TRUE</span></span>
<span><span class="co">#&gt;               TRUE</span></span>
<span><span class="co">#&gt;              FALSE</span></span>
<span><span class="co">#&gt;              FALSE</span></span>
<span><span class="co">#&gt;               TRUE</span></span>
<span><span class="co">#&gt;               TRUE</span></span>
<span><span class="co">#&gt;              FALSE</span></span>
<span><span class="co">#&gt;               TRUE</span></span>
<span><span class="co">#&gt;               TRUE</span></span>
<span><span class="co">#&gt;              FALSE</span></span>
<span><span class="co">#&gt;   ... (Use `print(x, rows = &lt;nn&gt;)` for more)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="bonferroni-shortcut">Bonferroni shortcut<a class="anchor" aria-label="anchor" href="#bonferroni-shortcut"></a>
</h3>
<p>Exclusive Bonferroni testing admits a shortcut which allows us to not
test the full closure of a graph. Use [graph_test_shortcut()] to call
this shortcut method. In this case, <code>verbose = TRUE</code> adds the
intermediate graphs after each deletion, and
<code>test_values = TRUE</code> gives test details for the order in
which hypotheses are deleted. Overall hypothesis rejection results can
be found in the <code>Test summary</code> section.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">graph_test_shortcut</a></span><span class="op">(</span></span>
<span>  graph <span class="op">=</span> <span class="va">ss_graph</span>,</span>
<span>  p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  test_values <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.0120 0.0050 0.0130 0.0135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1, B1, A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test summary ($outputs) --------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1        0.016   TRUE</span></span>
<span><span class="co">#&gt;           B1        0.010   TRUE</span></span>
<span><span class="co">#&gt;           A2        0.026  FALSE</span></span>
<span><span class="co">#&gt;           B2        0.026  FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Final updated graph after removing rejected hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1:  NA</span></span>
<span><span class="co">#&gt;   B1:  NA</span></span>
<span><span class="co">#&gt;   A2: 0.5</span></span>
<span><span class="co">#&gt;   B2: 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;   A1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   A2 NA NA  0  1</span></span>
<span><span class="co">#&gt;   B2 NA NA  1  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rejection sequence details ($details) ------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Step 1: Updated graph after removing hypothesis B1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;     A1: 0.75</span></span>
<span><span class="co">#&gt;     B1:   NA</span></span>
<span><span class="co">#&gt;     A2: 0.00</span></span>
<span><span class="co">#&gt;     B2: 0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     --- Transition weights ---</span></span>
<span><span class="co">#&gt;              A1       B1       A2       B2</span></span>
<span><span class="co">#&gt;     A1 0.000000       NA 0.666667 0.333333</span></span>
<span><span class="co">#&gt;     B1       NA       NA       NA       NA</span></span>
<span><span class="co">#&gt;     A2 0.500000       NA 0.000000 0.500000</span></span>
<span><span class="co">#&gt;     B2 1.000000       NA 0.000000 0.000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Step 2: Updated graph after removing hypotheses B1, A1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;       A1:  NA</span></span>
<span><span class="co">#&gt;       B1:  NA</span></span>
<span><span class="co">#&gt;       A2: 0.5</span></span>
<span><span class="co">#&gt;       B2: 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;       A1 NA NA NA NA</span></span>
<span><span class="co">#&gt;       B1 NA NA NA NA</span></span>
<span><span class="co">#&gt;       A2 NA NA  0  1</span></span>
<span><span class="co">#&gt;       B2 NA NA  1  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Final updated graph after removing rejected hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1:  NA</span></span>
<span><span class="co">#&gt;   B1:  NA</span></span>
<span><span class="co">#&gt;   A2: 0.5</span></span>
<span><span class="co">#&gt;   B2: 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;   A1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   A2 NA NA  0  1</span></span>
<span><span class="co">#&gt;   B2 NA NA  1  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Detailed test values ($test_values) --------------------------------------------</span></span>
<span><span class="co">#&gt;   Step Hypothesis      p &lt;= Weight * Alpha Inequality_holds</span></span>
<span><span class="co">#&gt;      1         B1 0.0050 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;      2         A1 0.0120 &lt;=   0.75 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;      3         A2 0.0130 &lt;=   0.50 * 0.025            FALSE</span></span>
<span><span class="co">#&gt;      3         B2 0.0135 &lt;=   0.50 * 0.025            FALSE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="test-print-options">Test print options<a class="anchor" aria-label="anchor" href="#test-print-options"></a>
</h2>
<p>The print generic for test results includes a couple of additional
options. Each section within results is indented 2 spaces by default for
readability, but this can be adjusted with <code>indent</code> (Note
that some portions of the output can be indented by a minimum of 1 space
- These pieces will ignore an indent of 0). Numeric values are rounded
to 6 significant figures to control the amount of space used, but this
can be set using the <code>precision</code> argument. Only the printing
format is impacted, not the underlying values.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mix_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/testing.html">graph_test_closure</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"s"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  test_values <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mix_test</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                            A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.0120 0.0050 0.0130 0.0135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1, B2)</span></span>
<span><span class="co">#&gt;        simes: (B1, A2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test summary ($outputs) --------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1        0.016   TRUE</span></span>
<span><span class="co">#&gt;           B1        0.010   TRUE</span></span>
<span><span class="co">#&gt;           A2        0.026  FALSE</span></span>
<span><span class="co">#&gt;           B2        0.026  FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Final updated graph after removing rejected hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1:  NA</span></span>
<span><span class="co">#&gt;   B1:  NA</span></span>
<span><span class="co">#&gt;   A2: 0.5</span></span>
<span><span class="co">#&gt;   B2: 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;   A1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   B1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   A2 NA NA  0  1</span></span>
<span><span class="co">#&gt;   B2 NA NA  1  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted p details ($details) --------------------------------------------------</span></span>
<span><span class="co">#&gt;   Intersection         A1         B1         A2         B2 adj_p_grp1 adj_p_grp2</span></span>
<span><span class="co">#&gt;              1 0.50000000 0.50000000 0.00000000 0.00000000 0.02400000 0.01000000</span></span>
<span><span class="co">#&gt;              2 0.50000000 0.50000000 0.00000000         NA 0.02400000 0.01000000</span></span>
<span><span class="co">#&gt;              3 0.50000000 0.50000000         NA 0.00000000 0.02400000 0.01000000</span></span>
<span><span class="co">#&gt;              4 0.50000000 0.50000000         NA         NA 0.02400000 0.01000000</span></span>
<span><span class="co">#&gt;              5 0.75000000         NA 0.00000000 0.25000000 0.01600000 1.00000000</span></span>
<span><span class="co">#&gt;              6 1.00000000         NA 0.00000000         NA 0.01200000 1.00000000</span></span>
<span><span class="co">#&gt;              7 0.75000000         NA         NA 0.25000000 0.01600000 1.00000000</span></span>
<span><span class="co">#&gt;              8 1.00000000         NA         NA         NA 0.01200000 1.00000000</span></span>
<span><span class="co">#&gt;              9         NA 0.75000000 0.25000000 0.00000000 1.00000000 0.00666667</span></span>
<span><span class="co">#&gt;             10         NA 0.75000000 0.25000000         NA 1.00000000 0.00666667</span></span>
<span><span class="co">#&gt;   adj_p_inter reject_intersection</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01000000                TRUE</span></span>
<span><span class="co">#&gt;    0.01600000                TRUE</span></span>
<span><span class="co">#&gt;    0.01200000                TRUE</span></span>
<span><span class="co">#&gt;    0.01600000                TRUE</span></span>
<span><span class="co">#&gt;    0.01200000                TRUE</span></span>
<span><span class="co">#&gt;    0.00666667                TRUE</span></span>
<span><span class="co">#&gt;    0.00666667                TRUE</span></span>
<span><span class="co">#&gt;   ... (Use `print(x, rows = &lt;nn&gt;)` for more)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Detailed test values ($test_values) --------------------------------------------</span></span>
<span><span class="co">#&gt;   Intersection Hypothesis       Test      p &lt;= Weight * Alpha Inequality_holds</span></span>
<span><span class="co">#&gt;              1         A1 bonferroni 0.0120 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;              1         B2 bonferroni 0.0135 &lt;=   0.00 * 0.025            FALSE</span></span>
<span><span class="co">#&gt;              1         B1      simes 0.0050 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;              1         A2      simes 0.0130 &lt;=   0.50 * 0.025            FALSE</span></span>
<span><span class="co">#&gt;              2         A1 bonferroni 0.0120 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;              2         B1      simes 0.0050 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;              2         A2      simes 0.0130 &lt;=   0.50 * 0.025            FALSE</span></span>
<span><span class="co">#&gt;              3         A1 bonferroni 0.0120 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;              3         B2 bonferroni 0.0135 &lt;=   0.00 * 0.025            FALSE</span></span>
<span><span class="co">#&gt;              3         B1      simes 0.0050 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;   ... (Use `print(x, rows = &lt;nn&gt;)` for more)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mix_test</span>, indent <span class="op">=</span> <span class="fl">6</span>, precision <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;       Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;       A1: 0.5</span></span>
<span><span class="co">#&gt;       B1: 0.5</span></span>
<span><span class="co">#&gt;       A2: 0.0</span></span>
<span><span class="co">#&gt;       B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       --- Transition weights ---</span></span>
<span><span class="co">#&gt;           A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;       A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;       B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;       A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;       B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;       Unadjusted p-values: 0.0120 0.0050 0.0130 0.0135</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Test types</span></span>
<span><span class="co">#&gt;       bonferroni: (A1, B2)</span></span>
<span><span class="co">#&gt;            simes: (B1, A2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test summary ($outputs) --------------------------------------------------------</span></span>
<span><span class="co">#&gt;       Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;               A1        0.016   TRUE</span></span>
<span><span class="co">#&gt;               B1        0.010   TRUE</span></span>
<span><span class="co">#&gt;               A2        0.026  FALSE</span></span>
<span><span class="co">#&gt;               B2        0.026  FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Final updated graph after removing rejected hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;       A1:  NA</span></span>
<span><span class="co">#&gt;       B1:  NA</span></span>
<span><span class="co">#&gt;       A2: 0.5</span></span>
<span><span class="co">#&gt;       B2: 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;       A1 NA NA NA NA</span></span>
<span><span class="co">#&gt;       B1 NA NA NA NA</span></span>
<span><span class="co">#&gt;       A2 NA NA  0  1</span></span>
<span><span class="co">#&gt;       B2 NA NA  1  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Adjusted p details ($details) --------------------------------------------------</span></span>
<span><span class="co">#&gt;       Intersection           A1           B1           A2           B2   adj_p_grp1</span></span>
<span><span class="co">#&gt;                  1 0.5000000000 0.5000000000 0.0000000000 0.0000000000 0.0240000000</span></span>
<span><span class="co">#&gt;                  2 0.5000000000 0.5000000000 0.0000000000           NA 0.0240000000</span></span>
<span><span class="co">#&gt;                  3 0.5000000000 0.5000000000           NA 0.0000000000 0.0240000000</span></span>
<span><span class="co">#&gt;                  4 0.5000000000 0.5000000000           NA           NA 0.0240000000</span></span>
<span><span class="co">#&gt;                  5 0.7500000000           NA 0.0000000000 0.2500000000 0.0160000000</span></span>
<span><span class="co">#&gt;                  6 1.0000000000           NA 0.0000000000           NA 0.0120000000</span></span>
<span><span class="co">#&gt;                  7 0.7500000000           NA           NA 0.2500000000 0.0160000000</span></span>
<span><span class="co">#&gt;                  8 1.0000000000           NA           NA           NA 0.0120000000</span></span>
<span><span class="co">#&gt;                  9           NA 0.7500000000 0.2500000000 0.0000000000 1.0000000000</span></span>
<span><span class="co">#&gt;                 10           NA 0.7500000000 0.2500000000           NA 1.0000000000</span></span>
<span><span class="co">#&gt;         adj_p_grp2  adj_p_inter reject_intersection</span></span>
<span><span class="co">#&gt;       0.0100000000 0.0100000000                TRUE</span></span>
<span><span class="co">#&gt;       0.0100000000 0.0100000000                TRUE</span></span>
<span><span class="co">#&gt;       0.0100000000 0.0100000000                TRUE</span></span>
<span><span class="co">#&gt;       0.0100000000 0.0100000000                TRUE</span></span>
<span><span class="co">#&gt;       1.0000000000 0.0160000000                TRUE</span></span>
<span><span class="co">#&gt;       1.0000000000 0.0120000000                TRUE</span></span>
<span><span class="co">#&gt;       1.0000000000 0.0160000000                TRUE</span></span>
<span><span class="co">#&gt;       1.0000000000 0.0120000000                TRUE</span></span>
<span><span class="co">#&gt;       0.0066666667 0.0066666667                TRUE</span></span>
<span><span class="co">#&gt;       0.0066666667 0.0066666667                TRUE</span></span>
<span><span class="co">#&gt;       ... (Use `print(x, rows = &lt;nn&gt;)` for more)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Detailed test values ($test_values) --------------------------------------------</span></span>
<span><span class="co">#&gt;       Intersection Hypothesis       Test      p &lt;= Weight * Alpha Inequality_holds</span></span>
<span><span class="co">#&gt;                  1         A1 bonferroni 0.0120 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;                  1         B2 bonferroni 0.0135 &lt;=   0.00 * 0.025            FALSE</span></span>
<span><span class="co">#&gt;                  1         B1      simes 0.0050 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;                  1         A2      simes 0.0130 &lt;=   0.50 * 0.025            FALSE</span></span>
<span><span class="co">#&gt;                  2         A1 bonferroni 0.0120 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;                  2         B1      simes 0.0050 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;                  2         A2      simes 0.0130 &lt;=   0.50 * 0.025            FALSE</span></span>
<span><span class="co">#&gt;                  3         A1 bonferroni 0.0120 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;                  3         B2 bonferroni 0.0135 &lt;=   0.00 * 0.025            FALSE</span></span>
<span><span class="co">#&gt;                  3         B1      simes 0.0050 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt;       ... (Use `print(x, rows = &lt;nn&gt;)` for more)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="power-simulations">Power simulations<a class="anchor" aria-label="anchor" href="#power-simulations"></a>
</h2>
<p>It’s not always obvious from a given graph how easy or difficult it
will be to reject each hypothesis. One way to understand this better is
to run a power simulation. The essence of a power simulation is to
generate many different p-values using some chosen distribution, then
test the graph against each set of p-values to see how it performs.</p>
<div class="section level3">
<h3 id="bonferroni-shortcut-1">Bonferroni (Shortcut)<a class="anchor" aria-label="anchor" href="#bonferroni-shortcut-1"></a>
</h3>
<p>The default for power simulations, like for testing, is to test a
graph at alpha level .025 with Bonferroni testing. The default number of
simulations (100) will typically need to be increased for more
meaningful results. In order to run as efficiently as possible,
Bonferroni power calculations use a custom shortcut method that is
highly optimized using vectorization and early exit.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span><span class="va">ss_graph</span>, sim_n <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1, B1, A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ($inputs) ------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations with multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      A1    B1    A2    B2</span></span>
<span><span class="co">#&gt;   Marginal power: 0.025 0.025 0.025 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation:    A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;                A1  1  0  0  0</span></span>
<span><span class="co">#&gt;                B1  0  1  0  0</span></span>
<span><span class="co">#&gt;                A2  0  0  1  0</span></span>
<span><span class="co">#&gt;                B2  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation ($power) -----------------------------------------------------</span></span>
<span><span class="co">#&gt;                                    A1      B1      A2      B2</span></span>
<span><span class="co">#&gt;                  Local power: 0.01259 0.01261 0.00005 0.00005</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Expected no. of rejections: 0.0253</span></span>
<span><span class="co">#&gt;    Power to reject 1 or more: 0.0249</span></span>
<span><span class="co">#&gt;          Power to reject all: 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="other-tests-closure">Other tests (Closure)<a class="anchor" aria-label="anchor" href="#other-tests-closure"></a>
</h3>
<p>All valid testing strategies are available for power calculations as
well - Simes, parametric, Bonferroni, or any combination of the three.
Note that groups consisting of a single hypothesis will be silently
converted to Bonferroni. Furthermore, a testing strategy comprised of
only Bonferroni groups will be silently converted to shortcut testing
for optimal performance.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">.5</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">corr2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">corr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">corr2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="va">corr2</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parametric testing correlation:     A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;                                   A1 1.0 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   B1 0.5 1.0 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   A2 0.5 0.5 1.0 0.5</span></span>
<span><span class="co">#&gt;                                   B2 0.5 0.5 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   parametric: (A1, B1, A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ($inputs) ------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations with multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                      A1    B1    A2    B2</span></span>
<span><span class="co">#&gt;   Marginal power: 0.025 0.025 0.025 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation:    A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;                A1  1  0  0  0</span></span>
<span><span class="co">#&gt;                B1  0  1  0  0</span></span>
<span><span class="co">#&gt;                A2  0  0  1  0</span></span>
<span><span class="co">#&gt;                B2  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation ($power) -----------------------------------------------------</span></span>
<span><span class="co">#&gt;                                    A1      B1      A2      B2</span></span>
<span><span class="co">#&gt;                  Local power: 0.01337 0.01386 0.00008 0.00008</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Expected no. of rejections: 0.02739</span></span>
<span><span class="co">#&gt;    Power to reject 1 or more: 0.02675</span></span>
<span><span class="co">#&gt;          Power to reject all: 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulation-options">Simulation options<a class="anchor" aria-label="anchor" href="#simulation-options"></a>
</h3>
<p>In addition to the testing-related options, there are options which
control how p-values are simulated from the multivariate normal
distribution. These parameters control the (estimated) “true”
distribution of the hypotheses.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_corr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">.25</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1</span>, <span class="fl">.25</span>, <span class="fl">.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.25</span>, <span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="va">corr2</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">.4</span>, <span class="fl">.9</span>, <span class="fl">.9</span><span class="op">)</span>,</span>
<span>  sim_corr <span class="op">=</span> <span class="va">s_corr1</span>,</span>
<span>  sim_seed <span class="op">=</span> <span class="fl">52423</span>, <span class="co"># Set a seed if you need consistent p-values</span></span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parametric testing correlation:     A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;                                   A1 1.0 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   B1 0.5 1.0 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   A2 0.5 0.5 1.0 0.5</span></span>
<span><span class="co">#&gt;                                   B2 0.5 0.5 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   parametric: (A1, B1, A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ($inputs) ------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations - random seed 52423 &amp; multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   Marginal power: 0.4 0.4 0.9 0.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation:      A1   B1   A2   B2</span></span>
<span><span class="co">#&gt;                A1 1.00 0.50 0.50 0.25</span></span>
<span><span class="co">#&gt;                B1 0.50 1.00 0.25 0.50</span></span>
<span><span class="co">#&gt;                A2 0.50 0.25 1.00 0.50</span></span>
<span><span class="co">#&gt;                B2 0.25 0.50 0.50 1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation ($power) -----------------------------------------------------</span></span>
<span><span class="co">#&gt;                                    A1      B1      A2      B2</span></span>
<span><span class="co">#&gt;                  Local power: 0.34218 0.34307 0.32693 0.32817</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Expected no. of rejections: 1.34035</span></span>
<span><span class="co">#&gt;    Power to reject 1 or more: 0.45411</span></span>
<span><span class="co">#&gt;          Power to reject all: 0.22202</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="power-output">Power output<a class="anchor" aria-label="anchor" href="#power-output"></a>
</h3>
<p>The four standard power calculations are: - Local power - The rate
each individual hypothesis is rejected in the power simulation -
Expected no. of rejections - The average rejections per simulation -
Power to reject 1 or more - Proportion of simulations that reject at
least 1 hypothesis - Power to reject all - Proportion of simulations
that reject every hypothesis</p>
<p>In addition to these standard calculations, a user can define
arbitrary “success” power calculations. For instance, in the simple
successive example, perhaps the clinical trial will only be considered a
success if both primary hypotheses are rejected.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="va">corr2</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">.4</span>, <span class="fl">.9</span>, <span class="fl">.9</span><span class="op">)</span>,</span>
<span>  sim_corr <span class="op">=</span> <span class="va">s_corr1</span>,</span>
<span>  sim_seed <span class="op">=</span> <span class="fl">52423</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  sim_success <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parametric testing correlation:     A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;                                   A1 1.0 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   B1 0.5 1.0 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   A2 0.5 0.5 1.0 0.5</span></span>
<span><span class="co">#&gt;                                   B2 0.5 0.5 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   parametric: (A1, B1, A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ($inputs) ------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations - random seed 52423 &amp; multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   Marginal power: 0.4 0.4 0.9 0.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation:      A1   B1   A2   B2</span></span>
<span><span class="co">#&gt;                A1 1.00 0.50 0.50 0.25</span></span>
<span><span class="co">#&gt;                B1 0.50 1.00 0.25 0.50</span></span>
<span><span class="co">#&gt;                A2 0.50 0.25 1.00 0.50</span></span>
<span><span class="co">#&gt;                B2 0.25 0.50 0.50 1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation ($power) -----------------------------------------------------</span></span>
<span><span class="co">#&gt;                                    A1      B1      A2      B2</span></span>
<span><span class="co">#&gt;                  Local power: 0.34218 0.34307 0.32693 0.32817</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Expected no. of rejections: 1.34035</span></span>
<span><span class="co">#&gt;    Power to reject 1 or more: 0.45411</span></span>
<span><span class="co">#&gt;          Power to reject all: 0.22202</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Power to reject:    x[1] &amp; x[2]</span></span>
<span><span class="co">#&gt;                                      0.23114</span></span></code></pre></div>
<p>Because success functions could be anything, this parameter has few
limitations. It is up to the user to understand the meaning of their
functions. Each user defined function is applied to each simulation’s
test results, and the resulting vector is averaged.</p>
<p>Here are a few more success function examples, some of which imitate
the standard calculations. When using logical operators, make sure to
use the vectorized operators (|, &amp;), rather than the single-value
operators (||, &amp;&amp;). Hypotheses can be weighted as well.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="va">corr2</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">.4</span>, <span class="fl">.9</span>, <span class="fl">.9</span><span class="op">)</span>,</span>
<span>  sim_corr <span class="op">=</span> <span class="va">s_corr1</span>,</span>
<span>  sim_seed <span class="op">=</span> <span class="fl">52423</span>, <span class="co"># Set a seed if you need consistent p-values</span></span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  sim_success <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    A1 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    B1 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    `Expected no. of rejections` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>    `1 or more` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>    `All` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>    `All 'A' or all 'B'` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    `Weighted` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">.75</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">.25</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parametric testing correlation:     A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;                                   A1 1.0 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   B1 0.5 1.0 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   A2 0.5 0.5 1.0 0.5</span></span>
<span><span class="co">#&gt;                                   B2 0.5 0.5 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   parametric: (A1, B1, A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ($inputs) ------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations - random seed 52423 &amp; multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   Marginal power: 0.4 0.4 0.9 0.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation:      A1   B1   A2   B2</span></span>
<span><span class="co">#&gt;                A1 1.00 0.50 0.50 0.25</span></span>
<span><span class="co">#&gt;                B1 0.50 1.00 0.25 0.50</span></span>
<span><span class="co">#&gt;                A2 0.50 0.25 1.00 0.50</span></span>
<span><span class="co">#&gt;                B2 0.25 0.50 0.50 1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation ($power) -----------------------------------------------------</span></span>
<span><span class="co">#&gt;                                    A1      B1      A2      B2</span></span>
<span><span class="co">#&gt;                  Local power: 0.34218 0.34307 0.32693 0.32817</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Expected no. of rejections: 1.34035</span></span>
<span><span class="co">#&gt;    Power to reject 1 or more: 0.45411</span></span>
<span><span class="co">#&gt;          Power to reject all: 0.22202</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Power to reject:       A1      B1   Expected no. of rejections</span></span>
<span><span class="co">#&gt;                                0.34218 0.34307                      1.34035</span></span>
<span><span class="co">#&gt;    1 or more     All   All 'A' or all 'B'   Weighted</span></span>
<span><span class="co">#&gt;      0.45411 0.22202              0.43308    0.32724</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="verbose-simulation-details">Verbose simulation details<a class="anchor" aria-label="anchor" href="#verbose-simulation-details"></a>
</h3>
<p>Finally, power output has a <code>verbose</code> option, which opts
in to include the full simulation and test results matrices.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="va">corr2</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.4</span>, <span class="fl">.4</span>, <span class="fl">.9</span>, <span class="fl">.9</span><span class="op">)</span>,</span>
<span>  sim_corr <span class="op">=</span> <span class="va">s_corr1</span>,</span>
<span>  sim_seed <span class="op">=</span> <span class="fl">52423</span>, <span class="co"># Set a seed if you need consistent p-values</span></span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  sim_success <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    A1 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>    B1 <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span>
<span>    `Expected no. of rejections` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>    `1 or more` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>    `All` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span>
<span>    `All 'A' or all 'B'` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span>
<span>    `Weighted` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">.75</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> <span class="fl">.25</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5</span></span>
<span><span class="co">#&gt;   B1: 0.5</span></span>
<span><span class="co">#&gt;   A2: 0.0</span></span>
<span><span class="co">#&gt;   B2: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   A1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   B1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   A2 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   B2 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parametric testing correlation:     A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;                                   A1 1.0 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   B1 0.5 1.0 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   A2 0.5 0.5 1.0 0.5</span></span>
<span><span class="co">#&gt;                                   B2 0.5 0.5 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   parametric: (A1, B1, A2, B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ($inputs) ------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations - random seed 52423 &amp; multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                    A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;   Marginal power: 0.4 0.4 0.9 0.9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation:      A1   B1   A2   B2</span></span>
<span><span class="co">#&gt;                A1 1.00 0.50 0.50 0.25</span></span>
<span><span class="co">#&gt;                B1 0.50 1.00 0.25 0.50</span></span>
<span><span class="co">#&gt;                A2 0.50 0.25 1.00 0.50</span></span>
<span><span class="co">#&gt;                B2 0.25 0.50 0.50 1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation ($power) -----------------------------------------------------</span></span>
<span><span class="co">#&gt;                                    A1      B1      A2      B2</span></span>
<span><span class="co">#&gt;                  Local power: 0.34218 0.34307 0.32693 0.32817</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Expected no. of rejections: 1.34035</span></span>
<span><span class="co">#&gt;    Power to reject 1 or more: 0.45411</span></span>
<span><span class="co">#&gt;          Power to reject all: 0.22202</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Power to reject:       A1      B1   Expected no. of rejections</span></span>
<span><span class="co">#&gt;                                0.34218 0.34307                      1.34035</span></span>
<span><span class="co">#&gt;    1 or more     All   All 'A' or all 'B'   Weighted</span></span>
<span><span class="co">#&gt;      0.45411 0.22202              0.43308    0.32724</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation details ($details) --------------------------------------------------</span></span>
<span><span class="co">#&gt;       p_sim_A1    p_sim_B1    p_sim_A2    p_sim_B2 rej_A1 rej_B1 rej_A2 rej_B2</span></span>
<span><span class="co">#&gt;    2.74637e-01 3.83560e-02 5.86796e-05 4.27462e-03  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;    1.33122e-02 3.50128e-02 1.71171e-02 2.01723e-02   TRUE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;    8.22089e-02 2.62597e-03 6.90286e-06 1.65241e-06  FALSE   TRUE  FALSE   TRUE</span></span>
<span><span class="co">#&gt;    6.08713e-02 2.15700e-01 9.00666e-05 9.38607e-06  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;    1.55222e-01 1.02561e-01 8.27598e-03 4.35962e-02  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;    3.96010e-01 1.61318e-01 2.97455e-02 6.35532e-04  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;    3.05257e-02 2.14666e-02 6.00712e-04 6.42489e-04  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;    2.21610e-03 1.64975e-01 2.48138e-04 7.84712e-03   TRUE  FALSE   TRUE  FALSE</span></span>
<span><span class="co">#&gt;    6.32585e-01 4.07002e-01 1.22133e-02 5.69852e-04  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;    1.85722e-01 2.07899e-01 4.60219e-03 9.19664e-04  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   ... (Use `print(x, rows = &lt;nn&gt;)` for more)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="power-print-options">Power print options<a class="anchor" aria-label="anchor" href="#power-print-options"></a>
</h2>
<p>Like testing, the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> method for power output uses
the <code>indent</code> and <code>precision</code> arguments.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dong Xi, Ethan Brockmann, Gilead Biostatistics.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
