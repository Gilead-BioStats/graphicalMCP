<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="graphicalMCP">
<title>Generating the closure tree â€¢ graphicalMCP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generating the closure tree">
<meta property="og:description" content="graphicalMCP">
<meta property="og:image" content="https://urban-sniffle-p11zlpj.pages.github.io/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/graphicalMCP.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/case-study.html">Case Study</a>
    <a class="dropdown-item" href="../articles/performance.html">Generating the closure tree</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generating the closure tree</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/graphicalMCP/blob/HEAD/vignettes/performance.Rmd" class="external-link"><code>vignettes/performance.Rmd</code></a></small>
      <div class="d-none name"><code>performance.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://urban-sniffle-p11zlpj.pages.github.io/">graphicalMCP</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lrstat</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://gsrmtp.r-forge.r-project.org/" class="external-link">gMCP</a></span><span class="op">)</span></span>
<span><span class="co">##&gt; </span></span>
<span><span class="co">##&gt; Attaching package: 'gMCP'</span></span>
<span><span class="co">##&gt; The following object is masked from 'package:graphicalMCP':</span></span>
<span><span class="co">##&gt; </span></span>
<span><span class="co">##&gt;     fallback</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://here.r-lib.org/" class="external-link">here</a></span><span class="op">)</span></span>
<span><span class="co">##&gt; here() starts at /home/runner/work/graphicalMCP/graphicalMCP</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bench.r-lib.org/" class="external-link">bench</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">##&gt; </span></span>
<span><span class="co">##&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">##&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">##&gt; </span></span>
<span><span class="co">##&gt;     filter, lag</span></span>
<span><span class="co">##&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">##&gt; </span></span>
<span><span class="co">##&gt;     intersect, setdiff, setequal, union</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jabiru/tictoc" class="external-link">tictoc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://forcats.tidyverse.org/" class="external-link">forcats</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot_benchmarks</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df_benchmarks</span>,</span>
<span>                            <span class="va">subtitle</span>,</span>
<span>                            <span class="va">x_max</span> <span class="op">=</span> <span class="fl">14</span>,</span>
<span>                            <span class="va">y_breaks</span> <span class="op">=</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>                            <span class="va">scale</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span></span>
<span>    <span class="va">df_benchmarks</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      <span class="va">size</span>,</span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">scale</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">median</span> <span class="op">*</span> <span class="fl">1e5</span> <span class="op">/</span> <span class="va">sims</span><span class="op">)</span> <span class="kw">else</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">median</span><span class="op">)</span>,</span>
<span>      colour <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder2</a></span><span class="op">(</span><span class="va">char_expression</span>, <span class="va">size</span>, <span class="va">median</span><span class="op">)</span>,</span>
<span>      group <span class="op">=</span> <span class="va">char_expression</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>      data <span class="op">=</span> <span class="va">.</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">char_expression</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="va">median</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">size</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>label <span class="op">=</span> <span class="va">char_expression</span><span class="op">)</span>,</span>
<span>      nudge_x <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>      nudge_y <span class="op">=</span> <span class="fl">.2</span>,</span>
<span>      color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>      size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>      hjust <span class="op">=</span> <span class="fl">0</span>,</span>
<span>      check_overlap <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fl">2</span><span class="op">:</span><span class="fl">10</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">x_max</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="co"># scale_y_log10(</span></span>
<span>    <span class="co">#   breaks = y_breaks,</span></span>
<span>    <span class="co">#   labels =</span></span>
<span>    <span class="co">#     function(breaks) format(breaks, scientific = FALSE, big.mark = ",")</span></span>
<span>    <span class="co"># ) +</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>      title <span class="op">=</span> <span class="st">"Median run time (sec, log scale)"</span>,</span>
<span>      subtitle <span class="op">=</span> <span class="va">subtitle</span>,</span>
<span>      x <span class="op">=</span> <span class="st">"Number of hypotheses"</span>,</span>
<span>      y <span class="op">=</span> <span class="cn">NULL</span></span>
<span>    <span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"none"</span>, panel.grid.minor <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">table_benchmarks</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">df</span>, <span class="va">title</span>, <span class="va">unit</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">char_expression</span>, <span class="va">size</span>, <span class="va">median</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">size</span>, values_from <span class="op">=</span> <span class="va">median</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span></span>
<span>      pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"{x}"</span>, <span class="va">unit</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span><span class="st">"Number of hypotheses"</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">df</span><span class="op">$</span><span class="va">size</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html" class="external-link">cols_label</a></span><span class="op">(</span>char_expression <span class="op">=</span> <span class="st">"Algorithm"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://gt.rstudio.com/reference/tab_options.html" class="external-link">tab_options</a></span><span class="op">(</span>table.font.size <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>An emphasis of the graphicalMCP package is performance, and one place
where improved performance was especially needed was the function to
generate weights of all sub-graphs for an MCP graph -
<code><a href="https://rdrr.io/pkg/gMCP/man/generateWeights.html" class="external-link">gMCP::generateWeights()</a></code> or
<code><a href="../reference/graph_generate_weights.html">graphicalMCP::graph_generate_weights()</a></code>. We attempted to
create this function using three main strategies, and compared their
speed and memory performance with each other, as well as with the gMCP
implementation.</p>
</div>
<div class="section level2">
<h2 id="methodology">Methodology<a class="anchor" aria-label="anchor" href="#methodology"></a>
</h2>
<p>The sub-graphs of a graph can be thought of as a tree structure,
where each vertex is a sub-graph. The root of the tree is the initial
graph, and each successive level of the tree is created by deleting each
single node from the graphs in the level above.</p>
<div class="section level3">
<h3 id="each-from-initial---gw_original">Each-from-initial - <code>gw_original()</code><a class="anchor" aria-label="anchor" href="#each-from-initial---gw_original"></a>
</h3>
<p>The first and simplest method of generating sub-graph weights builds
on the exported <code><a href="../reference/graph_update.html">graph_update()</a></code> function, which takes a
graph and logical vector (h-vector) as arguments and deletes all the
hypotheses from the graph corresponding to the <code>FALSE</code>
entries in the h-vector. In this case, the whole closure of a graph is
generated as <code>2^n - 1</code> h-vectors. This can be done
efficiently with <code>expand.grid(rep(list(1:0), n))[-2^n, ]</code>,
where <code>n</code> is the number of hypotheses in the graph. Then the
initial graph is passed to <code><a href="../reference/graph_update.html">graph_update()</a></code> along with each
h-vector to determine the weights for each sub-graph.</p>
<p>This method is very straightforward, and the steps are clear.
However, it is not efficient because each element of the closure starts
with the full graph before deleting appropriate hypotheses. This means
that for a graph of size 5, hypothesis e.g.Â <code>3</code> gets deleted
to get to the <code>1-2-4-5</code> graph, and then again to get to the
<code>2-4-5</code> graph, and so on.</p>
</div>
<div class="section level3">
<h3 id="parent-child-recursive---graph_generate_weights_recursive">Parent-child recursive -
<code>graph_generate_weights_recursive()</code><a class="anchor" aria-label="anchor" href="#parent-child-recursive---graph_generate_weights_recursive"></a>
</h3>
<p>Because of the tree structure of the closure of a graph, recursion is
a logical candidate for traversing it. In the recursive method, the
initial graph is the starting point still. Each hypothesis is deleted
from the initial graph, and the recursion is called on each of these
smaller graphs as a new starting point. This means that to get to a
sub-graph of size 2, it wonâ€™t start at size 5 and delete 3 hypotheses;
it will start at size 3 and delete a single hypothesis. For each level
of the recursion, the starting graph &amp; all sub-graphs are returned
in a list where each element is a graph. If the graph is an endpoint of
the recursion, just the graph is returned.</p>
<p>One of the keys to this method is that, whenever a hypothesis is
deleted and the resulting graph passed down the recursion, the
corresponding elements of the hypothesis and transition weights are
fully removed from the graph structure. This means that previously
deleted rows are not unnecessarily included in loops further down into
the recursion.</p>
<p>Furthermore, the recursive algorithm has a way to remember what the
last hypothesis removed was, and it only creates children by deleting
hypotheses larger than the last-deleted node. This avoids the situation
of creating level 3+ graphs multiple times by deleting the same nodes
but in a different order.</p>
<p>This method is quite fast, but still not the fastest. It is the most
memory-efficient.</p>
</div>
<div class="section level3">
<h3 id="parent-child-formula---graph_generate_weights">Parent-child formula - <code>graph_generate_weights()</code><a class="anchor" aria-label="anchor" href="#parent-child-formula---graph_generate_weights"></a>
</h3>
<p>Using the recursive method created significant gains in speed and
memory efficiency, but one other way is even faster. The recursive
method generates a list of all sub-graphs, where each graph occurs after
its parent. This means that if thereâ€™s a formulaic way to find a graphâ€™s
parent given the graphâ€™s location in the list, the parent-child location
relationship could be calculated rather than generated with
recursion.</p>
<p>For the graph ordering generated by
<code>rev(expand.grid(rep(list(1:0), n))[-2^n, ])</code>, this formula
is straightforward. This ordering generates h-vectors that can be
thought of as binary numbers counting down from <code>2^n</code> to
<code>1</code>. This means that the bottom half of the h-vectors are
identical to the top half, except that the first entry is a 0 instead of
a 1. Thus, the parents of the bottom half, elements
<code>2^n / 2 -&gt; 1</code>, are the elements
<code>2^n -&gt; 2^n / 2 + 1</code>. And the node to delete to move from
an element in the top half to an element in the bottom half is the
first. This same logic then applies to the top half and the bottom half
individually, ignoring element 1. Each time the set of h-vectors is
divided in half, it yields the h-vectors for a graph of size
<code>n - 1</code> in each half.</p>
<p>Without generating the h-vectors at all, the parent index and
node-to-delete index can be calculated directly. The parent index vector
is sequential blocks of <code>1:(2^k)</code> sequences, and the
node-to-delete vector is sequential blocks of <code>n - k</code>
repeated <code>k + 1</code> times, with
<code>0 &lt;= k &lt;= n - 1</code>. Both vectors have the last element
removed, which corresponds to creating the empty sub-graph.</p>
<div class="section level4">
<h4 id="proof-idea">Proof idea<a class="anchor" aria-label="anchor" href="#proof-idea"></a>
</h4>
<p>Let <code>g</code> be a valid MCP graph with <code>n</code>
hypotheses. We proceed by induction on <code>n</code>.</p>
<div class="section level5">
<h5 id="intuition-and-base-cases">Intuition and base cases<a class="anchor" aria-label="anchor" href="#intuition-and-base-cases"></a>
</h5>
<p>Let <code>n</code> = 1. Then the closure of <code>g</code> is simply
the trivial sub-graph, <code>g</code>. The parent and delete vectors are
empty.</p>
<p>Let <code>n</code> = 2. Then the closure of <code>g</code> is
<code>(1, 1), (1, 0), (0, 1)</code>. The parent vector is
<code>(1, 1)</code>, and the delete vector is <code>(2, 1)</code>.</p>
<p>Let <code>n</code> = 3. Then the closure of <code>g</code> is
<code>(1, 1, 1), (1, 1, 0), (1, 0, 1), (1, 0, 0), (0, 1, 1), (0, 1, 0), (0, 0, 1)</code>.
The parent vector is <code>(1, 1, 2, 1, 2, 3)</code>, and the delete
vector is <code>(3, 2, 2, 1, 1, 1)</code>.</p>
</div>
<div class="section level5">
<h5 id="inductive-step">Inductive step<a class="anchor" aria-label="anchor" href="#inductive-step"></a>
</h5>
<p>Suppose these formulas hold for a graph of size <code>n - 1</code>.
Then the closure is <code>2^(n - 1) -&gt; 1</code> in binary, the parent
vector is sequential <code>1:2^k</code> sequences, and the delete vector
is sequential blocks of <code>n - 1 - k</code> repeated
<code>k + 1</code> times, with <code>0 &lt;= k &lt;= n - 2</code>. Add a
hypothesis to get to a graph of size <code>n</code>. Then the new
closure is the <code>n - 1</code> closure repeated twice, with a 1
before the first repeat, and a 0 before the second. Thus the difference
between a row in the top half and corresponding row in the bottom half
is <code>2^(n - 1)</code>. And the only difference in elements between
such rows is the first element has switched from 1 to 0. Thus, the
parent index of a row in the bottom half is the corresponding row in the
top half, and the node to delete is the first.</p>
<p><span style="float:right"><span class="math inline">\(\blacksquare\)</span></span></p>
</div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a>
</h2>
<p>We analyzed performance of the various methods using the bench
package.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7523</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">12</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="va">keep_cols</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"min"</span>,</span>
<span>    <span class="st">"median"</span>,</span>
<span>    <span class="st">"itr/sec"</span>,</span>
<span>    <span class="st">"mem_alloc"</span>,</span>
<span>    <span class="st">"gc/sec"</span>,</span>
<span>    <span class="st">"n_itr"</span>,</span>
<span>    <span class="st">"n_gc"</span>,</span>
<span>    <span class="st">"total_time"</span>,</span>
<span>    <span class="st">"size"</span>,</span>
<span>    <span class="st">"char_expression"</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_gw.rds"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df_benchmarks_gw</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_gw.rds"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">list_benchmarks_gw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>    <span class="va">sizes</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">size</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">rando</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example-graphs.html">random_graph</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span></span>
<span>      <span class="va">trn</span> <span class="op">&lt;-</span> <span class="va">rando</span><span class="op">$</span><span class="va">transitions</span></span>
<span>      <span class="va">hyp</span> <span class="op">&lt;-</span> <span class="va">rando</span><span class="op">$</span><span class="va">hypotheses</span></span>
<span></span>
<span>      <span class="co"># lrstat::fwgtmat() errors out due to weights not summing to 1, sometimes</span></span>
<span>      <span class="co"># even when they seem to sum to 1 exactly. This loop tests whether</span></span>
<span>      <span class="co"># fwgtmat() will run successfully, and updates weights if not</span></span>
<span>      <span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>      <span class="va">res_is_error</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>      <span class="kw">while</span> <span class="op">(</span><span class="va">res_is_error</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">hyp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">size</span> <span class="op">-</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">hyp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">size</span> <span class="op">-</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span>, <span class="fl">6</span><span class="op">)</span></span>
<span>          <span class="va">hyp</span><span class="op">[</span><span class="op">(</span><span class="va">size</span> <span class="op">-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">size</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">hyp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">size</span> <span class="op">-</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">i</span></span>
<span>        <span class="op">}</span></span>
<span></span>
<span>        <span class="va">res</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lrstat/man/fwgtmat.html" class="external-link">fwgtmat</a></span><span class="op">(</span><span class="va">hyp</span>, <span class="va">trn</span><span class="op">)</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>        <span class="va">res_is_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"try-error"</span><span class="op">)</span></span>
<span></span>
<span>        <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>      <span class="op">}</span></span>
<span></span>
<span>      <span class="va">speed_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://bench.r-lib.org/reference/mark.html" class="external-link">mark</a></span><span class="op">(</span></span>
<span>        `gMCP (R)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gMCP/man/generateWeights.html" class="external-link">generateWeights</a></span><span class="op">(</span><span class="va">trn</span>, <span class="va">hyp</span><span class="op">)</span>,</span>
<span>        `graphicalMCP (R)` <span class="op">=</span> <span class="fu"><a href="../reference/graph_generate_weights.html">graph_generate_weights</a></span><span class="op">(</span><span class="va">rando</span><span class="op">)</span>,</span>
<span>        `lrstat (C++)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lrstat/man/fwgtmat.html" class="external-link">fwgtmat</a></span><span class="op">(</span><span class="va">hyp</span>, <span class="va">trn</span><span class="op">)</span>,</span>
<span>        check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        min_iterations <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        time_unit <span class="op">=</span> <span class="st">"ms"</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="va">size</span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">mem_alloc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">speed_comp</span><span class="op">$</span><span class="va">mem_alloc</span><span class="op">)</span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">char_expression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">speed_comp</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">speed_comp</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">df_benchmarks_gw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">list_benchmarks_gw</span><span class="op">)</span><span class="op">[</span><span class="va">keep_cols</span><span class="op">]</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span></span>
<span>    <span class="va">df_benchmarks_gw</span>,</span>
<span>    <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_gw.rds"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df_benchmarks_gw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">char_expression</span> <span class="op">!=</span> <span class="st">"lrstat (C++)"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">plot_benchmarks</span><span class="op">(</span><span class="st">"Generate weights of the closure"</span>, <span class="fl">12</span>, <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="performance_files/figure-html/df-benchmarks-gw-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df_benchmarks_gw</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">char_expression</span> <span class="op">!=</span> <span class="st">"lrstat (C++)"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">char_expression</span>, <span class="va">size</span>, <span class="va">median</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="va">size</span>, values_from <span class="op">=</span> <span class="va">median</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/gt.html" class="external-link">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_header.html" class="external-link">tab_header</a></span><span class="op">(</span><span class="st">"Generate weights of the closure"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/fmt_number.html" class="external-link">fmt_number</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"{x}ms"</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_spanner.html" class="external-link">tab_spanner</a></span><span class="op">(</span><span class="st">"Number of hypotheses"</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">7</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/cols_label.html" class="external-link">cols_label</a></span><span class="op">(</span>char_expression <span class="op">=</span> <span class="st">"Package"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://gt.rstudio.com/reference/tab_options.html" class="external-link">tab_options</a></span><span class="op">(</span>table.font.size <span class="op">=</span> <span class="fl">24</span><span class="op">)</span></span></code></pre></div>
<div id="dttwctnkeg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dttwctnkeg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dttwctnkeg thead, #dttwctnkeg tbody, #dttwctnkeg tfoot, #dttwctnkeg tr, #dttwctnkeg td, #dttwctnkeg th {
  border-style: none;
}

#dttwctnkeg p {
  margin: 0;
  padding: 0;
}

#dttwctnkeg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 24px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dttwctnkeg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dttwctnkeg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dttwctnkeg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dttwctnkeg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dttwctnkeg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dttwctnkeg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dttwctnkeg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dttwctnkeg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dttwctnkeg .gt_spanner_row {
  border-bottom-style: hidden;
}

#dttwctnkeg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dttwctnkeg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dttwctnkeg .gt_from_md > :first-child {
  margin-top: 0;
}

#dttwctnkeg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dttwctnkeg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dttwctnkeg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dttwctnkeg .gt_row_group_first td {
  border-top-width: 2px;
}

#dttwctnkeg .gt_row_group_first th {
  border-top-width: 2px;
}

#dttwctnkeg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dttwctnkeg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dttwctnkeg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dttwctnkeg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dttwctnkeg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_left {
  text-align: left;
}

#dttwctnkeg .gt_center {
  text-align: center;
}

#dttwctnkeg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dttwctnkeg .gt_font_normal {
  font-weight: normal;
}

#dttwctnkeg .gt_font_bold {
  font-weight: bold;
}

#dttwctnkeg .gt_font_italic {
  font-style: italic;
}

#dttwctnkeg .gt_super {
  font-size: 65%;
}

#dttwctnkeg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dttwctnkeg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dttwctnkeg .gt_indent_1 {
  text-indent: 5px;
}

#dttwctnkeg .gt_indent_2 {
  text-indent: 10px;
}

#dttwctnkeg .gt_indent_3 {
  text-indent: 15px;
}

#dttwctnkeg .gt_indent_4 {
  text-indent: 20px;
}

#dttwctnkeg .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Generate weights of the closure</td>
    </tr>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Package">Package</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="6" scope="colgroup" id="Number of hypotheses">
        <span class="gt_column_spanner">Number of hypotheses</span>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="2">2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="4">4</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="6">6</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="8">8</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="10">10</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="12">12</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="char_expression" class="gt_row gt_left">gMCP (R)</td>
<td headers="2" class="gt_row gt_right">0.41ms</td>
<td headers="4" class="gt_row gt_right">2.24ms</td>
<td headers="6" class="gt_row gt_right">13.90ms</td>
<td headers="8" class="gt_row gt_right">86.84ms</td>
<td headers="10" class="gt_row gt_right">575.72ms</td>
<td headers="12" class="gt_row gt_right">4,542.30ms</td>
</tr>
<tr>
<td headers="char_expression" class="gt_row gt_left">graphicalMCP (R)</td>
<td headers="2" class="gt_row gt_right">0.09ms</td>
<td headers="4" class="gt_row gt_right">0.40ms</td>
<td headers="6" class="gt_row gt_right">1.77ms</td>
<td headers="8" class="gt_row gt_right">7.73ms</td>
<td headers="10" class="gt_row gt_right">37.46ms</td>
<td headers="12" class="gt_row gt_right">161.44ms</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7523</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">12</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_seqtest.rds"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df_benchmarks_seqtest</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_seqtest.rds"</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="va">keep_cols</span><span class="op">]</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="va">list_benchmarks_seqtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>    <span class="va">sizes</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">size</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">rando</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example-graphs.html">random_graph</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span></span>
<span>      <span class="va">trn</span> <span class="op">&lt;-</span> <span class="va">rando</span><span class="op">$</span><span class="va">transitions</span></span>
<span>      <span class="va">hyp</span> <span class="op">&lt;-</span> <span class="va">rando</span><span class="op">$</span><span class="va">hypotheses</span></span>
<span></span>
<span>      <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu">mvtnorm</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mvtnorm/man/Mvnorm.html" class="external-link">rmvnorm</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">size</span>, <span class="fl">1.5</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>      <span class="co"># lrstat::fwgtmat() errors out due to weights not summing to 1, sometimes</span></span>
<span>      <span class="co"># even when they seem to sum to 1 exactly. This loop tests whether</span></span>
<span>      <span class="co"># fwgtmat() will run successfully, and updates weights if not</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="va">size</span> <span class="op">!=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">i</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>        <span class="va">res_is_error</span> <span class="op">&lt;-</span> <span class="cn">TRUE</span></span>
<span>        <span class="kw">while</span> <span class="op">(</span><span class="va">res_is_error</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">hyp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">size</span> <span class="op">-</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">hyp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">size</span> <span class="op">-</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span>, <span class="fl">6</span><span class="op">)</span></span>
<span>            <span class="va">hyp</span><span class="op">[</span><span class="op">(</span><span class="va">size</span> <span class="op">-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="va">size</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">hyp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">size</span> <span class="op">-</span> <span class="va">i</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="va">i</span></span>
<span>          <span class="op">}</span></span>
<span></span>
<span>          <span class="va">res</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lrstat/man/fwgtmat.html" class="external-link">fwgtmat</a></span><span class="op">(</span><span class="va">hyp</span>, <span class="va">trn</span><span class="op">)</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>          <span class="va">res_is_error</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">res</span>, <span class="st">"try-error"</span><span class="op">)</span></span>
<span></span>
<span>          <span class="va">i</span> <span class="op">&lt;-</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span></span>
<span>      <span class="va">speed_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://bench.r-lib.org/reference/mark.html" class="external-link">mark</a></span><span class="op">(</span></span>
<span>        `gMCP shortcut (C)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/gMCP/man/gMCP.html" class="external-link">gMCP</a></span><span class="op">(</span><span class="fu"><a href="../reference/as-graph.html">as_gmcp_graph</a></span><span class="op">(</span><span class="va">rando</span><span class="op">)</span>, <span class="va">p</span>, alpha <span class="op">=</span> <span class="fl">.025</span><span class="op">)</span><span class="op">@</span><span class="va">rejected</span>,</span>
<span>        `graphicalMCP shortcut (R)` <span class="op">=</span> <span class="fu"><a href="../reference/testing.html">graph_test_shortcut</a></span><span class="op">(</span><span class="va">rando</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>        `lrstat Bonferroni (C++)` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/lrstat/man/fadjpbon.html" class="external-link">fadjpbon</a></span><span class="op">(</span><span class="va">hyp</span>, <span class="va">trn</span>, <span class="va">p</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">.025</span>,</span>
<span>        `gMCP closure parametric (R)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/gMCP/man/gMCP.html" class="external-link">gMCP</a></span><span class="op">(</span><span class="fu"><a href="../reference/as-graph.html">as_gmcp_graph</a></span><span class="op">(</span><span class="va">rando</span><span class="op">)</span>, <span class="va">p</span>, alpha <span class="op">=</span> <span class="fl">.025</span>, corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        `graphicalMCP closure parametric (R)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="../reference/testing.html">graph_test_closure</a></span><span class="op">(</span><span class="va">rando</span>, <span class="va">p</span>, corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        `lrstat Simes (C++)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/lrstat/man/fadjpsim.html" class="external-link">fadjpsim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/lrstat/man/fwgtmat.html" class="external-link">fwgtmat</a></span><span class="op">(</span><span class="va">hyp</span>, <span class="va">trn</span><span class="op">)</span>, <span class="va">p</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, ncol <span class="op">=</span> <span class="va">size</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">.025</span>,</span>
<span>        `graphicalMCP closure Simes (R)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="../reference/testing.html">graph_test_closure</a></span><span class="op">(</span><span class="va">rando</span>, <span class="va">p</span>, test_types <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span>,</span>
<span>        check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        min_iterations <span class="op">=</span> <span class="fl">5</span>,</span>
<span>        time_unit <span class="op">=</span> <span class="st">"ms"</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="va">size</span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">mem_alloc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">speed_comp</span><span class="op">$</span><span class="va">mem_alloc</span><span class="op">)</span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">char_expression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">speed_comp</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">speed_comp</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">df_benchmarks_seqtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">list_benchmarks_seqtest</span><span class="op">)</span><span class="op">[</span><span class="va">keep_cols</span><span class="op">]</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span></span>
<span>    <span class="va">df_benchmarks_seqtest</span>,</span>
<span>    <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_seqtest.rds"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df_benchmarks_seqtest</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span></span>
<span>    <span class="op">!</span><span class="va">char_expression</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"lrstat Bonferroni (C++)"</span>,</span>
<span>      <span class="st">"lrstat Simes (C++)"</span>,</span>
<span>      <span class="st">"graphicalMCP closure Simes (R)"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">plot_benchmarks</span><span class="op">(</span><span class="st">"Test a graph"</span><span class="op">)</span></span></code></pre></div>
<p><img src="performance_files/figure-html/df-benchmarks-seqtest-1.png" width="672"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7523</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">20</span>, by <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">^</span><span class="fl">17</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_power_shortcut.rds"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df_benchmarks_power_shortcut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_power_shortcut.rds"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">[</span><span class="va">keep_cols</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">char_expression</span> <span class="op">==</span> <span class="st">"gMCP closure parametric (R)"</span> <span class="op">&amp;</span> <span class="va">size</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">""</span>, file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/log/pwr_short.log"</span><span class="op">)</span>, append <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">list_benchmarks_power_shortcut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>    <span class="va">sizes</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">size</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span></span>
<span>        <span class="va">size</span>, <span class="st">"|"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span>,</span>
<span>        file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/log/pwr_short.log"</span><span class="op">)</span>,</span>
<span>        append <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>      <span class="va">rando</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example-graphs.html">random_graph</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span></span>
<span>      <span class="va">trn</span> <span class="op">&lt;-</span> <span class="va">rando</span><span class="op">$</span><span class="va">transitions</span></span>
<span>      <span class="va">hyp</span> <span class="op">&lt;-</span> <span class="va">rando</span><span class="op">$</span><span class="va">hypotheses</span></span>
<span></span>
<span>      <span class="va">marg_pow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.95</span>, <span class="va">size</span><span class="op">)</span></span>
<span>      <span class="va">ncp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">.025</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">marg_pow</span><span class="op">)</span></span>
<span>      <span class="va">t_corr</span> <span class="op">&lt;-</span> <span class="va">s_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">speed_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://bench.r-lib.org/reference/mark.html" class="external-link">mark</a></span><span class="op">(</span></span>
<span>        `gMCP shortcut (C)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/pkg/gMCP/man/calcPower.html" class="external-link">calcPower</a></span><span class="op">(</span><span class="va">hyp</span>, <span class="fl">.025</span>, <span class="va">trn</span>, <span class="va">ncp</span>, <span class="va">s_corr</span>, n.sim <span class="op">=</span> <span class="va">sims</span><span class="op">)</span>,</span>
<span>        `graphicalMCP shortcut, high power (R)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span><span class="va">rando</span>,</span>
<span>            sim_n <span class="op">=</span> <span class="va">sims</span>, marginal_power <span class="op">=</span> <span class="va">marg_pow</span>,</span>
<span>            sim_corr <span class="op">=</span> <span class="va">s_corr</span></span>
<span>          <span class="op">)</span>,</span>
<span>        `graphicalMCP shortcut, mid power (R)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span><span class="va">rando</span>,</span>
<span>            sim_n <span class="op">=</span> <span class="va">sims</span>, marginal_power <span class="op">=</span> <span class="va">marg_pow</span> <span class="op">/</span> <span class="fl">2</span>,</span>
<span>            sim_corr <span class="op">=</span> <span class="va">s_corr</span></span>
<span>          <span class="op">)</span>,</span>
<span>        `graphicalMCP shortcut, low power (R)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span><span class="va">rando</span>,</span>
<span>            sim_n <span class="op">=</span> <span class="va">sims</span>, marginal_power <span class="op">=</span> <span class="va">marg_pow</span> <span class="op">/</span> <span class="fl">20</span>,</span>
<span>            sim_corr <span class="op">=</span> <span class="va">s_corr</span></span>
<span>          <span class="op">)</span>,</span>
<span>        check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        min_iterations <span class="op">=</span> <span class="fl">3</span>,</span>
<span>        time_unit <span class="op">=</span> <span class="st">"s"</span>,</span>
<span>        memory <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="va">size</span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">mem_alloc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">speed_comp</span><span class="op">$</span><span class="va">mem_alloc</span><span class="op">)</span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">char_expression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">speed_comp</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">speed_comp</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span>,</span>
<span>    file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/log/pwr_short.log"</span><span class="op">)</span>,</span>
<span>    append <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">df_benchmarks_power_shortcut</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">list_benchmarks_power_shortcut</span><span class="op">)</span><span class="op">[</span><span class="va">keep_cols</span><span class="op">]</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span></span>
<span>    <span class="va">df_benchmarks_power_shortcut</span>,</span>
<span>    <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_power_shortcut.rds"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df_benchmarks_power_shortcut</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># filter(char_expression != "graphicalMCP closure Simes (R)") %&gt;%</span></span>
<span>  <span class="fu">plot_benchmarks</span><span class="op">(</span><span class="st">"Power: 131,072 simulations"</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="performance_files/figure-html/df-benchmarks-power-shortcut-1.png" width="672"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df_benchmarks_power_shortcut</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">table_benchmarks</span><span class="op">(</span><span class="st">"Power: 131,072 simulations"</span>, <span class="st">"s"</span><span class="op">)</span></span></code></pre></div>
<div id="dttwctnkeg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dttwctnkeg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dttwctnkeg thead, #dttwctnkeg tbody, #dttwctnkeg tfoot, #dttwctnkeg tr, #dttwctnkeg td, #dttwctnkeg th {
  border-style: none;
}

#dttwctnkeg p {
  margin: 0;
  padding: 0;
}

#dttwctnkeg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dttwctnkeg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dttwctnkeg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dttwctnkeg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dttwctnkeg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dttwctnkeg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dttwctnkeg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dttwctnkeg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dttwctnkeg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dttwctnkeg .gt_spanner_row {
  border-bottom-style: hidden;
}

#dttwctnkeg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dttwctnkeg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dttwctnkeg .gt_from_md > :first-child {
  margin-top: 0;
}

#dttwctnkeg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dttwctnkeg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dttwctnkeg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dttwctnkeg .gt_row_group_first td {
  border-top-width: 2px;
}

#dttwctnkeg .gt_row_group_first th {
  border-top-width: 2px;
}

#dttwctnkeg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dttwctnkeg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dttwctnkeg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dttwctnkeg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dttwctnkeg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_left {
  text-align: left;
}

#dttwctnkeg .gt_center {
  text-align: center;
}

#dttwctnkeg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dttwctnkeg .gt_font_normal {
  font-weight: normal;
}

#dttwctnkeg .gt_font_bold {
  font-weight: bold;
}

#dttwctnkeg .gt_font_italic {
  font-style: italic;
}

#dttwctnkeg .gt_super {
  font-size: 65%;
}

#dttwctnkeg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dttwctnkeg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dttwctnkeg .gt_indent_1 {
  text-indent: 5px;
}

#dttwctnkeg .gt_indent_2 {
  text-indent: 10px;
}

#dttwctnkeg .gt_indent_3 {
  text-indent: 15px;
}

#dttwctnkeg .gt_indent_4 {
  text-indent: 20px;
}

#dttwctnkeg .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="6" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Power: 131,072 simulations</td>
    </tr>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Algorithm">Algorithm</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="5" scope="colgroup" id="Number of hypotheses">
        <span class="gt_column_spanner">Number of hypotheses</span>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="4">4</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="8">8</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="12">12</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="16">16</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="20">20</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="char_expression" class="gt_row gt_left">gMCP shortcut (C)</td>
<td headers="4" class="gt_row gt_right">0.40s</td>
<td headers="8" class="gt_row gt_right">1.45s</td>
<td headers="12" class="gt_row gt_right">4.41s</td>
<td headers="16" class="gt_row gt_right">9.91s</td>
<td headers="20" class="gt_row gt_right">18.70s</td>
</tr>
<tr>
<td headers="char_expression" class="gt_row gt_left">graphicalMCP shortcut, high power (R)</td>
<td headers="4" class="gt_row gt_right">1.11s</td>
<td headers="8" class="gt_row gt_right">1.55s</td>
<td headers="12" class="gt_row gt_right">2.01s</td>
<td headers="16" class="gt_row gt_right">5.79s</td>
<td headers="20" class="gt_row gt_right">67.68s</td>
</tr>
<tr>
<td headers="char_expression" class="gt_row gt_left">graphicalMCP shortcut, mid power (R)</td>
<td headers="4" class="gt_row gt_right">1.19s</td>
<td headers="8" class="gt_row gt_right">1.33s</td>
<td headers="12" class="gt_row gt_right">1.68s</td>
<td headers="16" class="gt_row gt_right">4.82s</td>
<td headers="20" class="gt_row gt_right">65.80s</td>
</tr>
<tr>
<td headers="char_expression" class="gt_row gt_left">graphicalMCP shortcut, low power (R)</td>
<td headers="4" class="gt_row gt_right">0.87s</td>
<td headers="8" class="gt_row gt_right">0.95s</td>
<td headers="12" class="gt_row gt_right">1.18s</td>
<td headers="16" class="gt_row gt_right">4.40s</td>
<td headers="20" class="gt_row gt_right">68.08s</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">7523</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sizes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">14</span>, by <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">^</span><span class="fl">16</span></span>
<span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_power_closure.rds"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">df_benchmarks_power_closure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_power_closure.rds"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">[</span><span class="va">keep_cols</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">char_expression</span> <span class="op">==</span> <span class="st">"gMCP closure parametric (R)"</span> <span class="op">&amp;</span> <span class="va">size</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">""</span>, file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/log/pwr_clos.log"</span><span class="op">)</span>, append <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">list_benchmarks_power_closure</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>    <span class="va">sizes</span>,</span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">size</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span></span>
<span>        <span class="va">size</span>, <span class="st">"|"</span>, <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span>,</span>
<span>        file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/log/pwr_clos.log"</span><span class="op">)</span>,</span>
<span>        append <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>      <span class="va">rando</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example-graphs.html">random_graph</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span></span>
<span>      <span class="va">trn</span> <span class="op">&lt;-</span> <span class="va">rando</span><span class="op">$</span><span class="va">transitions</span></span>
<span>      <span class="va">hyp</span> <span class="op">&lt;-</span> <span class="va">rando</span><span class="op">$</span><span class="va">hypotheses</span></span>
<span></span>
<span>      <span class="va">marg_pow</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">.8</span>, <span class="va">size</span><span class="op">)</span></span>
<span>      <span class="va">ncp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">.025</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">marg_pow</span><span class="op">)</span></span>
<span>      <span class="va">t_corr</span> <span class="op">&lt;-</span> <span class="va">s_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">speed_comp</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://bench.r-lib.org/reference/mark.html" class="external-link">mark</a></span><span class="op">(</span></span>
<span>        `gMCP closure parametric (R)` <span class="op">=</span></span>
<span>          <span class="kw">if</span> <span class="op">(</span><span class="va">size</span> <span class="op">&lt;</span> <span class="fl">6</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="fu"><a href="https://rdrr.io/pkg/gMCP/man/calcPower.html" class="external-link">calcPower</a></span><span class="op">(</span></span>
<span>              <span class="va">hyp</span>, <span class="fl">.025</span>, <span class="va">trn</span>,</span>
<span>              <span class="va">marg_pow</span>, <span class="va">s_corr</span>, <span class="va">t_corr</span>, <span class="va">sims</span></span>
<span>            <span class="op">)</span></span>
<span>          <span class="op">}</span>,</span>
<span>        `graphicalMCP closure Bonferroni (R)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span><span class="va">rando</span>,</span>
<span>            sim_n <span class="op">=</span> <span class="va">sims</span>, marginal_power <span class="op">=</span> <span class="va">marg_pow</span>,</span>
<span>            sim_corr <span class="op">=</span> <span class="va">s_corr</span>,</span>
<span>            force_closure <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>          <span class="op">)</span>,</span>
<span>        `graphicalMCP closure parametric (R)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span><span class="va">rando</span>,</span>
<span>            sim_n <span class="op">=</span> <span class="va">sims</span>, marginal_power <span class="op">=</span> <span class="va">marg_pow</span>,</span>
<span>            sim_corr <span class="op">=</span> <span class="va">s_corr</span>, test_types <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>            test_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">t_corr</span><span class="op">)</span></span>
<span>          <span class="op">)</span>,</span>
<span>        `graphicalMCP closure Simes (R)` <span class="op">=</span></span>
<span>          <span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span><span class="va">rando</span>,</span>
<span>            sim_n <span class="op">=</span> <span class="va">sims</span>, marginal_power <span class="op">=</span> <span class="va">marg_pow</span>,</span>
<span>            sim_corr <span class="op">=</span> <span class="va">s_corr</span>, test_types <span class="op">=</span> <span class="st">"simes"</span></span>
<span>          <span class="op">)</span>,</span>
<span>        check <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>        min_iterations <span class="op">=</span> <span class="fl">1</span>,</span>
<span>        time_unit <span class="op">=</span> <span class="st">"s"</span></span>
<span>      <span class="op">)</span></span>
<span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="va">size</span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">mem_alloc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">speed_comp</span><span class="op">$</span><span class="va">mem_alloc</span><span class="op">)</span></span>
<span>      <span class="va">speed_comp</span><span class="op">$</span><span class="va">char_expression</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">speed_comp</span><span class="op">$</span><span class="va">expression</span><span class="op">)</span></span>
<span></span>
<span>      <span class="va">speed_comp</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span>,</span>
<span>    file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/log/pwr_clos.log"</span><span class="op">)</span>,</span>
<span>    append <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="va">df_benchmarks_power_closure</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="va">list_benchmarks_power_closure</span><span class="op">)</span><span class="op">[</span><span class="va">keep_cols</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="va">char_expression</span> <span class="op">==</span> <span class="st">"gMCP closure parametric (R)"</span> <span class="op">&amp;</span> <span class="va">size</span> <span class="op">&gt;</span> <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">saveRDS</a></span><span class="op">(</span></span>
<span>    <span class="va">df_benchmarks_power_closure</span>,</span>
<span>    <span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/data/df_benchmarks_power_closure.rds"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">df_benchmarks_power_closure</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># filter(char_expression != "graphicalMCP closure Simes (R)") %&gt;%</span></span>
<span>  <span class="fu">plot_benchmarks</span><span class="op">(</span><span class="st">"Power: 65,536 simulations"</span>, scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="performance_files/figure-html/df-benchmarks-power-closure-1.png" width="672"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">df_benchmarks_power_closure</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">table_benchmarks</span><span class="op">(</span><span class="st">"Power: 65,536 simulations"</span>, <span class="st">"s"</span><span class="op">)</span></span></code></pre></div>
<div id="dttwctnkeg" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dttwctnkeg table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dttwctnkeg thead, #dttwctnkeg tbody, #dttwctnkeg tfoot, #dttwctnkeg tr, #dttwctnkeg td, #dttwctnkeg th {
  border-style: none;
}

#dttwctnkeg p {
  margin: 0;
  padding: 0;
}

#dttwctnkeg .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dttwctnkeg .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dttwctnkeg .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dttwctnkeg .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dttwctnkeg .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dttwctnkeg .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dttwctnkeg .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dttwctnkeg .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dttwctnkeg .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dttwctnkeg .gt_spanner_row {
  border-bottom-style: hidden;
}

#dttwctnkeg .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dttwctnkeg .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dttwctnkeg .gt_from_md > :first-child {
  margin-top: 0;
}

#dttwctnkeg .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dttwctnkeg .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dttwctnkeg .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dttwctnkeg .gt_row_group_first td {
  border-top-width: 2px;
}

#dttwctnkeg .gt_row_group_first th {
  border-top-width: 2px;
}

#dttwctnkeg .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dttwctnkeg .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dttwctnkeg .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dttwctnkeg .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dttwctnkeg .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dttwctnkeg .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dttwctnkeg .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dttwctnkeg .gt_left {
  text-align: left;
}

#dttwctnkeg .gt_center {
  text-align: center;
}

#dttwctnkeg .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dttwctnkeg .gt_font_normal {
  font-weight: normal;
}

#dttwctnkeg .gt_font_bold {
  font-weight: bold;
}

#dttwctnkeg .gt_font_italic {
  font-style: italic;
}

#dttwctnkeg .gt_super {
  font-size: 65%;
}

#dttwctnkeg .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dttwctnkeg .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dttwctnkeg .gt_indent_1 {
  text-indent: 5px;
}

#dttwctnkeg .gt_indent_2 {
  text-indent: 10px;
}

#dttwctnkeg .gt_indent_3 {
  text-indent: 15px;
}

#dttwctnkeg .gt_indent_4 {
  text-indent: 20px;
}

#dttwctnkeg .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="table gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading">
<td colspan="8" class="gt_heading gt_title gt_font_normal gt_bottom_border" style>Power: 65,536 simulations</td>
    </tr>
<tr class="gt_col_headings gt_spanner_row">
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1" scope="col" id="Algorithm">Algorithm</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="7" scope="colgroup" id="Number of hypotheses">
        <span class="gt_column_spanner">Number of hypotheses</span>
      </th>
    </tr>
<tr class="gt_col_headings">
<th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="2">2</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="4">4</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="6">6</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="8">8</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="10">10</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="12">12</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="14">14</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr>
<td headers="char_expression" class="gt_row gt_left">gMCP closure parametric (R)</td>
<td headers="2" class="gt_row gt_right">85.90s</td>
<td headers="4" class="gt_row gt_right">1,008.81s</td>
<td headers="6" class="gt_row gt_right">NA</td>
<td headers="8" class="gt_row gt_right">NA</td>
<td headers="10" class="gt_row gt_right">NA</td>
<td headers="12" class="gt_row gt_right">NA</td>
<td headers="14" class="gt_row gt_right">NA</td>
</tr>
<tr>
<td headers="char_expression" class="gt_row gt_left">graphicalMCP closure Bonferroni (R)</td>
<td headers="2" class="gt_row gt_right">1.38s</td>
<td headers="4" class="gt_row gt_right">1.60s</td>
<td headers="6" class="gt_row gt_right">2.86s</td>
<td headers="8" class="gt_row gt_right">5.15s</td>
<td headers="10" class="gt_row gt_right">16.34s</td>
<td headers="12" class="gt_row gt_right">75.76s</td>
<td headers="14" class="gt_row gt_right">334.83s</td>
</tr>
<tr>
<td headers="char_expression" class="gt_row gt_left">graphicalMCP closure parametric (R)</td>
<td headers="2" class="gt_row gt_right">1.36s</td>
<td headers="4" class="gt_row gt_right">1.86s</td>
<td headers="6" class="gt_row gt_right">2.42s</td>
<td headers="8" class="gt_row gt_right">6.15s</td>
<td headers="10" class="gt_row gt_right">27.65s</td>
<td headers="12" class="gt_row gt_right">155.12s</td>
<td headers="14" class="gt_row gt_right">956.28s</td>
</tr>
<tr>
<td headers="char_expression" class="gt_row gt_left">graphicalMCP closure Simes (R)</td>
<td headers="2" class="gt_row gt_right">3.76s</td>
<td headers="4" class="gt_row gt_right">4.13s</td>
<td headers="6" class="gt_row gt_right">5.06s</td>
<td headers="8" class="gt_row gt_right">8.47s</td>
<td headers="10" class="gt_row gt_right">24.09s</td>
<td headers="12" class="gt_row gt_right">99.43s</td>
<td headers="14" class="gt_row gt_right">461.30s</td>
</tr>
</tbody>
</table>
</div>
<p>All methods increase in time by <code>O(2^n)</code>, but the starting
point is lowest for <code><a href="../reference/graph_generate_weights.html">graph_generate_weights()</a></code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_benchmarks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_benchmarks_gw</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_y_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gg_benchmarks</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span>,</span>
<span>      <span class="va">median</span>,</span>
<span>      colour <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder2</a></span><span class="op">(</span><span class="va">char_expression</span>, <span class="va">size</span>, <span class="va">median</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="external-link">geom_text</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="va">.</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">char_expression</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://tidyr.tidyverse.org/reference/drop_na.html" class="external-link">drop_na</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">size</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span>,</span>
<span>      <span class="va">median</span>,</span>
<span>      label <span class="op">=</span> <span class="va">char_expression</span></span>
<span>    <span class="op">)</span>,</span>
<span>    nudge_x <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>    nudge_y <span class="op">=</span> <span class="fl">.12</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>    size <span class="op">=</span> <span class="fl">7</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    colour <span class="op">=</span> <span class="st">"Expression"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Log of median runtime in milliseconds"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Graph size"</span>,</span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="performance_files/figure-html/gg-benchmarks-runtime-1.png" width="672"></p>
<p>Memory also increases at about <code>O(2^n)</code>, but here the
recursive solution shows a slight advantage.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gg_benchmarks</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">size</span><span class="op">)</span>,</span>
<span>      <span class="va">mem_alloc</span>,</span>
<span>      colour <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html" class="external-link">fct_reorder2</a></span><span class="op">(</span><span class="va">char_expression</span>, <span class="va">size</span>, <span class="va">median</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    colour <span class="op">=</span> <span class="st">"Expression"</span>,</span>
<span>    title <span class="op">=</span> <span class="st">"Log of bytes used"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Graph size"</span>,</span>
<span>    y <span class="op">=</span> <span class="cn">NULL</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">##&gt; Warning: Transformation introduced infinite values in continuous y-axis</span></span></code></pre></div>
<p><img src="performance_files/figure-html/gg-benchmarks-memory-1.png" width="672"></p>
</div>
<div class="section level2">
<h2 id="performance-example">Performance example<a class="anchor" aria-label="anchor" href="#performance-example"></a>
</h2>
<p>In order to further demonstrate the performance improvement, we will
simulate a size 15 graph and generate weights in 2 different ways.
Results can be demonstrated to be equivalent, and the time difference
will be shown as well. We can see that the performance improvement is
significant, especially for larger graphs.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">check_methods</span> <span class="op">&lt;-</span> <span class="fu">xfun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xfun/man/cache_rds.html" class="external-link">cache_rds</a></span><span class="op">(</span></span>
<span>  <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1515</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span></span>
<span>    <span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="va">w</span> <span class="op">&lt;-</span> <span class="va">w</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span>    <span class="va">g</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span></span>
<span>    <span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"graphMCP"</span>, m <span class="op">=</span> <span class="va">g</span>, weights <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span>
<span>    <span class="va">graph2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_create.html">graph_create</a></span><span class="op">(</span><span class="va">w</span>, <span class="va">g</span><span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">tic</a></span><span class="op">(</span><span class="st">"gMCP::generateWeights()"</span><span class="op">)</span></span>
<span>    <span class="va">gmcp_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gMCP/man/generateWeights.html" class="external-link">generateWeights</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span>
<span>    <span class="va">tictoc_gmcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">toc</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">callback_msg</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">tic</a></span><span class="op">(</span><span class="st">"graphicalMCP::graph_generate_weights()"</span><span class="op">)</span></span>
<span>    <span class="va">graphicalmcp_weights</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_generate_weights.html">graph_generate_weights</a></span><span class="op">(</span><span class="va">graph2</span><span class="op">)</span></span>
<span>    <span class="va">tictoc_graphicalmcp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/tictoc/man/tic.html" class="external-link">toc</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">callback_msg</span></span>
<span></span>
<span>    <span class="co"># Order of results is reversed between packages, and column names differ,</span></span>
<span>    <span class="co"># but values are the same</span></span>
<span>    <span class="va">res_equal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">gmcp_weights</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">gmcp_weights</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="va">graphicalmcp_weights</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">tictoc_gmcp</span>, <span class="va">tictoc_graphicalmcp</span>, <span class="va">res_equal</span><span class="op">)</span></span>
<span>  <span class="op">}</span>,</span>
<span>  clean <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">check_methods</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">##&gt; gMCP::generateWeights(): 34.073 sec elapsed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">check_methods</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">##&gt; graphicalMCP::graph_generate_weights(): 1.34 sec elapsed</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span></span>
<span>  <span class="st">"Results from the two packages are equal (up to ordering &amp; names):"</span>,</span>
<span>  <span class="va">check_methods</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,</span>
<span>  <span class="st">"\n"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">##&gt; Results from the two packages are equal (up to ordering &amp; names): TRUE</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dong Xi, Ethan Brockmann, Gilead Biostatistics.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
