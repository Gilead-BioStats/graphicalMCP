<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="graphicalMCP">
<title>Common multiple comparison procedures illustrated using graphicalMCP • graphicalMCP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Common multiple comparison procedures illustrated using graphicalMCP">
<meta property="og:description" content="graphicalMCP">
<meta property="og:image" content="https://gilead-biostats.github.io/graphicalMCP/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/graphicalMCP.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/glossary.html">Glossary</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/shortcut-testing.html">Sequentially rejective graphical multiple comparison procedures based on Bonferroni tests</a>
    <a class="dropdown-item" href="../articles/closed-testing.html">Graphical multiple comparison procedures based on the closure principle</a>
    <a class="dropdown-item" href="../articles/graph-examples.html">Common multiple comparison procedures illustrated using graphicalMCP</a>
    <a class="dropdown-item" href="../articles/comparisons.html">Comparisons with other packages</a>
    <a class="dropdown-item" href="../articles/generate-closure.html">Rationales to generate the closure and the weighting strategy of a graph</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Common multiple comparison procedures illustrated using graphicalMCP</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/graphicalMCP/blob/HEAD/vignettes/graph-examples.Rmd" class="external-link"><code>vignettes/graph-examples.Rmd</code></a></small>
      <div class="d-none name"><code>graph-examples.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gilead-biostats.github.io/graphicalMCP/">graphicalMCP</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In confirmatory clinical trials, regulatory guidelines mandate the
strong control of the family-wise error rate at a prespecified level
<span class="math inline">\(\alpha\)</span>. Many multiple comparison
procedures (MCPs) have been proposed for this purpose. The graphical
approaches are a general framework that include many common MCPs as
special cases. In this vignette, we illustrate how to use graphicalMCP
to perform some common MCPs.</p>
<p>To test <span class="math inline">\(m\)</span> hypotheses using a
graphical MCP, each hypothesis <span class="math inline">\(H_i\)</span>
receives a weight <span class="math inline">\(0\leq w_i\leq 1\)</span>
(called hypothesis weight), where <span class="math inline">\(\sum_{i=1}^{m}w_i\leq 1\)</span>. From <span class="math inline">\(H_i\)</span> to <span class="math inline">\(H_j\)</span>, there could be a directed and
weighted edge <span class="math inline">\(0\leq g_{ij}\leq 1\)</span>,
which means that when <span class="math inline">\(H_i\)</span> is
rejected, its hypothesis weight will be propagated (or transferred) to
<span class="math inline">\(H_j\)</span> and <span class="math inline">\(g_{ij}\)</span> determines how much of the
propagation. We also require <span class="math inline">\(\sum_{j=1}^{m}g_{ij}\leq 1\)</span> and <span class="math inline">\(g_{ii}=0\)</span>.</p>
</div>
<div class="section level2">
<h2 id="bonferroni-based-procedures">Bonferroni-based procedures<a class="anchor" aria-label="anchor" href="#bonferroni-based-procedures"></a>
</h2>
<div class="section level3">
<h3 id="weighted-bonferroni-test">Weighted Bonferroni test<a class="anchor" aria-label="anchor" href="#weighted-bonferroni-test"></a>
</h3>
<p>A weighted Bonferroni test splits <span class="math inline">\(\alpha\)</span> among hypotheses by testing every
hypothesis at a significance level of <span class="math inline">\(w_i\alpha\)</span>. Thus it rejects a hypothesis
if its p-value is less than or equal to its significance level. When
<span class="math inline">\(w_i=w_j\)</span> for all <span class="math inline">\(i,j\)</span>, this means an equal split and the
test is the Bonferroni test. There is no propagation between any pair of
hypothesis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">bonferroni_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_graphs.html">bonferroni</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">m</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># transitions &lt;- matrix(0, m, m)</span></span>
<span><span class="co"># bonferroni_graph &lt;- graph_create(rep(1 / m, m), transitions)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">bonferroni_graph</span>,</span>
<span>  layout <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/layout_in_circle.html" class="external-link">layout_in_circle</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/as_graph.html">as_igraph</a></span><span class="op">(</span><span class="va">bonferroni_graph</span><span class="op">)</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  vertex.size <span class="op">=</span> <span class="fl">70</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/bonferroni-1.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/graph_test_shortcut.html">graph_test_shortcut</a></span><span class="op">(</span></span>
<span>    <span class="va">bonferroni_graph</span>,</span>
<span>    p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;    H1    H2    H3 </span></span>
<span><span class="co">#&gt;  TRUE FALSE FALSE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="holm-procedure">Holm Procedure<a class="anchor" aria-label="anchor" href="#holm-procedure"></a>
</h3>
<p>Holm (or Bonferroni-Holm) procedures improve over Bonferroni tests by
allowing propagation <span class="citation">(Holm 1979)</span>. In other
words, transition weights between hypotheses may not be zero. So it is
uniformly more powerful than Bonferroni tests.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">holm_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_graphs.html">bonferroni_holm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">m</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># transitions &lt;- matrix(1 / (m - 1), m, m)</span></span>
<span><span class="co"># diag(transitions) &lt;- 0</span></span>
<span><span class="co"># holm_graph &lt;- graph_create(rep(1 / m, m), transitions)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">holm_graph</span>,</span>
<span>  layout <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/layout_in_circle.html" class="external-link">layout_in_circle</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/as_graph.html">as_igraph</a></span><span class="op">(</span><span class="va">holm_graph</span><span class="op">)</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  vertex.size <span class="op">=</span> <span class="fl">70</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/bonferroni-holm-1.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_test_shortcut.html">graph_test_shortcut</a></span><span class="op">(</span><span class="va">holm_graph</span>, p <span class="op">=</span> <span class="va">p_values</span>, alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;    H1    H2    H3 </span></span>
<span><span class="co">#&gt;  TRUE FALSE FALSE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fixed-sequence-procedure">Fixed sequence procedure<a class="anchor" aria-label="anchor" href="#fixed-sequence-procedure"></a>
</h3>
<p>Fixed sequence (or hierarchical) procedures pre-specify an order of
testing [<span class="citation">Maurer, Hothorn, and Lehmacher
(1995)</span>;westfall-2001-optimally]. For example, the procedure will
test <span class="math inline">\(H_1\)</span> first. If it is rejected,
it will test <span class="math inline">\(H_2\)</span>; otherwise the
testing stops. If <span class="math inline">\(H_2\)</span> is rejected,
it will test <span class="math inline">\(H_3\)</span>; otherwise the
testing stops. For each hypothesis, it will be tested at the full <span class="math inline">\(\alpha\)</span> level, when it can be tested.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">fixed_sequence_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_graphs.html">fixed_sequence</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span><span class="co"># transitions &lt;- rbind(</span></span>
<span><span class="co">#   c(0, 1, 0),</span></span>
<span><span class="co">#   c(0, 0, 1),</span></span>
<span><span class="co">#   c(0, 0, 0)</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># fixed_sequence_graph &lt;- graph_create(c(1, 0, 0), transitions)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fixed_sequence_graph</span>, nrow <span class="op">=</span> <span class="fl">1</span>, asp <span class="op">=</span> <span class="fl">0.05</span>, vertex.size <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/fixed-sequence-1-1.png" width="432" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/graph_test_shortcut.html">graph_test_shortcut</a></span><span class="op">(</span></span>
<span>    <span class="va">fixed_sequence_graph</span>,</span>
<span>    p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;   H1   H2   H3 </span></span>
<span><span class="co">#&gt; TRUE TRUE TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fallback-procedure">Fallback procedure<a class="anchor" aria-label="anchor" href="#fallback-procedure"></a>
</h3>
<p>Fallback procedures have one-way propagation (like fixed sequence
procedures) but allow hypotheses to be tested at different significance
levels <span class="citation">(Wiens 2003)</span>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">fallback_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_graphs.html">fallback</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># transitions &lt;- rbind(</span></span>
<span><span class="co">#   c(0, 1, 0),</span></span>
<span><span class="co">#   c(0, 0, 1),</span></span>
<span><span class="co">#   c(0, 0, 0)</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># fallback_graph &lt;- graph_create(rep(1 / 3, 3), transitions)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fallback_graph</span>, nrow <span class="op">=</span> <span class="fl">1</span>, asp <span class="op">=</span> <span class="fl">0.05</span>, vertex.size <span class="op">=</span> <span class="fl">40</span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/fallback-1.png" width="432" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/graph_test_shortcut.html">graph_test_shortcut</a></span><span class="op">(</span></span>
<span>    <span class="va">fallback_graph</span>,</span>
<span>    p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;   H1   H2   H3 </span></span>
<span><span class="co">#&gt; TRUE TRUE TRUE</span></span></code></pre></div>
<p>Further they can be improved to allow propagation from later
hypotheses to earlier hypotheses, because it is possible that a later
hypothesis is rejected before an earlier hypothesis can be rejected.
There are two versions of improvement: <code>fallback_improved_1</code>
due to <span class="citation">(Wiens and Dmitrienko 2005)</span> and
<code>fallback_improved_2</code> due to <span class="citation">(Bretz et
al. 2009)</span> respectively.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">fallback_improved_1_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_graphs.html">fallback_improved_1</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># hypotheses &lt;- rep(1 / 3, 3)</span></span>
<span><span class="co"># transitions &lt;- rbind(</span></span>
<span><span class="co">#   c(0, 1, 0),</span></span>
<span><span class="co">#   c(0, 0, 1),</span></span>
<span><span class="co">#   c(hypotheses[seq_len(m - 1)] / sum(hypotheses[seq_len(m - 1)]), 0)</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># fallback_improved_1_graph &lt;- graph_create(rep(1 / 3, 3), transitions)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">fallback_improved_1_graph</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  asp <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  vertex.size <span class="op">=</span> <span class="fl">40</span>,</span>
<span>  edge_curves <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pairs"</span> <span class="op">=</span> <span class="fl">7</span>, <span class="st">"H3|H1"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/fallback-improved-1.png" width="432" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fl">0.0001</span></span>
<span><span class="va">fallback_improved_2_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_graphs.html">fallback_improved_2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">epsilon</span><span class="op">)</span></span>
<span><span class="co"># hypotheses &lt;- rep(1 / 3, 3)</span></span>
<span><span class="co"># transitions &lt;- rbind(</span></span>
<span><span class="co">#   c(0, 1, 0),</span></span>
<span><span class="co">#   c(1 - epsilon, 0, epsilon),</span></span>
<span><span class="co">#   c(1, 0, 0)</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># fallback_improved_2_graph &lt;- graph_create(rep(1 / 3, 3), transitions)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">fallback_improved_2_graph</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  asp <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">0.0001</span>,</span>
<span>  edge_curves <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pairs"</span> <span class="op">=</span> <span class="fl">7</span>, <span class="st">"H3|H1"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>  vertex.size <span class="op">=</span> <span class="fl">40</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/fallback-improved-2.png" width="432" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/graph_test_shortcut.html">graph_test_shortcut</a></span><span class="op">(</span></span>
<span>    <span class="va">fallback_improved_2_graph</span>,</span>
<span>    p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;   H1   H2   H3 </span></span>
<span><span class="co">#&gt; TRUE TRUE TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="serial-gatekeeping-procedure">Serial gatekeeping procedure<a class="anchor" aria-label="anchor" href="#serial-gatekeeping-procedure"></a>
</h3>
<p>Serial gatekeeping procedures involve ordered multiple families of
hypotheses, where all hypotheses of a family of hypotheses must be
rejected before proceeding in the test sequence. The example below
considers a primary family consisting of two hypotheses <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> and a secondary family consisting of
a single hypothesis <span class="math inline">\(H_3\)</span>. In the
primary family, the Holm procedure is applied. If both <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> are rejected, <span class="math inline">\(H_3\)</span> can be tested at level <span class="math inline">\(\alpha\)</span>; otherwise <span class="math inline">\(H_3\)</span> cannot be rejected. To allow the
conditional propagation to <span class="math inline">\(H_3\)</span>, an
<span class="math inline">\(\varepsilon\)</span> edge is used from <span class="math inline">\(H_2\)</span> to <span class="math inline">\(H_3\)</span>. It has a very small transition
weight so that <span class="math inline">\(H_2\)</span> propagates most
of its hypothesis weight to <span class="math inline">\(H_1\)</span> (if
not already rejected) and retains a small (non-zero) weight for <span class="math inline">\(H_3\)</span> so that if <span class="math inline">\(H_1\)</span> has been rejected, all hypothesis
weight of <span class="math inline">\(H_2\)</span> will be propagated to
<span class="math inline">\(H_3\)</span>. Here <span class="math inline">\(\varepsilon\)</span> is assigned to be 0.0001 and
in practice, the value could be adjusted but it should be much smaller
than the smallest p-value observed.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fl">0.0001</span></span>
<span></span>
<span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">epsilon</span>, <span class="fl">0</span>, <span class="va">epsilon</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">serial_gatekeeping_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_create.html">graph_create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>, <span class="va">transitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">serial_gatekeeping_graph</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  asp <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">0.0001</span>,</span>
<span>  edge_curves <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pairs"</span> <span class="op">=</span> <span class="fl">7</span>, <span class="st">"H3|H1"</span> <span class="op">=</span> <span class="op">-</span><span class="fl">10</span><span class="op">)</span>,</span>
<span>  vertex.size <span class="op">=</span> <span class="fl">40</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/serial-gatekeeping-1.png" width="432" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/graph_test_shortcut.html">graph_test_shortcut</a></span><span class="op">(</span></span>
<span>    <span class="va">serial_gatekeeping_graph</span>,</span>
<span>    p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;   H1   H2   H3 </span></span>
<span><span class="co">#&gt; TRUE TRUE TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="parallel-gatekeeping-procedure">Parallel gatekeeping procedure<a class="anchor" aria-label="anchor" href="#parallel-gatekeeping-procedure"></a>
</h3>
<p>Parallel gatekeeping procedures also involve multiple ordered
families of hypotheses, where any null hypotheses of a family of
hypotheses must be rejected before proceeding in the test sequence <span class="citation">(Dmitrienko, Offen, and Westfall 2003)</span>. The
example below considers a primary family consisting of two hypotheses
<span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> and a secondary family consisting of
two hypotheses <span class="math inline">\(H_3\)</span> and <span class="math inline">\(H_4\)</span>. In the primary family, the
Bonferroni test is applied. If any of <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> is rejected, <span class="math inline">\(H_3\)</span> and <span class="math inline">\(H_4\)</span> can be tested at level <span class="math inline">\(\alpha/2\)</span> using the Holm procedure; if
both <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> are rejected, <span class="math inline">\(H_3\)</span> and <span class="math inline">\(H_4\)</span> can be tested at level <span class="math inline">\(\alpha\)</span> using the Holm procedure;
otherwise <span class="math inline">\(H_3\)</span> and <span class="math inline">\(H_4\)</span> cannot be rejected.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span></span>
<span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">parallel_gatekeeping_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_create.html">graph_create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="va">transitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">parallel_gatekeeping_graph</span>, vertex.size <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/parallel-gatekeeping-1.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/graph_test_shortcut.html">graph_test_shortcut</a></span><span class="op">(</span></span>
<span>    <span class="va">parallel_gatekeeping_graph</span>,</span>
<span>    p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;    H1    H2    H3    H4 </span></span>
<span><span class="co">#&gt;  TRUE FALSE FALSE FALSE</span></span></code></pre></div>
<p>The above parallel gatekeeping procedure can be improved by adding
<span class="math inline">\(\varepsilon\)</span> edges from secondary
hypotheses to primary hypotheses, because it is possible that both
secondary hypotheses are rejected but there is still a remaining primary
hypothesis not rejected <span class="citation">(Bretz et al.
2009)</span>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">epsilon</span> <span class="op">&lt;-</span> <span class="fl">0.0001</span></span>
<span></span>
<span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">epsilon</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">epsilon</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">epsilon</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">epsilon</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">parallel_gatekeeping_improved_graph</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/graph_create.html">graph_create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="va">transitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">parallel_gatekeeping_improved_graph</span>, eps <span class="op">=</span> <span class="fl">0.0001</span>, vertex.size <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/parallel-gatekeeping-improved-1.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/graph_test_shortcut.html">graph_test_shortcut</a></span><span class="op">(</span></span>
<span>    <span class="va">parallel_gatekeeping_improved_graph</span>,</span>
<span>    p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;    H1    H2    H3    H4 </span></span>
<span><span class="co">#&gt;  TRUE FALSE FALSE FALSE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="successive-procedure">Successive procedure<a class="anchor" aria-label="anchor" href="#successive-procedure"></a>
</h3>
<p>Successive procedures incorporate successive relationships between
hypotheses. For example, the secondary hypothesis is not tested until
the primary hypothesis has been rejected. This is similar to using the
fixed sequence procedure as a component of a graph. The example below
considers two primary hypotheses <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> and two secondary hypotheses <span class="math inline">\(H_3\)</span> and <span class="math inline">\(H_4\)</span>. Primary hypotheses <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> receive the equal hypothesis weight
of 0.5; secondary hypotheses <span class="math inline">\(H_3\)</span>
and <span class="math inline">\(H_4\)</span> receive the hypothesis
weight of 0. A secondary hypothesis <span class="math inline">\(H_3
(H_4)\)</span> can be tested only if the corresponding primary
hypothesis <span class="math inline">\(H_1 (H_2)\)</span> has been
rejected. This represents the successive relationships between <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_3\)</span>, and <span class="math inline">\(H_2\)</span> and <span class="math inline">\(H_4\)</span>, respectively <span class="citation">(Maurer, Glimm, and Bretz 2011)</span>. If both <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_3\)</span> are rejected, their hypothesis
weights are propagated to <span class="math inline">\(H_2\)</span> and
<span class="math inline">\(H_4\)</span>, and vice versa.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span><span class="va">simple_successive_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_graphs.html">simple_successive_1</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co"># transitions &lt;- rbind(</span></span>
<span><span class="co">#   c(0, 0, 1, 0),</span></span>
<span><span class="co">#   c(0, 0, 0, 1),</span></span>
<span><span class="co">#   c(0, 1, 0, 0),</span></span>
<span><span class="co">#   c(1, 0, 0, 0)</span></span>
<span><span class="co"># )</span></span>
<span><span class="co"># simple_successive_graph &lt;- graph_create(c(0.5, 0.5, 0, 0), transitions)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">simple_successive_graph</span>, layout <span class="op">=</span> <span class="st">"grid"</span>, nrow <span class="op">=</span> <span class="fl">2</span>, vertex.size <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/simple-successive-1-1.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/graph_test_shortcut.html">graph_test_shortcut</a></span><span class="op">(</span></span>
<span>    <span class="va">simple_successive_graph</span>,</span>
<span>    p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;    H1    H2    H3    H4 </span></span>
<span><span class="co">#&gt;  TRUE FALSE FALSE FALSE</span></span></code></pre></div>
<p>The above graph could be generalized to allow propagation between
primary hypotheses <span class="citation">(Maurer, Glimm, and Bretz
2011)</span>. A general successive graph is illustrate below with a
variable to determine the propagation between <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">4</span></span>
<span></span>
<span><span class="va">successive_var</span> <span class="op">&lt;-</span> <span class="va">simple_successive_var</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gamma</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="../reference/graph_create.html">graph_create</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">gamma</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">gamma</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gamma</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">gamma</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">successive_var_graph</span> <span class="op">&lt;-</span> <span class="fu">successive_var</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">successive_var_graph</span>, layout <span class="op">=</span> <span class="st">"grid"</span>, nrow <span class="op">=</span> <span class="fl">2</span>, vertex.size <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/simple-successive-var-1.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/graph_test_shortcut.html">graph_test_shortcut</a></span><span class="op">(</span></span>
<span>    <span class="va">successive_var_graph</span>,</span>
<span>    p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;    H1    H2    H3    H4 </span></span>
<span><span class="co">#&gt;  TRUE  TRUE FALSE FALSE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="simes-based-procedures">Simes-based procedures<a class="anchor" aria-label="anchor" href="#simes-based-procedures"></a>
</h2>
<div class="section level3">
<h3 id="hommel-procedure">Hommel procedure<a class="anchor" aria-label="anchor" href="#hommel-procedure"></a>
</h3>
<p>Hommel procedure <span class="citation">(Hommel 1988)</span> is a
closed test procedure which uses Simes tests for every intersection
hypothesis. According to <span class="citation">Xi and Bretz
(2019)</span>, the graph for Hommel procedures is the same as the graph
for Holm procedures. Thus to perform Hommel procedure, we just need to
specify <code>test_type</code> to be <code>simes</code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">hommel_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_graphs.html">bonferroni_holm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">m</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">hommel_graph</span>,</span>
<span>  layout <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/layout_in_circle.html" class="external-link">layout_in_circle</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/as_graph.html">as_igraph</a></span><span class="op">(</span><span class="va">hommel_graph</span><span class="op">)</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  vertex.size <span class="op">=</span> <span class="fl">70</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/hommel-1.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_test_closure.html">graph_test_closure</a></span><span class="op">(</span></span>
<span>  <span class="va">hommel_graph</span>,</span>
<span>  p <span class="op">=</span> <span class="va">p_values</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>  test_types <span class="op">=</span> <span class="st">"simes"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;   H1   H2   H3 </span></span>
<span><span class="co">#&gt; TRUE TRUE TRUE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="parametric-procedures">Parametric procedures<a class="anchor" aria-label="anchor" href="#parametric-procedures"></a>
</h2>
<div class="section level3">
<h3 id="dunnett-procedure">Dunnett procedure<a class="anchor" aria-label="anchor" href="#dunnett-procedure"></a>
</h3>
<p>Step-down Dunnett procedures are a closed test procedure and an
improvement from Holm procedures by incorporating the correlation
structure between test statistics <span class="citation">(Dunnett and
Tamhane 1991)</span>. Thus they are the same graph as Holm procedures.
Assume an equi-correlated case, where the correlation between any pair
of test statistics is the same, e.g., 0.5. Then we can perform the
step-down Dunnett procedure by specifying <code>test_type</code> to be
<code>parametric</code> and providing the correlation matrix.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">dunnett_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example_graphs.html">bonferroni_holm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">m</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">dunnett_graph</span>,</span>
<span>  layout <span class="op">=</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/layout_in_circle.html" class="external-link">layout_in_circle</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/as_graph.html">as_igraph</a></span><span class="op">(</span><span class="va">dunnett_graph</span><span class="op">)</span>,</span>
<span>    order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  vertex.size <span class="op">=</span> <span class="fl">70</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="graph-examples_files/figure-html/dunnett-1.png" width="288" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span><span class="va">corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="va">m</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">corr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_test_closure.html">graph_test_closure</a></span><span class="op">(</span></span>
<span>  <span class="va">dunnett_graph</span>,</span>
<span>  p <span class="op">=</span> <span class="va">p_values</span>, alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>  test_types <span class="op">=</span> <span class="st">"parametric"</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">corr</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">rejected</span></span>
<span><span class="co">#&gt;    H1    H2    H3 </span></span>
<span><span class="co">#&gt;  TRUE FALSE FALSE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-bretz-2009-graphical" class="csl-entry">
Bretz, Frank, Willi Maurer, Werner Branath, and Martin Posch. 2009.
<span>“A Graphical Approach to Sequentially Rejective Multiple Test
Procedures.”</span> <em>Statistics in Medicine</em> 53 (4): 586–604. <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.3495" class="external-link">https://onlinelibrary.wiley.com/doi/abs/10.1002/sim.3495</a>.
</div>
<div id="ref-dmitrienko-2003-gatekeeping" class="csl-entry">
Dmitrienko, Alexei, Walter W. Offen, and Peter H. Westfall. 2003.
<span>“Gatekeeping Strategies for Clinical Trials That Do Not Require
All Primary Effects to Be Significant.”</span> <em>Statistics in
Medicine</em> 22 (15): 2387–2400. <a href="https://onlinelibrary.wiley.com/doi/pdf/10.1002/sim.1526" class="external-link">https://onlinelibrary.wiley.com/doi/pdf/10.1002/sim.1526</a>.
</div>
<div id="ref-dunnett-1991-stepdown" class="csl-entry">
Dunnett, Charles W., and Ajit C. Tamhane. 1991. <span>“Step-down
Multiple Tests for Comparing Treatments with a Control in Unbalanced
One-Way Layouts.”</span> <em>Statistics in Medicine</em> 10 (6): 939–47.
<a href="https://onlinelibrary.wiley.com/doi/10.1002/sim.4780100614" class="external-link">https://onlinelibrary.wiley.com/doi/10.1002/sim.4780100614</a>.
</div>
<div id="ref-holm-1979-simple" class="csl-entry">
Holm, Sture. 1979. <span>“A Simple Sequentially Rejective Multiple Test
Procedure.”</span> <em>Scandinavian Journal of Statistics</em> 75:
65–70. <a href="http://www.jstor.org/stable/4615733" class="external-link">http://www.jstor.org/stable/4615733</a>.
</div>
<div id="ref-hommel-1988-stagewise" class="csl-entry">
Hommel, Gerhard. 1988. <span>“A Stagewise Rejective Multiple Test
Procedure Based on a Modified Bonferroni Test.”</span>
<em>Biometrika</em> 75 (2): 383–86. <a href="https://doi.org/10.1093/biomet/75.2.383" class="external-link">https://doi.org/10.1093/biomet/75.2.383</a>.
</div>
<div id="ref-maurer-2011-multiple" class="csl-entry">
Maurer, Willi, Ekkehard Glimm, and Frank Bretz. 2011. <span>“Multiple
and Repeated Testing of Primary, Coprimary, and Secondary
Hypotheses.”</span> <em>Statistics in Biopharmaceutical Research</em> 3
(2): 336–52. <a href="https://www.tandfonline.com/doi/abs/10.1198/sbr.2010.10010" class="external-link">https://www.tandfonline.com/doi/abs/10.1198/sbr.2010.10010</a>.
</div>
<div id="ref-maurer-1995-multiple" class="csl-entry">
Maurer, Willi, Ludwig Hothorn, and Walter Lehmacher. 1995.
<span>“Multiple Comparisons in Drug Clinical Trials and Preclinical
Assays: A-Priori Ordered Hypotheses.”</span> <em>Biometrie in Der
Chemisch-Pharmazeutischen Industrie</em> 6: 3–18.
</div>
<div id="ref-wiens-2003-fixed" class="csl-entry">
Wiens, Brian L. 2003. <span>“A Fixed Sequence Bonferroni Procedure for
Testing Multiple Endpoints.”</span> <em>Pharmaceutical Statistics</em> 2
(3): 211–15. <a href="https://onlinelibrary.wiley.com/doi/10.1002/pst.64" class="external-link">https://onlinelibrary.wiley.com/doi/10.1002/pst.64</a>.
</div>
<div id="ref-wiens-2005-fallback" class="csl-entry">
Wiens, Brian L., and Alexei Dmitrienko. 2005. <span>“The Fallback
Procedure for Evaluating a Aingle Family of Hypotheses.”</span>
<em>Journal of Biopharmaceutical Statistics</em> 15 (6): 929–42. <a href="https://www.tandfonline.com/doi/full/10.1080/10543400500265660" class="external-link">https://www.tandfonline.com/doi/full/10.1080/10543400500265660</a>.
</div>
<div id="ref-xi-2019-symmetric" class="csl-entry">
Xi, Dong, and Frank Bretz. 2019. <span>“Symmetric Graphs for Equally
Weighted Tests, with Application to the Hochberg Procedure.”</span>
<em>Statistics in Medicine</em> 38 (27): 5268–82. <a href="https://onlinelibrary.wiley.com/doi/10.1002/sim.8375" class="external-link">https://onlinelibrary.wiley.com/doi/10.1002/sim.8375</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dong Xi, Ethan Brockmann, Gilead Sciences, Inc..</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
