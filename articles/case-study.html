<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="graphicalMCP">
<title>case-study • graphicalMCP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="case-study">
<meta property="og:description" content="graphicalMCP">
<meta property="og:image" content="https://urban-sniffle-p11zlpj.pages.github.io/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/case-study.html">case-study</a>
    <a class="dropdown-item" href="../articles/test_power_considerations_2011.html">test_power_considerations_2011</a>
    <a class="dropdown-item" href="../articles/testing-power-basics.html">Testing basics</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>case-study</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/graphicalMCP/blob/HEAD/vignettes/case-study.Rmd" class="external-link"><code>vignettes/case-study.Rmd</code></a></small>
      <div class="d-none name"><code>case-study.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://urban-sniffle-p11zlpj.pages.github.io/">graphicalMCP</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="initial-graph">Initial graph<a class="anchor" aria-label="anchor" href="#initial-graph"></a>
</h2>
<p>This vignette serves to demonstrate testing and power calculations
for a moderately complex graph example. We’ll follow a hypothetical
study for a new diabetes treatment at two dose levels. Each dose level
is tested at three endpoints - Mean change in A1C level against placebo
as the primary endpoint, and mean time-in-range and retinopathy
progression against placebo as the secondary endpoints. Study sample
size is 600, with participants spread equally across each dose level and
placebo.</p>
<p>The initial weight should be split between the primary hypotheses,
and each secondary hypothesis should only be tested if the corresponding
primary hypothesis can be rejected. Weight from one dose group should
certainly be passed to the other dose group if all of one dose is
rejected. But scenarios will be explored where some weight is passed
directly between primary hypotheses as well.</p>
<p>These requirements result in the graph below. The value
<code>gamma</code> can be set to control how much weight is passed
between primary hypotheses vs how much is passed to the secondary
groups.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">complex_gamma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">gamma</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">eps</span> <span class="op">&lt;-</span> <span class="fl">.0001</span></span>
<span></span>
<span>  <span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">gamma</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>, <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">gamma</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>, <span class="va">gamma</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">eps</span>, <span class="fl">0</span>, <span class="va">eps</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">gamma</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">gamma</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>, <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">gamma</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">eps</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">eps</span>, <span class="fl">0</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="../reference/create_graph.html">create_graph</a></span><span class="op">(</span><span class="va">hypotheses</span>, <span class="va">transitions</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">g_complex</span> <span class="op">&lt;-</span> <span class="fu">complex_gamma</span><span class="op">(</span><span class="fl">.5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g_complex</span><span class="op">)</span></span>
<span><span class="co">#&gt; An initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; H1: 0.5000</span></span>
<span><span class="co">#&gt; H2: 0.0000</span></span>
<span><span class="co">#&gt; H3: 0.0000</span></span>
<span><span class="co">#&gt; H4: 0.5000</span></span>
<span><span class="co">#&gt; H5: 0.0000</span></span>
<span><span class="co">#&gt; H6: 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;        H1     H2     H3     H4     H5     H6</span></span>
<span><span class="co">#&gt; H1 0.0000 0.2500 0.2500 0.5000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; H2 0.0000 0.0000 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; H3 0.0000 0.9999 0.0000 0.0001 0.0000 0.0000</span></span>
<span><span class="co">#&gt; H4 0.5000 0.0000 0.0000 0.0000 0.2500 0.2500</span></span>
<span><span class="co">#&gt; H5 0.0000 0.0000 0.0000 0.0000 0.0000 1.0000</span></span>
<span><span class="co">#&gt; H6 0.0001 0.0000 0.0000 0.0000 0.9999 0.0000</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="test-design">Test design<a class="anchor" aria-label="anchor" href="#test-design"></a>
</h2>
<p>In this section we’ll lay out some possible testing strategies. These
testing strategies cannot be run until p-values are calculated from
study data. See <a href="#test-execution">Test Execution</a> below</p>
<div class="section level3">
<h3 id="test-design-bonferroni">Bonferroni<a class="anchor" aria-label="anchor" href="#test-design-bonferroni"></a>
</h3>
<p>The study results could be tested most simply with a Bonferroni
testing method.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">test_graph</a></span><span class="op">(</span><span class="va">g_complex</span>, <span class="va">calculated_p_values</span>, alpha <span class="op">=</span> <span class="fl">.025</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="test-design-parametric-bonferroni">Parametric-Bonferroni<a class="anchor" aria-label="anchor" href="#test-design-parametric-bonferroni"></a>
</h3>
<p>But we can take advantage of the correlation between doses by testing
the primary hypotheses together in a parametric group. Correlation
between doses at the same endpoint reduces to 0.5 with equal
randomization. For parametric testing, the only correlations that need
to be specified are between hypotheses in a parametric group</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rho_com_endpoint</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span></span>
<span><span class="va">t_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="va">rho_com_endpoint</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="va">rho_com_endpoint</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="va">rho_com_endpoint</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">rho_com_endpoint</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">rho_com_endpoint</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="va">rho_com_endpoint</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">test_graph</a></span><span class="op">(</span></span>
<span>  <span class="va">g_complex</span>,</span>
<span>  <span class="va">calculated_p_values</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"b"</span><span class="op">)</span>,</span>
<span>  corr <span class="op">=</span> <span class="va">t_corr</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="test-design-parametric-simes">Parametric-Simes<a class="anchor" aria-label="anchor" href="#test-design-parametric-simes"></a>
</h3>
<p>Even beyond that, it may make sense to test each pair of secondary
hypotheses as a Simes group. This may add a small amount of power,
depending on what gamma value is chosen.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">test_graph</a></span><span class="op">(</span></span>
<span>  <span class="va">g_complex</span>,</span>
<span>  <span class="va">calculated_p_values</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"s"</span>, <span class="st">"s"</span><span class="op">)</span>,</span>
<span>  corr <span class="op">=</span> <span class="va">t_corr</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>These test designs are explored further in <a href="#test-execution">Test execution</a> below.</p>
</div>
</div>
<div class="section level2">
<h2 id="power-calculations">Power calculations<a class="anchor" aria-label="anchor" href="#power-calculations"></a>
</h2>
<p>It’s not always obvious from an initial graph how easy or difficult
it will be to reject each hypothesis. One way to understand this better
is to run a power simulation. The essence of a power simulation is to
generate many different p-values using an assumed distribution, then
test the graph against each set of p-values to see how it performs. In
most cases, power will be calculated under many different scenarios to
better understand the testing space.</p>
<p>The p-values for a power simulation are sampled from a multivariate
normal distribution using a one-sided test. The means of the MVN should
be set as the marginal power of each hypothesis, and the correlations
should be the correlation between hypotheses that are either known from
the study design or assumed.</p>
<p>[Talk about how marginal power is calculated, and where the
correlation comes from. Is it different from
<code>test_corr</code>?]</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_power.html">calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">g_complex</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">5</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span>, <span class="st">"s"</span>, <span class="st">"s"</span><span class="op">)</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="va">t_corr</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="va">marginal_power</span>, <span class="co"># this needs to be calculated</span></span>
<span>  sim_success <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  sim_seed <span class="op">=</span> <span class="fl">6723</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="study-data">Study data<a class="anchor" aria-label="anchor" href="#study-data"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">.025</span></span>
<span></span>
<span><span class="va">cohort_size</span> <span class="op">&lt;-</span> <span class="fl">200</span></span>
<span></span>
<span><span class="va">means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.7</span>, <span class="fl">.1</span>, <span class="fl">0</span>, <span class="fl">.6</span>, <span class="fl">.25</span>, <span class="fl">.7</span><span class="op">)</span></span>
<span><span class="va">sds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">.1</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># simulate performance of each endpoint against placebo</span></span>
<span><span class="va">study_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span><span class="va">rnorm</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">cohort_size</span>, <span class="fl">6</span><span class="op">)</span>, <span class="va">means</span>, <span class="va">sds</span><span class="op">)</span></span>
<span></span>
<span><span class="va">t_tests</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">study_results</span>, <span class="fl">2</span>, <span class="va">t.test</span>, alternative <span class="op">=</span> <span class="st">"greater"</span><span class="op">)</span></span>
<span><span class="va">t_test_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">t_tests</span>, <span class="va">getElement</span>, <span class="st">"estimate"</span><span class="op">)</span></span>
<span><span class="va">t_test_pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span><span class="va">t_tests</span>, <span class="va">getElement</span>, <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="st">"p.value"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">marginal_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">vapply</a></span><span class="op">(</span></span>
<span>  <span class="va">t_test_means</span>,</span>
<span>  <span class="kw">function</span><span class="op">(</span><span class="va">sample_mean</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">sample_mean</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="test-execution">Test execution<a class="anchor" aria-label="anchor" href="#test-execution"></a>
</h2>
<p>The study results could be tested most simply with a Bonferroni
testing method.</p>
<p>But we can take advantage of the correlation between doses by testing
the primary hypotheses together in a parametric group. Correlation
between doses at the same endpoint reduces to 0.5 with equal
randomization. We can demonstrate more functionality for the package by
combining each dose’s secondary endpoints together in a Simes group.</p>
<p><del>Correlation between endpoints within a dose group is unknown;
we’ll assume 0.4. Correlations between one endpoint in one dose group
and another endpoint in another dose group can be calculated with the
product rule. This results in the correlation matrix below. Testing and
power will be calculated at the global level 0.025.</del></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dong Xi, Ethan Brockmann, Gilead Biostatistics.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
