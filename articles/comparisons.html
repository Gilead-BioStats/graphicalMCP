<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="graphicalMCP">
<title>Comparisons with other packages • graphicalMCP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comparisons with other packages">
<meta property="og:description" content="graphicalMCP">
<meta property="og:image" content="https://urban-sniffle-p11zlpj.pages.github.io/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/graphicalMCP.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/glossary.html">Glossary</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/shortcut-testing.html">Sequentially rejective graphical multiple comparison procedures based on Bonferroni tests</a>
    <a class="dropdown-item" href="../articles/closed-testing.html">Graphical multiple comparison procedures based on the closure principle</a>
    <a class="dropdown-item" href="../articles/graph-examples.html">Common multiple comparison procedures illustrated using graphicalMCP</a>
    <a class="dropdown-item" href="../articles/comparisons.html">Comparisons with other packages</a>
    <a class="dropdown-item" href="../articles/generate-closure.html">Rationales to generate the closure and the weighting strategy of a graph</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Comparisons with other packages</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/graphicalMCP/blob/HEAD/vignettes/comparisons.Rmd" class="external-link"><code>vignettes/comparisons.Rmd</code></a></small>
      <div class="d-none name"><code>comparisons.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://urban-sniffle-p11zlpj.pages.github.io/">graphicalMCP</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">lrstat</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kornl/gMCP" class="external-link">gMCP</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>There are two R packages that cover graphical multiple comparison
procedures (MCPs): <code>gMCP</code> <span class="citation">(Rohmeyer
and Klinglmueller 2020)</span> and <code>lrstat</code> <span class="citation">(Lu 2023)</span>. The development of
<code>graphicalMCP</code> benefited from these two packages. Here we
provide some comparisons between <code>graphicalMCP</code> and other
packages with respect to key functions.</p>
</div>
<div class="section level2">
<h2 id="list-of-comparisons">List of comparisons<a class="anchor" aria-label="anchor" href="#list-of-comparisons"></a>
</h2>
<ul>
<li>Weighting strategy for the closure
<ul>
<li><code><a href="../reference/graph_generate_weights.html">graphicalMCP::graph_generate_weights()</a></code></li>
<li><code><a href="https://rdrr.io/pkg/gMCP/man/generateWeights.html" class="external-link">gMCP::generateWeights()</a></code></li>
</ul>
</li>
<li>Sequentially rejective procedures based on Bonferroni tests
<ul>
<li><code><a href="../reference/testing.html">graphicalMCP::graph_test_shortcut()</a></code></li>
<li><code><a href="https://rdrr.io/pkg/gMCP/man/gMCP.html" class="external-link">gMCP::gMCP()</a></code></li>
</ul>
</li>
<li>Power simulation for sequentially rejective procedures
<ul>
<li><code><a href="../reference/graph_calculate_power.html">graphicalMCP::graph_calculate_power()</a></code></li>
<li><code><a href="https://rdrr.io/pkg/gMCP/man/calcPower.html" class="external-link">gMCP::calcPower()</a></code></li>
</ul>
</li>
<li>Closed procedures with parametric tests
<ul>
<li><code><a href="../reference/testing.html">graphicalMCP::graph_test_closure()</a></code></li>
<li><code><a href="https://rdrr.io/pkg/gMCP/man/gMCP.html" class="external-link">gMCP::gMCP()</a></code></li>
</ul>
</li>
<li>Power simulation for closed procedures with parametric tests
<ul>
<li><code><a href="../reference/graph_calculate_power.html">graphicalMCP::graph_calculate_power()</a></code></li>
<li><code><a href="https://rdrr.io/pkg/gMCP/man/calcPower.html" class="external-link">gMCP::calcPower()</a></code></li>
</ul>
</li>
<li>Closed procedures with Simes tests
<ul>
<li><code><a href="../reference/testing.html">graphicalMCP::graph_test_closure()</a></code></li>
<li><code><a href="https://rdrr.io/pkg/gMCP/man/gMCP.html" class="external-link">gMCP::gMCP()</a></code></li>
</ul>
</li>
<li>Power simulation for closed procedures with Simes tests
<ul>
<li><code><a href="../reference/graph_calculate_power.html">graphicalMCP::graph_calculate_power()</a></code></li>
<li><code><a href="https://rdrr.io/pkg/gMCP/man/calcPower.html" class="external-link">gMCP::calcPower()</a></code></li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="comparisons-of-weighting-strategies">Comparisons of weighting strategies<a class="anchor" aria-label="anchor" href="#comparisons-of-weighting-strategies"></a>
</h2>
<p>A random graph for five hypotheses will be generated and used for the
comparison. Weighting strategies from the following two functions will
be compared: <code><a href="../reference/graph_generate_weights.html">graphicalMCP::graph_generate_weights()</a></code> and
<code><a href="https://rdrr.io/pkg/gMCP/man/generateWeights.html" class="external-link">gMCP::generateWeights()</a></code>. This process is repeated 1000
times. Weighting strategies are matched for all 1000 cases.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">identical</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example-graphs.html">random_graph</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="va">graphicalmcp_weights</span> <span class="op">&lt;-</span> <span class="fu">graphicalMCP</span><span class="fu">::</span><span class="fu"><a href="../reference/graph_generate_weights.html">graph_generate_weights</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/dimnames.html" class="external-link">dimnames</a></span><span class="op">(</span><span class="va">graphicalmcp_weights</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="cn">NULL</span><span class="op">)</span></span>
<span>  <span class="va">gmcp_weights</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu">gMCP</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gMCP/man/generateWeights.html" class="external-link">generateWeights</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">transitions</span>, <span class="va">graph</span><span class="op">$</span><span class="va">hypotheses</span><span class="op">)</span></span>
<span>  <span class="va">gmcp_weights</span> <span class="op">&lt;-</span> <span class="va">gmcp_weights</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">gmcp_weights</span><span class="op">)</span><span class="op">:</span><span class="fl">1</span>, <span class="op">]</span> <span class="co"># Reorder rows</span></span>
<span>  <span class="va">identical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">identical</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">gmcp_weights</span>, <span class="va">graphicalmcp_weights</span>, tolerance <span class="op">=</span> <span class="fl">1e-7</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">identical</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparisons-of-sequentially-rejective-procedures-based-on-bonferroni-tests">Comparisons of sequentially rejective procedures based on Bonferroni
tests<a class="anchor" aria-label="anchor" href="#comparisons-of-sequentially-rejective-procedures-based-on-bonferroni-tests"></a>
</h2>
<div class="section level3">
<h3 id="adjusted-p-values-for-testing">Adjusted p-values for testing<a class="anchor" aria-label="anchor" href="#adjusted-p-values-for-testing"></a>
</h3>
<p>A random graph for five hypotheses will be generated and used for the
comparison. A set of p-values is randomly generated to be used for the
graphical MCP. Adjusted p-values are calculated and compared using the
following functions: <code><a href="../reference/testing.html">graphicalMCP::graph_test_shortcut()</a></code>
and <code><a href="https://rdrr.io/pkg/gMCP/man/gMCP.html" class="external-link">gMCP::gMCP()</a></code>. This process is repeated 10000 times.
Adjusted p-values are matched for all 10000 cases.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">identical</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example-graphs.html">random_graph</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span>  <span class="va">graphicalmcp_test_shortcut</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="../reference/testing.html">graph_test_shortcut</a></span><span class="op">(</span><span class="va">graph</span>, <span class="va">p</span>, alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">adjusted_p</span></span>
<span>  <span class="va">gmcp_test_shortcut</span> <span class="op">&lt;-</span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gMCP/man/gMCP.html" class="external-link">gMCP</a></span><span class="op">(</span><span class="fu"><a href="../reference/as-graph.html">as_graphMCP</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span>, <span class="va">p</span>, alpha <span class="op">=</span> <span class="va">alpha</span><span class="op">)</span><span class="op">@</span><span class="va">adjPValues</span></span>
<span>  <span class="va">identical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">identical</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">graphicalmcp_test_shortcut</span>, <span class="va">gmcp_test_shortcut</span>, tolerance <span class="op">=</span> <span class="fl">1e-7</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">identical</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="power-simulations">Power simulations<a class="anchor" aria-label="anchor" href="#power-simulations"></a>
</h3>
<p>A random graph for five hypotheses will be generated and used for the
comparison. A set of marginal power (without multiplicity adjustment) is
randomly generated. Local power (with multiplicity adjustment) is
calculated and compared using the following functions:
<code><a href="../reference/graph_calculate_power.html">graphicalMCP::graph_calculate_power()</a></code> and
<code><a href="https://rdrr.io/pkg/gMCP/man/calcPower.html" class="external-link">gMCP::calcPower()</a></code>. Since different simulation methods are
used, results are slightly different. The maximum absolute difference in
local power is 0.0051 (0.51%) among 1000 cases, which is relatively
small.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">sim_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">sim_corr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">graphicalmcp_power</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">gmcp_power</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example-graphs.html">random_graph</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span>  <span class="va">marginal_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span></span>
<span>  <span class="va">noncentrality_parameter</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.025</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">marginal_power</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span> <span class="op">+</span> <span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">graphicalmcp_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">graphicalmcp_power</span>,</span>
<span>    <span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span></span>
<span>      <span class="va">graph</span>,</span>
<span>      alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>      power_marginal <span class="op">=</span> <span class="va">marginal_power</span>,</span>
<span>      sim_corr <span class="op">=</span> <span class="va">sim_corr</span>,</span>
<span>      sim_n <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">17</span></span>
<span>    <span class="op">)</span><span class="op">$</span><span class="va">power</span><span class="op">$</span><span class="va">power_local</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span> <span class="op">+</span> <span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">gmcp_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">gmcp_power</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gMCP/man/calcPower.html" class="external-link">calcPower</a></span><span class="op">(</span></span>
<span>      <span class="va">graph</span><span class="op">$</span><span class="va">hypotheses</span>,</span>
<span>      alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>      <span class="va">graph</span><span class="op">$</span><span class="va">transitions</span>,</span>
<span>      mean <span class="op">=</span> <span class="va">noncentrality_parameter</span>,</span>
<span>      corr.sim <span class="op">=</span> <span class="va">sim_corr</span>,</span>
<span>      n.sim <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">17</span></span>
<span>    <span class="op">)</span><span class="op">$</span><span class="va">LocalPower</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">graphicalmcp_power</span>, <span class="va">gmcp_power</span><span class="op">)</span>,</span>
<span>  procedure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"graphicalMCP"</span>, <span class="st">"gMCP"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">graphicalmcp_power</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span></span>
<span>  <span class="va">diff</span>,</span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/cache/comparisons_power_shortcut.csv"</span><span class="op">)</span>,</span>
<span>  row.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/cache/comparisons_power_shortcut.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">graphicalmcp_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">diff</span>, <span class="va">procedure</span> <span class="op">==</span> <span class="st">"graphicalMCP"</span><span class="op">)</span></span>
<span><span class="va">gmcp_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">diff</span>, <span class="va">procedure</span> <span class="op">==</span> <span class="st">"gMCP"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span></span>
<span>      <span class="va">graphicalmcp_power</span><span class="op">[</span>, <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">graphicalmcp_power</span><span class="op">)</span><span class="op">]</span> <span class="op">-</span> </span>
<span>        <span class="va">gmcp_power</span><span class="op">[</span>, <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gmcp_power</span><span class="op">)</span><span class="op">]</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>  <span class="fl">4</span></span>
<span><span class="op">)</span> <span class="co"># Maximum difference in local power among 1000 cases</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparisons-of-closed-test-procedures-with-parametric-tests">Comparisons of closed test procedures with parametric tests<a class="anchor" aria-label="anchor" href="#comparisons-of-closed-test-procedures-with-parametric-tests"></a>
</h2>
<div class="section level3">
<h3 id="adjusted-p-values-for-testing-1">Adjusted p-values for testing<a class="anchor" aria-label="anchor" href="#adjusted-p-values-for-testing-1"></a>
</h3>
<p>A successive graph with two primary and two secondary hypotheses will
be generated and used for the comparison. A set of p-values is randomly
generated to be used for the graphical MCP. Adjusted p-values are
calculated and compared using the following functions:
<code><a href="../reference/testing.html">graphicalMCP::graph_test_closure()</a></code> and
<code><a href="https://rdrr.io/pkg/gMCP/man/gMCP.html" class="external-link">gMCP::gMCP()</a></code>. Parametric tests are used for two primary
hypotheses. This process is repeated 10000 times. Adjusted p-values are
matched for all 10000 cases.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_create.html">graph_create</a></span><span class="op">(</span><span class="va">hypotheses</span>, <span class="va">transitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">identical</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">test_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span>  <span class="va">graphicalmcp_test_parametric</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/testing.html">graph_test_closure</a></span><span class="op">(</span></span>
<span>    <span class="va">graph</span>, </span>
<span>    <span class="va">p</span>, </span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>    test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>    test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parametric"</span>, <span class="st">"bonferroni"</span><span class="op">)</span>,</span>
<span>    test_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">test_corr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="cn">NA</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">adjusted_p</span></span>
<span>  <span class="va">gmcp_test_parametric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gMCP/man/gMCP.html" class="external-link">gMCP</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="../reference/as-graph.html">as_graphMCP</a></span><span class="op">(</span><span class="va">graph</span><span class="op">)</span>,</span>
<span>    <span class="va">p</span>,</span>
<span>    alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>    correlation <span class="op">=</span> <span class="va">test_corr</span></span>
<span>  <span class="op">)</span><span class="op">@</span><span class="va">adjPValues</span></span>
<span>  <span class="va">identical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">identical</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">graphicalmcp_test_parametric</span>, <span class="va">gmcp_test_parametric</span>, tolerance <span class="op">=</span> <span class="fl">1e-7</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">identical</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="power-simulations-1">Power simulations<a class="anchor" aria-label="anchor" href="#power-simulations-1"></a>
</h3>
<p>A successive graph with two primary and two secondary hypotheses will
be generated and used for the comparison. A set of marginal power
(without multiplicity adjustment) is randomly generated. Local power
(with multiplicity adjustment) is calculated and compared using the
following functions: <code><a href="../reference/graph_calculate_power.html">graphicalMCP::graph_calculate_power()</a></code>
and <code><a href="https://rdrr.io/pkg/gMCP/man/calcPower.html" class="external-link">gMCP::calcPower()</a></code>. Parametric tests are used for two
primary hypotheses. This process is repeated 100 times. Since different
simulation methods are used, results are slightly different. The maximum
absolute difference in local power is 0.0142 (1.42%) among 100 cases,
which is small.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_create.html">graph_create</a></span><span class="op">(</span><span class="va">hypotheses</span>, <span class="va">transitions</span><span class="op">)</span></span>
<span><span class="va">test_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sim_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">sim_corr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">graphicalmcp_power_parametric</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">gmcp_power_parametric</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">marginal_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0.5</span>, <span class="fl">0.9</span><span class="op">)</span></span>
<span>  <span class="va">noncentrality_parameter</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">0.025</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">-</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">marginal_power</span>, lower.tail <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span> <span class="op">+</span> <span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">graphicalmcp_power_parametric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">graphicalmcp_power_parametric</span>,</span>
<span>    <span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span></span>
<span>      <span class="va">graph</span>,</span>
<span>      alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>      test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>      test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parametric"</span>, <span class="st">"bonferroni"</span><span class="op">)</span>,</span>
<span>      test_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">test_corr</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>      power_marginal <span class="op">=</span> <span class="va">marginal_power</span>,</span>
<span>      sim_corr <span class="op">=</span> <span class="va">sim_corr</span>,</span>
<span>      sim_n <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">14</span></span>
<span>    <span class="op">)</span><span class="op">$</span><span class="va">power</span><span class="op">$</span><span class="va">power_local</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span> <span class="op">+</span> <span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="va">gmcp_power_parametric</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>    <span class="va">gmcp_power_parametric</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/gMCP/man/calcPower.html" class="external-link">calcPower</a></span><span class="op">(</span></span>
<span>      <span class="va">graph</span><span class="op">$</span><span class="va">hypotheses</span>,</span>
<span>      alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>      <span class="va">graph</span><span class="op">$</span><span class="va">transitions</span>,</span>
<span>      corr.test <span class="op">=</span> <span class="va">test_corr</span>,</span>
<span>      mean <span class="op">=</span> <span class="va">noncentrality_parameter</span>,</span>
<span>      corr.sim <span class="op">=</span> <span class="va">sim_corr</span>,</span>
<span>      n.sim <span class="op">=</span> <span class="fl">2</span><span class="op">^</span><span class="fl">14</span></span>
<span>    <span class="op">)</span><span class="op">$</span><span class="va">LocalPower</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">graphicalmcp_power_parametric</span>, <span class="va">gmcp_power_parametric</span><span class="op">)</span>,</span>
<span>  procedure <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"graphicalMCP"</span>, <span class="st">"gMCP"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">gmcp_power_parametric</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/write.table.html" class="external-link">write.csv</a></span><span class="op">(</span></span>
<span>  <span class="va">diff</span>,</span>
<span>  <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/cache/comparisons_power_parametric.csv"</span><span class="op">)</span>,</span>
<span>  row.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">diff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"vignettes/cache/comparisons_power_parametric.csv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">graphicalmcp_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">diff</span>, <span class="va">procedure</span> <span class="op">==</span> <span class="st">"graphicalMCP"</span><span class="op">)</span></span>
<span><span class="va">gmcp_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">diff</span>, <span class="va">procedure</span> <span class="op">==</span> <span class="st">"gMCP"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span></span>
<span>      <span class="va">graphicalmcp_power_parametric</span><span class="op">[</span>, <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">graphicalmcp_power_parametric</span><span class="op">)</span><span class="op">]</span> <span class="op">-</span> </span>
<span>        <span class="va">gmcp_power_parametric</span><span class="op">[</span>, <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">gmcp_power</span><span class="op">)</span><span class="op">]</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>, <span class="fl">4</span></span>
<span><span class="op">)</span> <span class="co"># Maximum difference in local power among 100 cases</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="comparisons-of-closed-test-procedures-with-simes-tests">Comparisons of closed test procedures with Simes tests<a class="anchor" aria-label="anchor" href="#comparisons-of-closed-test-procedures-with-simes-tests"></a>
</h2>
<div class="section level3">
<h3 id="adjusted-p-values-for-testing-2">Adjusted p-values for testing<a class="anchor" aria-label="anchor" href="#adjusted-p-values-for-testing-2"></a>
</h3>
<p>A successive graph with two primary and two secondary hypotheses will
be generated and used for the comparison. A set of p-values is randomly
generated to be used for the graphical MCP. Adjusted p-values are
calculated and compared using the following functions:
<code><a href="../reference/testing.html">graphicalMCP::graph_test_closure()</a></code> and
<code><a href="https://rdrr.io/pkg/lrstat/man/fadjpsim.html" class="external-link">lrstat::fadjpsim()</a></code>. Simes tests are used for two primary
hypotheses. This process is repeated 10000 times. Adjusted p-values are
matched for all 10000 cases.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">eps</span> <span class="op">&lt;-</span> <span class="fl">0.0001</span></span>
<span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">eps</span>, <span class="va">eps</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">eps</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="va">eps</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_create.html">graph_create</a></span><span class="op">(</span><span class="va">hypotheses</span>, <span class="va">transitions</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">identical</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">family</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10000</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0</span>, <span class="va">alpha</span><span class="op">)</span></span>
<span>  <span class="va">graphicalmcp_test_simes</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/testing.html">graph_test_closure</a></span><span class="op">(</span></span>
<span>    <span class="va">graph</span>, </span>
<span>    <span class="va">p</span>, </span>
<span>    alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>    test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>    test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"simes"</span>, <span class="st">"bonferroni"</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">$</span><span class="va">outputs</span><span class="op">$</span><span class="va">adjusted_p</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">graphicalmcp_test_simes</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span>  <span class="va">lrstat_test_simes</span> <span class="op">&lt;-</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/lrstat/man/fadjpsim.html" class="external-link">fadjpsim</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/lrstat/man/fwgtmat.html" class="external-link">fwgtmat</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">hypotheses</span>, <span class="va">graph</span><span class="op">$</span><span class="va">transitions</span><span class="op">)</span>,</span>
<span>      <span class="va">p</span>,</span>
<span>      <span class="va">family</span></span>
<span>  <span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">identical</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">identical</span>, </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">graphicalmcp_test_simes</span>, <span class="va">lrstat_test_simes</span>, tolerance <span class="op">=</span> <span class="fl">1e-7</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">identical</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="power-simulations-2">Power simulations<a class="anchor" aria-label="anchor" href="#power-simulations-2"></a>
</h3>
<p>Power simulations are not available in <code>lrstat</code>. Thus a
comparison could be done to compare
<code><a href="../reference/graph_calculate_power.html">graphicalMCP::graph_calculate_power()</a></code> and a manual
repetition of <code><a href="https://rdrr.io/pkg/lrstat/man/fadjpsim.html" class="external-link">lrstat::fadjpsim()</a></code> for many sets of marginal
power. This process is the same as the above comparison of adjusted
p-values, and thus omitted.</p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-lu-2023-lrstat" class="csl-entry">
Lu, Kaifeng. 2023. <span>“<span class="nocase">lrstat</span>: Power and
Sample Size Calculation for Non-Proportional Hazards.”</span> <a href="https://cran.r-project.org/package=lrstat" class="external-link">https://cran.r-project.org/package=lrstat</a>.
</div>
<div id="ref-rohmeyer-2020-gmcp" class="csl-entry">
Rohmeyer, Kornelius, and Florian Klinglmueller. 2020. <span>“<span class="nocase">gMCP</span>: Graph Based Multiple Test
Procedures.”</span> <a href="https://cran.r-project.org/package=gMCP" class="external-link">https://cran.r-project.org/package=gMCP</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dong Xi, Ethan Brockmann, Gilead Biostatistics.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
