<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="graphicalMCP">
<title>Testing basics • graphicalMCP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Testing basics">
<meta property="og:description" content="graphicalMCP">
<meta property="og:image" content="https://urban-sniffle-p11zlpj.pages.github.io/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/case-study.html">case-study</a>
    <a class="dropdown-item" href="../articles/test_power_considerations_2011.html">test_power_considerations_2011</a>
    <a class="dropdown-item" href="../articles/testing-power-basics.html">Testing basics</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Testing basics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/graphicalMCP/blob/HEAD/vignettes/testing-power-basics.Rmd" class="external-link"><code>vignettes/testing-power-basics.Rmd</code></a></small>
      <div class="d-none name"><code>testing-power-basics.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://gsrmtp.r-forge.r-project.org/" class="external-link">gMCP</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://urban-sniffle-p11zlpj.pages.github.io/">graphicalMCP</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'graphicalMCP'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:gMCP':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     fallback</span></span></code></pre></div>
<div class="section level2">
<h2 id="testing-a-graph">Testing a graph<a class="anchor" aria-label="anchor" href="#testing-a-graph"></a>
</h2>
<p>Start testing with the example graph from the README, a simple
successive graph with two primary and two secondary hypotheses.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ss_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/example-graphs.html">simple_successive_2</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"B1"</span>, <span class="st">"A2"</span>, <span class="st">"B2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">pvals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.024</span>, <span class="fl">.01</span>, <span class="fl">.026</span>, <span class="fl">.027</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ss_graph</span></span>
<span><span class="co">#&gt; An initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; A1: 0.5000</span></span>
<span><span class="co">#&gt; B1: 0.5000</span></span>
<span><span class="co">#&gt; A2: 0.0000</span></span>
<span><span class="co">#&gt; B2: 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;        A1     B1     A2     B2</span></span>
<span><span class="co">#&gt; A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt; B1 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt; A2 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; B2 1.0000 0.0000 0.0000 0.0000</span></span></code></pre></div>
<p>This graph can be tested most simply with the default weighted
Bonferroni test. When testing at the global alpha level 0.05, we can
reject hypotheses A1 and B1, but not A2 or B2.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">test_graph</a></span><span class="op">(</span><span class="va">ss_graph</span>, p <span class="op">=</span> <span class="va">pvals</span>, alpha <span class="op">=</span> <span class="fl">.05</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   B1 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   A2 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           A1   B1    A2    B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.024 0.01 0.026 0.027</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1-B1-A2-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test summary ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1        0.032   TRUE</span></span>
<span><span class="co">#&gt;           B1        0.020   TRUE</span></span>
<span><span class="co">#&gt;           A2        0.052  FALSE</span></span>
<span><span class="co">#&gt;           B2        0.052  FALSE</span></span></code></pre></div>
<p>The results of the weighted Simes test are equivalent to weighted
Bonferroni in some situations. The power of the Simes test becomes
apparent when multiple p-values fall below the global alpha level, but
above their local alpha in some intersection(s). In the following case,
B1 &amp; B2 are rejected in the Bonferroni testing procedure for
intersection <code>B1 ∩ B2</code> because the p-value is greater than
<code>α * w</code> for each hypothesis in that case. However, the Simes
test rejects <code>B1 ∩ B2</code> because the weight from B1 is added to
the weight for B2.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">test_graph</a></span><span class="op">(</span><span class="va">ss_graph</span>, p <span class="op">=</span> <span class="va">pvals</span>, alpha <span class="op">=</span> <span class="fl">.05</span>, test_types <span class="op">=</span> <span class="st">"s"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   B1 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   A2 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           A1   B1    A2    B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.024 0.01 0.026 0.027</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   simes: (A1-B1-A2-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test summary ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1        0.027   TRUE</span></span>
<span><span class="co">#&gt;           B1        0.020   TRUE</span></span>
<span><span class="co">#&gt;           A2        0.027   TRUE</span></span>
<span><span class="co">#&gt;           B2        0.027   TRUE</span></span></code></pre></div>
<p>If a correlation matrix for the test statistics is partially or fully
known, a parametric test can be used for any subsets whose correlation
matrix is fully known. Here B1 &amp; B2 get a <code>c</code> value
calculated that boosts their testing threshold slightly higher.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">corr1</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">.5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">corr1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="fu"><a href="../reference/testing.html">test_graph</a></span><span class="op">(</span><span class="va">ss_graph</span>,</span>
<span>  p <span class="op">=</span> <span class="va">pvals</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>  corr <span class="op">=</span> <span class="va">corr1</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   B1 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   A2 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           A1   B1    A2    B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.024 0.01 0.026 0.027</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation matrix:    A1 B1  A2  B2</span></span>
<span><span class="co">#&gt;                       A1  1 NA  NA  NA</span></span>
<span><span class="co">#&gt;                       B1 NA  1  NA  NA</span></span>
<span><span class="co">#&gt;                       A2 NA NA 1.0 0.5</span></span>
<span><span class="co">#&gt;                       B2 NA NA 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1-B1)</span></span>
<span><span class="co">#&gt;   parametric: (A2-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test summary ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1     0.032000   TRUE</span></span>
<span><span class="co">#&gt;           B1     0.020000   TRUE</span></span>
<span><span class="co">#&gt;           A2     0.047118   TRUE</span></span>
<span><span class="co">#&gt;           B2     0.047118   TRUE</span></span></code></pre></div>
<p>There are two different testing methods - one which tests each
hypothesis with the <code>p &lt;= (c *) w * α</code> method, and another
which calculates adjusted p-values. The adjusted p-values method is much
more efficient, so it is the standard method. Additional details about
the adjusted p-values calculation can be seen by setting
<code>verbose = TRUE</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">test_graph</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  p <span class="op">=</span> <span class="va">pvals</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>  corr <span class="op">=</span> <span class="va">corr1</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   B1 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   A2 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           A1   B1    A2    B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.024 0.01 0.026 0.027</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation matrix:    A1 B1  A2  B2</span></span>
<span><span class="co">#&gt;                       A1  1 NA  NA  NA</span></span>
<span><span class="co">#&gt;                       B1 NA  1  NA  NA</span></span>
<span><span class="co">#&gt;                       A2 NA NA 1.0 0.5</span></span>
<span><span class="co">#&gt;                       B2 NA NA 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;        simes: (A1-B1)</span></span>
<span><span class="co">#&gt;   parametric: (A2-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test summary ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1     0.032000   TRUE</span></span>
<span><span class="co">#&gt;           B1     0.020000   TRUE</span></span>
<span><span class="co">#&gt;           A2     0.047118   TRUE</span></span>
<span><span class="co">#&gt;           B2     0.047118   TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test details - Adjusted p ------------------------------------------------------</span></span>
<span><span class="co">#&gt;        A1   B1   A2   B2 padj_grp1 padj_grp2 p_adj_inter res</span></span>
<span><span class="co">#&gt;   1  0.50 0.50 0.00 0.00  0.020000  1.000000    0.020000   1</span></span>
<span><span class="co">#&gt;   2  0.50 0.50 0.00   NA  0.020000  1.000000    0.020000   1</span></span>
<span><span class="co">#&gt;   3  0.50 0.50   NA 0.00  0.020000  1.000000    0.020000   1</span></span>
<span><span class="co">#&gt;   4  0.50 0.50   NA   NA  0.020000  1.000000    0.020000   1</span></span>
<span><span class="co">#&gt;   5  0.75   NA 0.00 0.25  0.032000  0.108000    0.032000   1</span></span>
<span><span class="co">#&gt;   6  1.00   NA 0.00   NA  0.024000  1.000000    0.024000   1</span></span>
<span><span class="co">#&gt;   7  0.75   NA   NA 0.25  0.032000  0.108000    0.032000   1</span></span>
<span><span class="co">#&gt;   8  1.00   NA   NA   NA  0.024000  1.000000    0.024000   1</span></span>
<span><span class="co">#&gt;   9    NA 0.75 0.25 0.00  0.013333  0.104000    0.013333   1</span></span>
<span><span class="co">#&gt;   10   NA 0.75 0.25   NA  0.013333  0.104000    0.013333   1</span></span>
<span><span class="co">#&gt;   11   NA 1.00   NA 0.00  0.010000  1.000000    0.010000   1</span></span>
<span><span class="co">#&gt;   12   NA 1.00   NA   NA  0.010000  1.000000    0.010000   1</span></span>
<span><span class="co">#&gt;   13   NA   NA 0.50 0.50  1.000000  0.047118    0.047118   1</span></span>
<span><span class="co">#&gt;   14   NA   NA 1.00   NA  1.000000  0.026000    0.026000   1</span></span>
<span><span class="co">#&gt;   15   NA   NA   NA 1.00  1.000000  0.027000    0.027000   1</span></span></code></pre></div>
<p>The critical value method tests every hypothesis in the closure.
Setting <code>critical = TRUE</code> displays the values used in each of
these tests. This can provide more detailed information about what
caused a hypothesis to fail than the adjusted p-values. However, it
comes with some cost in computation time.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">test_graph</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  p <span class="op">=</span> <span class="va">pvals</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>  corr <span class="op">=</span> <span class="va">corr1</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  critical <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   B1 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   A2 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           A1   B1    A2    B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.024 0.01 0.026 0.027</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation matrix:    A1 B1  A2  B2</span></span>
<span><span class="co">#&gt;                       A1  1 NA  NA  NA</span></span>
<span><span class="co">#&gt;                       B1 NA  1  NA  NA</span></span>
<span><span class="co">#&gt;                       A2 NA NA 1.0 0.5</span></span>
<span><span class="co">#&gt;                       B2 NA NA 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;        simes: (A1-B1)</span></span>
<span><span class="co">#&gt;   parametric: (A2-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test summary ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1     0.032000   TRUE</span></span>
<span><span class="co">#&gt;           B1     0.020000   TRUE</span></span>
<span><span class="co">#&gt;           A2     0.047118   TRUE</span></span>
<span><span class="co">#&gt;           B2     0.047118   TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test details - Adjusted p ------------------------------------------------------</span></span>
<span><span class="co">#&gt;        A1   B1   A2   B2 padj_grp1 padj_grp2 p_adj_inter res</span></span>
<span><span class="co">#&gt;   1  0.50 0.50 0.00 0.00  0.020000  1.000000    0.020000   1</span></span>
<span><span class="co">#&gt;   2  0.50 0.50 0.00   NA  0.020000  1.000000    0.020000   1</span></span>
<span><span class="co">#&gt;   3  0.50 0.50   NA 0.00  0.020000  1.000000    0.020000   1</span></span>
<span><span class="co">#&gt;   4  0.50 0.50   NA   NA  0.020000  1.000000    0.020000   1</span></span>
<span><span class="co">#&gt;   5  0.75   NA 0.00 0.25  0.032000  0.108000    0.032000   1</span></span>
<span><span class="co">#&gt;   6  1.00   NA 0.00   NA  0.024000  1.000000    0.024000   1</span></span>
<span><span class="co">#&gt;   7  0.75   NA   NA 0.25  0.032000  0.108000    0.032000   1</span></span>
<span><span class="co">#&gt;   8  1.00   NA   NA   NA  0.024000  1.000000    0.024000   1</span></span>
<span><span class="co">#&gt;   9    NA 0.75 0.25 0.00  0.013333  0.104000    0.013333   1</span></span>
<span><span class="co">#&gt;   10   NA 0.75 0.25   NA  0.013333  0.104000    0.013333   1</span></span>
<span><span class="co">#&gt;   11   NA 1.00   NA 0.00  0.010000  1.000000    0.010000   1</span></span>
<span><span class="co">#&gt;   12   NA 1.00   NA   NA  0.010000  1.000000    0.010000   1</span></span>
<span><span class="co">#&gt;   13   NA   NA 0.50 0.50  1.000000  0.047118    0.047118   1</span></span>
<span><span class="co">#&gt;   14   NA   NA 1.00   NA  1.000000  0.026000    0.026000   1</span></span>
<span><span class="co">#&gt;   15   NA   NA   NA 1.00  1.000000  0.027000    0.027000   1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test details - Critical values -------------------------------------------------</span></span>
<span><span class="co">#&gt;    intersection hypothesis       test     p &lt;=        c *    w * alpha   res</span></span>
<span><span class="co">#&gt;               1         A1      simes 0.024 &lt;=            1.00 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               1         B1      simes 0.010 &lt;=            0.50 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               1         A2 parametric 0.026 &lt;=        1 * 0.00 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               1         B2 parametric 0.027 &lt;=        1 * 0.00 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               2         A1      simes 0.024 &lt;=            1.00 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               2         B1      simes 0.010 &lt;=            0.50 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               2         A2 parametric 0.026 &lt;=        1 * 0.00 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               3         A1      simes 0.024 &lt;=            1.00 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               3         B1      simes 0.010 &lt;=            0.50 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               3         B2 parametric 0.027 &lt;=        1 * 0.00 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               4         A1      simes 0.024 &lt;=            1.00 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               4         B1      simes 0.010 &lt;=            0.50 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               5         A1      simes 0.024 &lt;=            0.75 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               5         A2 parametric 0.026 &lt;=        1 * 0.00 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               5         B2 parametric 0.027 &lt;=        1 * 0.25 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               6         A1      simes 0.024 &lt;=            1.00 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               6         A2 parametric 0.026 &lt;=        1 * 0.00 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               7         A1      simes 0.024 &lt;=            0.75 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               7         B2 parametric 0.027 &lt;=        1 * 0.25 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               8         A1      simes 0.024 &lt;=            1.00 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               9         B1      simes 0.010 &lt;=            0.75 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;               9         A2 parametric 0.026 &lt;=        1 * 0.25 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;               9         B2 parametric 0.027 &lt;=        1 * 0.00 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;              10         B1      simes 0.010 &lt;=            0.75 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;              10         A2 parametric 0.026 &lt;=        1 * 0.25 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;              11         B1      simes 0.010 &lt;=            1.00 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;              11         B2 parametric 0.027 &lt;=        1 * 0.00 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;              12         B1      simes 0.010 &lt;=            1.00 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;              13         A2 parametric 0.026 &lt;= 1.106458 * 0.50 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;              13         B2 parametric 0.027 &lt;= 1.106458 * 0.50 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;              14         A2 parametric 0.026 &lt;=        1 * 1.00 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;              15         B2 parametric 0.027 &lt;=        1 * 1.00 *  0.05  TRUE</span></span></code></pre></div>
<p>When using only Bonferroni testing, there is a shortcut in testing
which allows us to not test the full closure of a graph. Use
[bonferroni_sequential()] to call this shortcut method. In this case,
<code>critical = TRUE</code> instead gives information about the order
in which hypotheses are deleted. Note that the <code>res</code> column
of the critical output here tells <strong>what would have happened if
sequential testing reached a given point</strong>. However, sequential
testing stops at the first non-rejected hypothesis. Global rejection
results can be found in the <code>Global test summary</code>
section.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/testing.html">bonferroni_sequential</a></span><span class="op">(</span><span class="va">ss_graph</span>, p <span class="op">=</span> <span class="va">pvals</span>, alpha <span class="op">=</span> <span class="fl">.05</span>, critical <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   B1 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   A2 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           A1   B1    A2    B2</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.024 0.01 0.026 0.027</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1-B1-A2-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test summary ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           A1        0.032   TRUE</span></span>
<span><span class="co">#&gt;           B1        0.020   TRUE</span></span>
<span><span class="co">#&gt;           A2        0.052  FALSE</span></span>
<span><span class="co">#&gt;           B2        0.052  FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test details - Critical values -------------------------------------------------</span></span>
<span><span class="co">#&gt;    step hypothesis       test     p &lt;=    w * alpha   res</span></span>
<span><span class="co">#&gt;       1         B1 bonferroni 0.010 &lt;= 0.50 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;       2         A1 bonferroni 0.024 &lt;= 0.75 *  0.05  TRUE</span></span>
<span><span class="co">#&gt;       3         A2 bonferroni 0.026 &lt;= 0.50 *  0.05 FALSE</span></span>
<span><span class="co">#&gt;       4         B2 bonferroni 0.027 &lt;= 1.00 *  0.05  TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="print-options">Print options<a class="anchor" aria-label="anchor" href="#print-options"></a>
</h2>
<p>The print generic for test results includes a couple of additional
options. Each section within results is indented 2 spaces by default,
but this can be adjusted with <code>indent</code>. Numeric values are
rounded to 6 decimals to control the amount of space used, but this can
be set using the <code>precision</code> argument. This only affects the
printing format, not the underlying values.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">3123</span><span class="op">)</span></span>
<span><span class="co"># Randomly generate a graph</span></span>
<span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">w</span> <span class="op">&lt;-</span> <span class="va">w</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w</span><span class="op">)</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">m</span>, <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">m</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, simplify <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">g</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/new.html" class="external-link">new</a></span><span class="op">(</span><span class="st">"graphMCP"</span>, m <span class="op">=</span> <span class="va">g</span>, weights <span class="op">=</span> <span class="va">w</span><span class="op">)</span></span>
<span><span class="va">graph2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_graph.html">create_graph</a></span><span class="op">(</span><span class="va">w</span>, <span class="va">g</span><span class="op">)</span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">m</span>, <span class="fl">.0001</span>, <span class="fl">.05</span><span class="op">)</span></span>
<span><span class="va">sim_corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mix_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/testing.html">test_graph</a></span><span class="op">(</span></span>
<span>  <span class="va">graph2</span>,</span>
<span>  p <span class="op">=</span> <span class="va">p</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.05</span>,</span>
<span>  corr <span class="op">=</span> <span class="va">sim_corr</span>,</span>
<span>  groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="st">"s"</span>, <span class="st">"p"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  critical <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mix_test</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   H1: 0.1875</span></span>
<span><span class="co">#&gt;   H2: 0.3125</span></span>
<span><span class="co">#&gt;   H3: 0.1250</span></span>
<span><span class="co">#&gt;   H4: 0.1875</span></span>
<span><span class="co">#&gt;   H5: 0.1875</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          H1     H2     H3     H4     H5</span></span>
<span><span class="co">#&gt;   H1 0.0000 0.3000 0.3000 0.1000 0.3000</span></span>
<span><span class="co">#&gt;   H2 0.1667 0.0000 0.2500 0.4167 0.1667</span></span>
<span><span class="co">#&gt;   H3 0.5000 0.1250 0.0000 0.2500 0.1250</span></span>
<span><span class="co">#&gt;   H4 0.3571 0.2143 0.0714 0.0000 0.3571</span></span>
<span><span class="co">#&gt;   H5 0.3846 0.2308 0.1538 0.2308 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                              H1       H2       H3       H4       H5</span></span>
<span><span class="co">#&gt;   Unadjusted p-values: 0.012666 0.028896 0.001586 0.029144 0.039695</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation matrix:    H1 H2 H3 H4 H5</span></span>
<span><span class="co">#&gt;                       H1  1  0  0  0  0</span></span>
<span><span class="co">#&gt;                       H2  0  1  0  0  0</span></span>
<span><span class="co">#&gt;                       H3  0  0  1  0  0</span></span>
<span><span class="co">#&gt;                       H4  0  0  0  1  0</span></span>
<span><span class="co">#&gt;                       H5  0  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (H1)</span></span>
<span><span class="co">#&gt;        simes: (H2-H3)</span></span>
<span><span class="co">#&gt;   parametric: (H4-H5)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test summary ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;           H1     0.050664  FALSE</span></span>
<span><span class="co">#&gt;           H2     0.067610  FALSE</span></span>
<span><span class="co">#&gt;           H3     0.012686   TRUE</span></span>
<span><span class="co">#&gt;           H4     0.067610  FALSE</span></span>
<span><span class="co">#&gt;           H5     0.067610  FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test details - Adjusted p ------------------------------------------------------</span></span>
<span><span class="co">#&gt;            H1       H2       H3       H4       H5 padj_grp1 padj_grp2 padj_grp3</span></span>
<span><span class="co">#&gt;   1  0.187500 0.312500 0.125000 0.187500 0.187500  0.067553  0.012686  0.153169</span></span>
<span><span class="co">#&gt;   2  0.259615 0.355769 0.153846 0.230769       NA  0.048788  0.010307  0.126290</span></span>
<span><span class="co">#&gt;   3  0.254464 0.352679 0.138393       NA 0.254464  0.049776  0.011458  0.155994</span></span>
<span><span class="co">#&gt;   4  0.383982 0.430389 0.185629       NA       NA  0.032986  0.008543  1.000000</span></span>
<span><span class="co">#&gt;   5  0.250000 0.328125       NA 0.218750 0.203125  0.050664  0.088063  0.131359</span></span>
<span><span class="co">#&gt;   6  0.345588 0.379902       NA 0.274510       NA  0.036651  0.076061  0.106167</span></span>
<span><span class="co">#&gt;   7  0.337500 0.377841       NA       NA 0.284659  0.037529  0.076476  0.139447</span></span>
<span><span class="co">#&gt;   8  0.521545 0.478455       NA       NA       NA  0.024286  0.060394  1.000000</span></span>
<span><span class="co">#&gt;   9  0.239583       NA 0.203125 0.317708 0.239583  0.052867  0.007807  0.090582</span></span>
<span><span class="co">#&gt;   10 0.345000       NA 0.255833 0.399167       NA  0.036713  0.006198  0.073012</span></span>
<span><span class="co">#&gt;   11 0.376634       NA 0.246732       NA 0.376634  0.033630  0.006427  0.105394</span></span>
<span><span class="co">#&gt;   12 0.635570       NA 0.364430       NA       NA  0.019929  0.004351  1.000000</span></span>
<span><span class="co">#&gt;   13 0.348790       NA       NA 0.381048 0.270161  0.036314  1.000000  0.075559</span></span>
<span><span class="co">#&gt;   14 0.504782       NA       NA 0.495218       NA  0.025092  1.000000  0.058850</span></span>
<span><span class="co">#&gt;   15 0.549890       NA       NA       NA 0.450110  0.023034  1.000000  0.088189</span></span>
<span><span class="co">#&gt;   16 1.000000       NA       NA       NA       NA  0.012666  1.000000  1.000000</span></span>
<span><span class="co">#&gt;   17       NA 0.368750 0.181250 0.206250 0.243750  1.000000  0.008749  0.139073</span></span>
<span><span class="co">#&gt;   18       NA 0.464130 0.255435 0.280435       NA  1.000000  0.006208  0.103924</span></span>
<span><span class="co">#&gt;   19       NA 0.437500 0.219444       NA 0.343056  1.000000  0.007226  0.115710</span></span>
<span><span class="co">#&gt;   20       NA 0.635566 0.364434       NA       NA  1.000000  0.004351  1.000000</span></span>
<span><span class="co">#&gt;   21       NA 0.427390       NA 0.270221 0.302390  1.000000  0.067610  0.106192</span></span>
<span><span class="co">#&gt;   22       NA 0.591667       NA 0.408333       NA  1.000000  0.048838  0.071373</span></span>
<span><span class="co">#&gt;   23       NA 0.541084       NA       NA 0.458916  1.000000  0.053403  0.086497</span></span>
<span><span class="co">#&gt;   24       NA 1.000000       NA       NA       NA  1.000000  0.028896  1.000000</span></span>
<span><span class="co">#&gt;   25       NA       NA 0.297697 0.374452 0.327851  1.000000  0.005327  0.076772</span></span>
<span><span class="co">#&gt;   26       NA       NA 0.451738 0.548262       NA  1.000000  0.003510  0.053157</span></span>
<span><span class="co">#&gt;   27       NA       NA 0.425958       NA 0.574042  1.000000  0.003723  0.069150</span></span>
<span><span class="co">#&gt;   28       NA       NA 1.000000       NA       NA  1.000000  0.001586  1.000000</span></span>
<span><span class="co">#&gt;   29       NA       NA       NA 0.540409 0.459591  1.000000  1.000000  0.053207</span></span>
<span><span class="co">#&gt;   30       NA       NA       NA 1.000000       NA  1.000000  1.000000  0.029144</span></span>
<span><span class="co">#&gt;   31       NA       NA       NA       NA 1.000000  1.000000  1.000000  0.039695</span></span>
<span><span class="co">#&gt;      p_adj_inter res</span></span>
<span><span class="co">#&gt;   1     0.012686   1</span></span>
<span><span class="co">#&gt;   2     0.010307   1</span></span>
<span><span class="co">#&gt;   3     0.011458   1</span></span>
<span><span class="co">#&gt;   4     0.008543   1</span></span>
<span><span class="co">#&gt;   5     0.050664   0</span></span>
<span><span class="co">#&gt;   6     0.036651   1</span></span>
<span><span class="co">#&gt;   7     0.037529   1</span></span>
<span><span class="co">#&gt;   8     0.024286   1</span></span>
<span><span class="co">#&gt;   9     0.007807   1</span></span>
<span><span class="co">#&gt;   10    0.006198   1</span></span>
<span><span class="co">#&gt;   11    0.006427   1</span></span>
<span><span class="co">#&gt;   12    0.004351   1</span></span>
<span><span class="co">#&gt;   13    0.036314   1</span></span>
<span><span class="co">#&gt;   14    0.025092   1</span></span>
<span><span class="co">#&gt;   15    0.023034   1</span></span>
<span><span class="co">#&gt;   16    0.012666   1</span></span>
<span><span class="co">#&gt;   17    0.008749   1</span></span>
<span><span class="co">#&gt;   18    0.006208   1</span></span>
<span><span class="co">#&gt;   19    0.007226   1</span></span>
<span><span class="co">#&gt;   20    0.004351   1</span></span>
<span><span class="co">#&gt;   21    0.067610   0</span></span>
<span><span class="co">#&gt;   22    0.048838   1</span></span>
<span><span class="co">#&gt;   23    0.053403   0</span></span>
<span><span class="co">#&gt;   24    0.028896   1</span></span>
<span><span class="co">#&gt;   25    0.005327   1</span></span>
<span><span class="co">#&gt;   26    0.003510   1</span></span>
<span><span class="co">#&gt;   27    0.003723   1</span></span>
<span><span class="co">#&gt;   28    0.001586   1</span></span>
<span><span class="co">#&gt;   29    0.053207   0</span></span>
<span><span class="co">#&gt;   30    0.029144   1</span></span>
<span><span class="co">#&gt;   31    0.039695   1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test details - Critical values -------------------------------------------------</span></span>
<span><span class="co">#&gt;    intersection hypothesis       test        p &lt;=        c *        w * alpha</span></span>
<span><span class="co">#&gt;               1         H1 bonferroni 0.012666 &lt;=            0.187500 *  0.05</span></span>
<span><span class="co">#&gt;               1         H2      simes 0.028896 &lt;=            0.437500 *  0.05</span></span>
<span><span class="co">#&gt;               1         H3      simes 0.001586 &lt;=            0.125000 *  0.05</span></span>
<span><span class="co">#&gt;               1         H4 parametric 0.029144 &lt;= 1.004716 * 0.187500 *  0.05</span></span>
<span><span class="co">#&gt;               1         H5 parametric 0.039695 &lt;= 1.004716 * 0.187500 *  0.05</span></span>
<span><span class="co">#&gt;               2         H1 bonferroni 0.012666 &lt;=            0.259615 *  0.05</span></span>
<span><span class="co">#&gt;               2         H2      simes 0.028896 &lt;=            0.509615 *  0.05</span></span>
<span><span class="co">#&gt;               2         H3      simes 0.001586 &lt;=            0.153846 *  0.05</span></span>
<span><span class="co">#&gt;               2         H4 parametric 0.029144 &lt;=        1 * 0.230769 *  0.05</span></span>
<span><span class="co">#&gt;               3         H1 bonferroni 0.012666 &lt;=            0.254464 *  0.05</span></span>
<span><span class="co">#&gt;               3         H2      simes 0.028896 &lt;=            0.491071 *  0.05</span></span>
<span><span class="co">#&gt;               3         H3      simes 0.001586 &lt;=            0.138393 *  0.05</span></span>
<span><span class="co">#&gt;               3         H5 parametric 0.039695 &lt;=        1 * 0.254464 *  0.05</span></span>
<span><span class="co">#&gt;               4         H1 bonferroni 0.012666 &lt;=            0.383982 *  0.05</span></span>
<span><span class="co">#&gt;               4         H2      simes 0.028896 &lt;=            0.616018 *  0.05</span></span>
<span><span class="co">#&gt;               4         H3      simes 0.001586 &lt;=            0.185629 *  0.05</span></span>
<span><span class="co">#&gt;               5         H1 bonferroni 0.012666 &lt;=            0.250000 *  0.05</span></span>
<span><span class="co">#&gt;               5         H2      simes 0.028896 &lt;=            0.328125 *  0.05</span></span>
<span><span class="co">#&gt;               5         H4 parametric 0.029144 &lt;= 1.005318 * 0.218750 *  0.05</span></span>
<span><span class="co">#&gt;               5         H5 parametric 0.039695 &lt;= 1.005318 * 0.203125 *  0.05</span></span>
<span><span class="co">#&gt;               6         H1 bonferroni 0.012666 &lt;=            0.345588 *  0.05</span></span>
<span><span class="co">#&gt;               6         H2      simes 0.028896 &lt;=            0.379902 *  0.05</span></span>
<span><span class="co">#&gt;               6         H4 parametric 0.029144 &lt;=        1 * 0.274510 *  0.05</span></span>
<span><span class="co">#&gt;               7         H1 bonferroni 0.012666 &lt;=            0.337500 *  0.05</span></span>
<span><span class="co">#&gt;               7         H2      simes 0.028896 &lt;=            0.377841 *  0.05</span></span>
<span><span class="co">#&gt;               7         H5 parametric 0.039695 &lt;=        1 * 0.284659 *  0.05</span></span>
<span><span class="co">#&gt;               8         H1 bonferroni 0.012666 &lt;=            0.521545 *  0.05</span></span>
<span><span class="co">#&gt;               8         H2      simes 0.028896 &lt;=            0.478455 *  0.05</span></span>
<span><span class="co">#&gt;               9         H1 bonferroni 0.012666 &lt;=            0.239583 *  0.05</span></span>
<span><span class="co">#&gt;               9         H3      simes 0.001586 &lt;=            0.203125 *  0.05</span></span>
<span><span class="co">#&gt;               9         H4 parametric 0.029144 &lt;= 1.006924 * 0.317708 *  0.05</span></span>
<span><span class="co">#&gt;               9         H5 parametric 0.039695 &lt;= 1.006924 * 0.239583 *  0.05</span></span>
<span><span class="co">#&gt;              10         H1 bonferroni 0.012666 &lt;=            0.345000 *  0.05</span></span>
<span><span class="co">#&gt;              10         H3      simes 0.001586 &lt;=            0.255833 *  0.05</span></span>
<span><span class="co">#&gt;              10         H4 parametric 0.029144 &lt;=        1 * 0.399167 *  0.05</span></span>
<span><span class="co">#&gt;              11         H1 bonferroni 0.012666 &lt;=            0.376634 *  0.05</span></span>
<span><span class="co">#&gt;              11         H3      simes 0.001586 &lt;=            0.246732 *  0.05</span></span>
<span><span class="co">#&gt;              11         H5 parametric 0.039695 &lt;=        1 * 0.376634 *  0.05</span></span>
<span><span class="co">#&gt;              12         H1 bonferroni 0.012666 &lt;=            0.635570 *  0.05</span></span>
<span><span class="co">#&gt;              12         H3      simes 0.001586 &lt;=            0.364430 *  0.05</span></span>
<span><span class="co">#&gt;              13         H1 bonferroni 0.012666 &lt;=            0.348790 *  0.05</span></span>
<span><span class="co">#&gt;              13         H4 parametric 0.029144 &lt;= 1.008032 * 0.381048 *  0.05</span></span>
<span><span class="co">#&gt;              13         H5 parametric 0.039695 &lt;= 1.008032 * 0.270161 *  0.05</span></span>
<span><span class="co">#&gt;              14         H1 bonferroni 0.012666 &lt;=            0.504782 *  0.05</span></span>
<span><span class="co">#&gt;              14         H4 parametric 0.029144 &lt;=        1 * 0.495218 *  0.05</span></span>
<span><span class="co">#&gt;              15         H1 bonferroni 0.012666 &lt;=            0.549890 *  0.05</span></span>
<span><span class="co">#&gt;              15         H5 parametric 0.039695 &lt;=        1 * 0.450110 *  0.05</span></span>
<span><span class="co">#&gt;              16         H1 bonferroni 0.012666 &lt;=            1.000000 *  0.05</span></span>
<span><span class="co">#&gt;              17         H2      simes 0.028896 &lt;=            0.550000 *  0.05</span></span>
<span><span class="co">#&gt;              17         H3      simes 0.001586 &lt;=            0.181250 *  0.05</span></span>
<span><span class="co">#&gt;              17         H4 parametric 0.029144 &lt;= 1.005649 * 0.206250 *  0.05</span></span>
<span><span class="co">#&gt;              17         H5 parametric 0.039695 &lt;= 1.005649 * 0.243750 *  0.05</span></span>
<span><span class="co">#&gt;              18         H2      simes 0.028896 &lt;=            0.719565 *  0.05</span></span>
<span><span class="co">#&gt;              18         H3      simes 0.001586 &lt;=            0.255435 *  0.05</span></span>
<span><span class="co">#&gt;              18         H4 parametric 0.029144 &lt;=        1 * 0.280435 *  0.05</span></span>
<span><span class="co">#&gt;              19         H2      simes 0.028896 &lt;=            0.656944 *  0.05</span></span>
<span><span class="co">#&gt;              19         H3      simes 0.001586 &lt;=            0.219444 *  0.05</span></span>
<span><span class="co">#&gt;              19         H5 parametric 0.039695 &lt;=        1 * 0.343056 *  0.05</span></span>
<span><span class="co">#&gt;              20         H2      simes 0.028896 &lt;=            1.000000 *  0.05</span></span>
<span><span class="co">#&gt;              20         H3      simes 0.001586 &lt;=            0.364434 *  0.05</span></span>
<span><span class="co">#&gt;              21         H2      simes 0.028896 &lt;=            0.427390 *  0.05</span></span>
<span><span class="co">#&gt;              21         H4 parametric 0.029144 &lt;= 1.007239 * 0.270221 *  0.05</span></span>
<span><span class="co">#&gt;              21         H5 parametric 0.039695 &lt;= 1.007239 * 0.302390 *  0.05</span></span>
<span><span class="co">#&gt;              22         H2      simes 0.028896 &lt;=            0.591667 *  0.05</span></span>
<span><span class="co">#&gt;              22         H4 parametric 0.029144 &lt;=        1 * 0.408333 *  0.05</span></span>
<span><span class="co">#&gt;              23         H2      simes 0.028896 &lt;=            0.541084 *  0.05</span></span>
<span><span class="co">#&gt;              23         H5 parametric 0.039695 &lt;=        1 * 0.458916 *  0.05</span></span>
<span><span class="co">#&gt;              24         H2      simes 0.028896 &lt;=            1.000000 *  0.05</span></span>
<span><span class="co">#&gt;              25         H3      simes 0.001586 &lt;=            0.297697 *  0.05</span></span>
<span><span class="co">#&gt;              25         H4 parametric 0.029144 &lt;= 1.008896 * 0.374452 *  0.05</span></span>
<span><span class="co">#&gt;              25         H5 parametric 0.039695 &lt;= 1.008896 * 0.327851 *  0.05</span></span>
<span><span class="co">#&gt;              26         H3      simes 0.001586 &lt;=            0.451738 *  0.05</span></span>
<span><span class="co">#&gt;              26         H4 parametric 0.029144 &lt;=        1 * 0.548262 *  0.05</span></span>
<span><span class="co">#&gt;              27         H3      simes 0.001586 &lt;=            0.425958 *  0.05</span></span>
<span><span class="co">#&gt;              27         H5 parametric 0.039695 &lt;=        1 * 0.574042 *  0.05</span></span>
<span><span class="co">#&gt;              28         H3      simes 0.001586 &lt;=            1.000000 *  0.05</span></span>
<span><span class="co">#&gt;              29         H4 parametric 0.029144 &lt;= 1.012737 * 0.540410 *  0.05</span></span>
<span><span class="co">#&gt;              29         H5 parametric 0.039695 &lt;= 1.012737 * 0.459590 *  0.05</span></span>
<span><span class="co">#&gt;              30         H4 parametric 0.029144 &lt;=        1 * 1.000000 *  0.05</span></span>
<span><span class="co">#&gt;              31         H5 parametric 0.039695 &lt;=        1 * 1.000000 *  0.05</span></span>
<span><span class="co">#&gt;      res</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;    FALSE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span><span class="co">#&gt;     TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mix_test</span>, indent <span class="op">=</span> <span class="fl">6</span>, precision <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;       An initial graph</span></span>
<span><span class="co">#&gt;       </span></span>
<span><span class="co">#&gt;       --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;       H1: 0.1875</span></span>
<span><span class="co">#&gt;       H2: 0.3125</span></span>
<span><span class="co">#&gt;       H3: 0.1250</span></span>
<span><span class="co">#&gt;       H4: 0.1875</span></span>
<span><span class="co">#&gt;       H5: 0.1875</span></span>
<span><span class="co">#&gt;       </span></span>
<span><span class="co">#&gt;       --- Transition weights ---</span></span>
<span><span class="co">#&gt;              H1     H2     H3     H4     H5</span></span>
<span><span class="co">#&gt;       H1 0.0000 0.3000 0.3000 0.1000 0.3000</span></span>
<span><span class="co">#&gt;       H2 0.1667 0.0000 0.2500 0.4167 0.1667</span></span>
<span><span class="co">#&gt;       H3 0.5000 0.1250 0.0000 0.2500 0.1250</span></span>
<span><span class="co">#&gt;       H4 0.3571 0.2143 0.0714 0.0000 0.3571</span></span>
<span><span class="co">#&gt;       H5 0.3846 0.2308 0.1538 0.2308 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                                    H1         H2          H3         H4</span></span>
<span><span class="co">#&gt;       Unadjusted p-values: 0.01266611 0.02889569 0.001585753 0.02914382</span></span>
<span><span class="co">#&gt;                                    H5</span></span>
<span><span class="co">#&gt;       Unadjusted p-values: 0.03969491</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Correlation matrix:    H1 H2 H3 H4 H5</span></span>
<span><span class="co">#&gt;                           H1  1  0  0  0  0</span></span>
<span><span class="co">#&gt;                           H2  0  1  0  0  0</span></span>
<span><span class="co">#&gt;                           H3  0  0  1  0  0</span></span>
<span><span class="co">#&gt;                           H4  0  0  0  1  0</span></span>
<span><span class="co">#&gt;                           H5  0  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Test types</span></span>
<span><span class="co">#&gt;       bonferroni: (H1)</span></span>
<span><span class="co">#&gt;            simes: (H2-H3)</span></span>
<span><span class="co">#&gt;       parametric: (H4-H5)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Global test summary ------------------------------------------------------------</span></span>
<span><span class="co">#&gt;       Hypothesis Adj. P-value Reject</span></span>
<span><span class="co">#&gt;               H1   0.05066443  FALSE</span></span>
<span><span class="co">#&gt;               H2   0.06760970  FALSE</span></span>
<span><span class="co">#&gt;               H3   0.01268602   TRUE</span></span>
<span><span class="co">#&gt;               H4   0.06760970  FALSE</span></span>
<span><span class="co">#&gt;               H5   0.06760970  FALSE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test details - Adjusted p ------------------------------------------------------</span></span>
<span><span class="co">#&gt;                 H1        H2        H3        H4        H5  padj_grp1   padj_grp2</span></span>
<span><span class="co">#&gt;       1  0.1875000 0.3125000 0.1250000 0.1875000 0.1875000 0.06755257 0.012686023</span></span>
<span><span class="co">#&gt;       2  0.2596154 0.3557692 0.1538462 0.2307692        NA 0.04878797 0.010307394</span></span>
<span><span class="co">#&gt;       3  0.2544643 0.3526786 0.1383929        NA 0.2544643 0.04977558 0.011458343</span></span>
<span><span class="co">#&gt;       4  0.3839820 0.4303892 0.1856287        NA        NA 0.03298620 0.008542604</span></span>
<span><span class="co">#&gt;       5  0.2500000 0.3281250        NA 0.2187500 0.2031250 0.05066443 0.088063052</span></span>
<span><span class="co">#&gt;       6  0.3455882 0.3799020        NA 0.2745098        NA 0.03665086 0.076060910</span></span>
<span><span class="co">#&gt;       7  0.3375000 0.3778409        NA        NA 0.2846591 0.03752921 0.076475808</span></span>
<span><span class="co">#&gt;       8  0.5215449 0.4784551        NA        NA        NA 0.02428575 0.060393729</span></span>
<span><span class="co">#&gt;       9  0.2395833        NA 0.2031250 0.3177083 0.2395833 0.05286723 0.007806783</span></span>
<span><span class="co">#&gt;       10 0.3450000        NA 0.2558333 0.3991667        NA 0.03671336 0.006198383</span></span>
<span><span class="co">#&gt;       11 0.3766340        NA 0.2467320        NA 0.3766340 0.03362975 0.006427025</span></span>
<span><span class="co">#&gt;       12 0.6355699        NA 0.3644301        NA        NA 0.01992874 0.004351322</span></span>
<span><span class="co">#&gt;       13 0.3487903        NA        NA 0.3810484 0.2701613 0.03631439 1.000000000</span></span>
<span><span class="co">#&gt;       14 0.5047820        NA        NA 0.4952180        NA 0.02509223 1.000000000</span></span>
<span><span class="co">#&gt;       15 0.5498899        NA        NA        NA 0.4501101 0.02303390 1.000000000</span></span>
<span><span class="co">#&gt;       16 1.0000000        NA        NA        NA        NA 0.01266611 1.000000000</span></span>
<span><span class="co">#&gt;       17        NA 0.3687500 0.1812500 0.2062500 0.2437500 1.00000000 0.008748981</span></span>
<span><span class="co">#&gt;       18        NA 0.4641304 0.2554348 0.2804348        NA 1.00000000 0.006208054</span></span>
<span><span class="co">#&gt;       19        NA 0.4375000 0.2194444        NA 0.3430556 1.00000000 0.007226216</span></span>
<span><span class="co">#&gt;       20        NA 0.6355660 0.3644340        NA        NA 1.00000000 0.004351276</span></span>
<span><span class="co">#&gt;       21        NA 0.4273897        NA 0.2702206 0.3023897 1.00000000 0.067609698</span></span>
<span><span class="co">#&gt;       22        NA 0.5916667        NA 0.4083333        NA 1.00000000 0.048837784</span></span>
<span><span class="co">#&gt;       23        NA 0.5410839        NA        NA 0.4589161 1.00000000 0.053403341</span></span>
<span><span class="co">#&gt;       24        NA 1.0000000        NA        NA        NA 1.00000000 0.028895689</span></span>
<span><span class="co">#&gt;       25        NA        NA 0.2976974 0.3744518 0.3278509 1.00000000 0.005326728</span></span>
<span><span class="co">#&gt;       26        NA        NA 0.4517379 0.5482621        NA 1.00000000 0.003510339</span></span>
<span><span class="co">#&gt;       27        NA        NA 0.4259579        NA 0.5740421 1.00000000 0.003722793</span></span>
<span><span class="co">#&gt;       28        NA        NA 1.0000000        NA        NA 1.00000000 0.001585753</span></span>
<span><span class="co">#&gt;       29        NA        NA        NA 0.5404095 0.4595905 1.00000000 1.000000000</span></span>
<span><span class="co">#&gt;       30        NA        NA        NA 1.0000000        NA 1.00000000 1.000000000</span></span>
<span><span class="co">#&gt;       31        NA        NA        NA        NA 1.0000000 1.00000000 1.000000000</span></span>
<span><span class="co">#&gt;           padj_grp3 p_adj_inter res</span></span>
<span><span class="co">#&gt;       1  0.15316875 0.012686023   1</span></span>
<span><span class="co">#&gt;       2  0.12628990 0.010307394   1</span></span>
<span><span class="co">#&gt;       3  0.15599404 0.011458343   1</span></span>
<span><span class="co">#&gt;       4  1.00000000 0.008542604   1</span></span>
<span><span class="co">#&gt;       5  0.13135940 0.050664431   0</span></span>
<span><span class="co">#&gt;       6  0.10616678 0.036650865   1</span></span>
<span><span class="co">#&gt;       7  0.13944720 0.037529208   1</span></span>
<span><span class="co">#&gt;       8  1.00000000 0.024285749   1</span></span>
<span><span class="co">#&gt;       9  0.09058206 0.007806783   1</span></span>
<span><span class="co">#&gt;       10 0.07301166 0.006198383   1</span></span>
<span><span class="co">#&gt;       11 0.10539387 0.006427025   1</span></span>
<span><span class="co">#&gt;       12 1.00000000 0.004351322   1</span></span>
<span><span class="co">#&gt;       13 0.07555853 0.036314390   1</span></span>
<span><span class="co">#&gt;       14 0.05885049 0.025092232   1</span></span>
<span><span class="co">#&gt;       15 0.08818933 0.023033899   1</span></span>
<span><span class="co">#&gt;       16 1.00000000 0.012666108   1</span></span>
<span><span class="co">#&gt;       17 0.13907273 0.008748981   1</span></span>
<span><span class="co">#&gt;       18 0.10392371 0.006208054   1</span></span>
<span><span class="co">#&gt;       19 0.11570987 0.007226216   1</span></span>
<span><span class="co">#&gt;       20 1.00000000 0.004351276   1</span></span>
<span><span class="co">#&gt;       21 0.10619207 0.067609698   0</span></span>
<span><span class="co">#&gt;       22 0.07137263 0.048837784   1</span></span>
<span><span class="co">#&gt;       23 0.08649711 0.053403341   0</span></span>
<span><span class="co">#&gt;       24 1.00000000 0.028895689   1</span></span>
<span><span class="co">#&gt;       25 0.07677176 0.005326728   1</span></span>
<span><span class="co">#&gt;       26 0.05315673 0.003510339   1</span></span>
<span><span class="co">#&gt;       27 0.06914982 0.003722793   1</span></span>
<span><span class="co">#&gt;       28 1.00000000 0.001585753   1</span></span>
<span><span class="co">#&gt;       29 0.05320681 0.053206807   0</span></span>
<span><span class="co">#&gt;       30 0.02914382 0.029143822   1</span></span>
<span><span class="co">#&gt;       31 0.03969491 0.039694913   1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test details - Critical values -------------------------------------------------</span></span>
<span><span class="co">#&gt;        intersection hypothesis       test           p &lt;=            c *         w *</span></span>
<span><span class="co">#&gt;                   1         H1 bonferroni 0.012666108 &lt;=                0.1875000 *</span></span>
<span><span class="co">#&gt;                   1         H2      simes 0.028895689 &lt;=                0.4375000 *</span></span>
<span><span class="co">#&gt;                   1         H3      simes 0.001585753 &lt;=                0.1250000 *</span></span>
<span><span class="co">#&gt;                   1         H4 parametric 0.029143822 &lt;= 1.0047160349 * 0.1875000 *</span></span>
<span><span class="co">#&gt;                   1         H5 parametric 0.039694913 &lt;= 1.0047160349 * 0.1875000 *</span></span>
<span><span class="co">#&gt;                   2         H1 bonferroni 0.012666108 &lt;=                0.2596154 *</span></span>
<span><span class="co">#&gt;                   2         H2      simes 0.028895689 &lt;=                0.5096154 *</span></span>
<span><span class="co">#&gt;                   2         H3      simes 0.001585753 &lt;=                0.1538462 *</span></span>
<span><span class="co">#&gt;                   2         H4 parametric 0.029143822 &lt;=            1 * 0.2307692 *</span></span>
<span><span class="co">#&gt;                   3         H1 bonferroni 0.012666108 &lt;=                0.2544643 *</span></span>
<span><span class="co">#&gt;                   3         H2      simes 0.028895689 &lt;=                0.4910714 *</span></span>
<span><span class="co">#&gt;                   3         H3      simes 0.001585753 &lt;=                0.1383929 *</span></span>
<span><span class="co">#&gt;                   3         H5 parametric 0.039694913 &lt;=            1 * 0.2544643 *</span></span>
<span><span class="co">#&gt;                   4         H1 bonferroni 0.012666108 &lt;=                0.3839820 *</span></span>
<span><span class="co">#&gt;                   4         H2      simes 0.028895689 &lt;=                0.6160180 *</span></span>
<span><span class="co">#&gt;                   4         H3      simes 0.001585753 &lt;=                0.1856287 *</span></span>
<span><span class="co">#&gt;                   5         H1 bonferroni 0.012666108 &lt;=                0.2500000 *</span></span>
<span><span class="co">#&gt;                   5         H2      simes 0.028895689 &lt;=                0.3281250 *</span></span>
<span><span class="co">#&gt;                   5         H4 parametric 0.029143822 &lt;= 1.0053184872 * 0.2187500 *</span></span>
<span><span class="co">#&gt;                   5         H5 parametric 0.039694913 &lt;= 1.0053184872 * 0.2031250 *</span></span>
<span><span class="co">#&gt;                   6         H1 bonferroni 0.012666108 &lt;=                0.3455882 *</span></span>
<span><span class="co">#&gt;                   6         H2      simes 0.028895689 &lt;=                0.3799020 *</span></span>
<span><span class="co">#&gt;                   6         H4 parametric 0.029143822 &lt;=            1 * 0.2745098 *</span></span>
<span><span class="co">#&gt;                   7         H1 bonferroni 0.012666108 &lt;=                0.3375000 *</span></span>
<span><span class="co">#&gt;                   7         H2      simes 0.028895689 &lt;=                0.3778409 *</span></span>
<span><span class="co">#&gt;                   7         H5 parametric 0.039694913 &lt;=            1 * 0.2846591 *</span></span>
<span><span class="co">#&gt;                   8         H1 bonferroni 0.012666108 &lt;=                0.5215449 *</span></span>
<span><span class="co">#&gt;                   8         H2      simes 0.028895689 &lt;=                0.4784551 *</span></span>
<span><span class="co">#&gt;                   9         H1 bonferroni 0.012666108 &lt;=                0.2395833 *</span></span>
<span><span class="co">#&gt;                   9         H3      simes 0.001585753 &lt;=                0.2031250 *</span></span>
<span><span class="co">#&gt;                   9         H4 parametric 0.029143822 &lt;= 1.0069241452 * 0.3177083 *</span></span>
<span><span class="co">#&gt;                   9         H5 parametric 0.039694913 &lt;= 1.0069241452 * 0.2395833 *</span></span>
<span><span class="co">#&gt;                  10         H1 bonferroni 0.012666108 &lt;=                0.3450000 *</span></span>
<span><span class="co">#&gt;                  10         H3      simes 0.001585753 &lt;=                0.2558333 *</span></span>
<span><span class="co">#&gt;                  10         H4 parametric 0.029143822 &lt;=            1 * 0.3991667 *</span></span>
<span><span class="co">#&gt;                  11         H1 bonferroni 0.012666108 &lt;=                0.3766340 *</span></span>
<span><span class="co">#&gt;                  11         H3      simes 0.001585753 &lt;=                0.2467320 *</span></span>
<span><span class="co">#&gt;                  11         H5 parametric 0.039694913 &lt;=            1 * 0.3766340 *</span></span>
<span><span class="co">#&gt;                  12         H1 bonferroni 0.012666108 &lt;=                0.6355699 *</span></span>
<span><span class="co">#&gt;                  12         H3      simes 0.001585753 &lt;=                0.3644301 *</span></span>
<span><span class="co">#&gt;                  13         H1 bonferroni 0.012666108 &lt;=                0.3487903 *</span></span>
<span><span class="co">#&gt;                  13         H4 parametric 0.029143822 &lt;=  1.008031574 * 0.3810484 *</span></span>
<span><span class="co">#&gt;                  13         H5 parametric 0.039694913 &lt;=  1.008031574 * 0.2701613 *</span></span>
<span><span class="co">#&gt;                  14         H1 bonferroni 0.012666108 &lt;=                0.5047820 *</span></span>
<span><span class="co">#&gt;                  14         H4 parametric 0.029143822 &lt;=            1 * 0.4952180 *</span></span>
<span><span class="co">#&gt;                  15         H1 bonferroni 0.012666108 &lt;=                0.5498899 *</span></span>
<span><span class="co">#&gt;                  15         H5 parametric 0.039694913 &lt;=            1 * 0.4501101 *</span></span>
<span><span class="co">#&gt;                  16         H1 bonferroni 0.012666108 &lt;=                1.0000000 *</span></span>
<span><span class="co">#&gt;                  17         H2      simes 0.028895689 &lt;=                0.5500000 *</span></span>
<span><span class="co">#&gt;                  17         H3      simes 0.001585753 &lt;=                0.1812500 *</span></span>
<span><span class="co">#&gt;                  17         H4 parametric 0.029143822 &lt;= 1.0056492282 * 0.2062500 *</span></span>
<span><span class="co">#&gt;                  17         H5 parametric 0.039694913 &lt;= 1.0056492282 * 0.2437500 *</span></span>
<span><span class="co">#&gt;                  18         H2      simes 0.028895689 &lt;=                0.7195652 *</span></span>
<span><span class="co">#&gt;                  18         H3      simes 0.001585753 &lt;=                0.2554348 *</span></span>
<span><span class="co">#&gt;                  18         H4 parametric 0.029143822 &lt;=            1 * 0.2804348 *</span></span>
<span><span class="co">#&gt;                  19         H2      simes 0.028895689 &lt;=                0.6569444 *</span></span>
<span><span class="co">#&gt;                  19         H3      simes 0.001585753 &lt;=                0.2194444 *</span></span>
<span><span class="co">#&gt;                  19         H5 parametric 0.039694913 &lt;=            1 * 0.3430556 *</span></span>
<span><span class="co">#&gt;                  20         H2      simes 0.028895689 &lt;=                1.0000000 *</span></span>
<span><span class="co">#&gt;                  20         H3      simes 0.001585753 &lt;=                0.3644340 *</span></span>
<span><span class="co">#&gt;                  21         H2      simes 0.028895689 &lt;=                0.4273897 *</span></span>
<span><span class="co">#&gt;                  21         H4 parametric 0.029143822 &lt;= 1.0072387086 * 0.2702206 *</span></span>
<span><span class="co">#&gt;                  21         H5 parametric 0.039694913 &lt;= 1.0072387086 * 0.3023897 *</span></span>
<span><span class="co">#&gt;                  22         H2      simes 0.028895689 &lt;=                0.5916667 *</span></span>
<span><span class="co">#&gt;                  22         H4 parametric 0.029143822 &lt;=            1 * 0.4083333 *</span></span>
<span><span class="co">#&gt;                  23         H2      simes 0.028895689 &lt;=                0.5410839 *</span></span>
<span><span class="co">#&gt;                  23         H5 parametric 0.039694913 &lt;=            1 * 0.4589161 *</span></span>
<span><span class="co">#&gt;                  24         H2      simes 0.028895689 &lt;=                1.0000000 *</span></span>
<span><span class="co">#&gt;                  25         H3      simes 0.001585753 &lt;=                0.2976974 *</span></span>
<span><span class="co">#&gt;                  25         H4 parametric 0.029143822 &lt;= 1.0088963322 * 0.3744518 *</span></span>
<span><span class="co">#&gt;                  25         H5 parametric 0.039694913 &lt;= 1.0088963322 * 0.3278509 *</span></span>
<span><span class="co">#&gt;                  26         H3      simes 0.001585753 &lt;=                0.4517379 *</span></span>
<span><span class="co">#&gt;                  26         H4 parametric 0.029143822 &lt;=            1 * 0.5482621 *</span></span>
<span><span class="co">#&gt;                  27         H3      simes 0.001585753 &lt;=                0.4259579 *</span></span>
<span><span class="co">#&gt;                  27         H5 parametric 0.039694913 &lt;=            1 * 0.5740421 *</span></span>
<span><span class="co">#&gt;                  28         H3      simes 0.001585753 &lt;=                1.0000000 *</span></span>
<span><span class="co">#&gt;                  29         H4 parametric 0.029143822 &lt;= 1.0127367033 * 0.5404095 *</span></span>
<span><span class="co">#&gt;                  29         H5 parametric 0.039694913 &lt;= 1.0127367033 * 0.4595905 *</span></span>
<span><span class="co">#&gt;                  30         H4 parametric 0.029143822 &lt;=            1 * 1.0000000 *</span></span>
<span><span class="co">#&gt;                  31         H5 parametric 0.039694913 &lt;=            1 * 1.0000000 *</span></span>
<span><span class="co">#&gt;        alpha   res</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05 FALSE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span>
<span><span class="co">#&gt;         0.05  TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="power-simulations">Power simulations<a class="anchor" aria-label="anchor" href="#power-simulations"></a>
</h2>
<p>It’s not always obvious from a given graph structure how easy or
difficult it will be to reject each hypothesis. One way to understand
this better is to run a power simulation. The essence of a power
simulation is to generate many different p-values using some chosen
distribution, then test the graph against each set of p-values to see
how it performs.</p>
<p>The default for power simulations, like for testing, is to test a
graph at alpha level .05 with Bonferroni testing.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/calculate_power.html">calculate_power</a></span><span class="op">(</span><span class="va">ss_graph</span>, sim_n <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   B1 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   A2 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (A1-B1-A2-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ----------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations with multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;   Simulation means:  0  0  0  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simulation covariance:    A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;                          A1  1  0  0  0</span></span>
<span><span class="co">#&gt;                          B1  0  1  0  0</span></span>
<span><span class="co">#&gt;                          A2  0  0  1  0</span></span>
<span><span class="co">#&gt;                          B2  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Success is defined as rejecting any of [A1, B1]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation --------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                                   A1      B1      A2      B2</span></span>
<span><span class="co">#&gt;        Power to reject each: 0.02578 0.02481 0.00037 0.00037</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Expected rejections: 0.05133</span></span>
<span><span class="co">#&gt;   Power to reject 1 or more: 0.04948</span></span>
<span><span class="co">#&gt;         Power to reject all: 0</span></span>
<span><span class="co">#&gt;      Probability of success: 0.04948</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation details -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   p_sim_A1 p_sim_B1 p_sim_A2 p_sim_B2 rej_A1 rej_B1 rej_A2 rej_B2</span></span>
<span><span class="co">#&gt;   0.231688 0.891753 0.064519 0.377345  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.956617 0.170601 0.010327 0.591798  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.355623 0.009641 0.692345 0.491640  FALSE   TRUE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.126383 0.238675 0.313369 0.068703  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.392056 0.550279 0.071389 0.460420  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.645683 0.731881 0.644340 0.719881  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   ...</span></span></code></pre></div>
<p>However, all testing options are available for power calculations as
well.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corr2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">.5</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">corr2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="fu"><a href="../reference/calculate_power.html">calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span><span class="op">)</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="va">corr2</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   B1 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   A2 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parametric testing correlation:     A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;                                   A1 1.0 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   B1 0.5 1.0 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   A2 0.5 0.5 1.0 0.5</span></span>
<span><span class="co">#&gt;                                   B2 0.5 0.5 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   parametric: (A1-B1-A2-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ----------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations with multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;   Simulation means:  0  0  0  0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simulation covariance:    A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;                          A1  1  0  0  0</span></span>
<span><span class="co">#&gt;                          B1  0  1  0  0</span></span>
<span><span class="co">#&gt;                          A2  0  0  1  0</span></span>
<span><span class="co">#&gt;                          B2  0  0  0  1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Success is defined as rejecting any of [A1, B1]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation --------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                                   A1      B1    A2      B2</span></span>
<span><span class="co">#&gt;        Power to reject each: 0.02729 0.02799 5e-04 0.00041</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Expected rejections: 0.05619</span></span>
<span><span class="co">#&gt;   Power to reject 1 or more: 0.05395</span></span>
<span><span class="co">#&gt;         Power to reject all: 0</span></span>
<span><span class="co">#&gt;      Probability of success: 0.05395</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation details -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   p_sim_A1 p_sim_B1 p_sim_A2 p_sim_B2 rej_A1 rej_B1 rej_A2 rej_B2</span></span>
<span><span class="co">#&gt;   0.187005 0.457798 0.208950 0.260077  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.539701 0.912796 0.656100 0.812733  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.304081 0.845008 0.281441 0.771573  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.416600 0.257064 0.853072 0.129416  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.531751 0.267492 0.235343 0.934041  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.207543 0.347323 0.020383 0.820810  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   ...</span></span></code></pre></div>
<p>In addition to testing options, there are options that control how
p-values are simulated from the multivariate normal distribution.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">s_corr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">.25</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">1</span>, <span class="fl">.25</span>, <span class="fl">.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.25</span>, <span class="fl">1</span>, <span class="fl">.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>, <span class="fl">.5</span>, <span class="fl">.5</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/calculate_power.html">calculate_power</a></span><span class="op">(</span></span>
<span>  <span class="va">ss_graph</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"p"</span><span class="op">)</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="va">corr2</span>,</span>
<span>  marginal_power <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  sim_corr <span class="op">=</span> <span class="va">s_corr1</span>,</span>
<span>  sim_success <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>  sim_seed <span class="op">=</span> <span class="fl">52423</span>, <span class="co"># Set a seed if you need consistent p-values to test across simulations</span></span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ----------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   An initial graph</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   A1: 0.5000</span></span>
<span><span class="co">#&gt;   B1: 0.5000</span></span>
<span><span class="co">#&gt;   A2: 0.0000</span></span>
<span><span class="co">#&gt;   B2: 0.0000</span></span>
<span><span class="co">#&gt;   </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;          A1     B1     A2     B2</span></span>
<span><span class="co">#&gt;   A1 0.0000 0.5000 0.5000 0.0000</span></span>
<span><span class="co">#&gt;   B1 0.5000 0.0000 0.0000 0.5000</span></span>
<span><span class="co">#&gt;   A2 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt;   B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Global alpha = 0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Parametric testing correlation:     A1  B1  A2  B2</span></span>
<span><span class="co">#&gt;                                   A1 1.0 0.5 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   B1 0.5 1.0 0.5 0.5</span></span>
<span><span class="co">#&gt;                                   A2 0.5 0.5 1.0 0.5</span></span>
<span><span class="co">#&gt;                                   B2 0.5 0.5 0.5 1.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   parametric: (A1-B1-A2-B2)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ----------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations - random seed 52423 &amp; multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                     A1 B1 A2 B2</span></span>
<span><span class="co">#&gt;   Simulation means:  1  1  3  3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Simulation covariance:      A1   B1   A2   B2</span></span>
<span><span class="co">#&gt;                          A1 1.00 0.50 0.50 0.25</span></span>
<span><span class="co">#&gt;                          B1 0.50 1.00 0.25 0.50</span></span>
<span><span class="co">#&gt;                          A2 0.50 0.25 1.00 0.50</span></span>
<span><span class="co">#&gt;                          B2 0.25 0.50 0.50 1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Success is defined as rejecting any of [A1, B1]</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation --------------------------------------------------------------</span></span>
<span><span class="co">#&gt;                                   A1      B1      A2      B2</span></span>
<span><span class="co">#&gt;        Power to reject each: 0.20405 0.20541 0.19835 0.19941</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Expected rejections: 0.80722</span></span>
<span><span class="co">#&gt;   Power to reject 1 or more: 0.28897</span></span>
<span><span class="co">#&gt;         Power to reject all: 0.11828</span></span>
<span><span class="co">#&gt;      Probability of success: 0.28897</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation details -------------------------------------------------------------</span></span>
<span><span class="co">#&gt;   p_sim_A1 p_sim_B1 p_sim_A2 p_sim_B2 rej_A1 rej_B1 rej_A2 rej_B2</span></span>
<span><span class="co">#&gt;   0.542911 0.143784 0.000153 0.008469  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.065475 0.134552 0.030342 0.035250  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.247067 0.018555 0.000020 0.000005  FALSE   TRUE  FALSE   TRUE</span></span>
<span><span class="co">#&gt;   0.200207 0.468047 0.000229 0.000027  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.379166 0.287577 0.015581 0.070932  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   0.671091 0.388803 0.050188 0.001437  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   ...</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dong Xi, Ethan Brockmann, Gilead Biostatistics.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
