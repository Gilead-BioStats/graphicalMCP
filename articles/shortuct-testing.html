<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="graphicalMCP">
<title>Sequentially rejective graphical approaches based on Bonferroni tests • graphicalMCP</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sequentially rejective graphical approaches based on Bonferroni tests">
<meta property="og:description" content="graphicalMCP">
<meta property="og:image" content="https://urban-sniffle-p11zlpj.pages.github.io/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/closed-testing.html">Graphical approaches based on the closure principle</a>
    <a class="dropdown-item" href="../articles/generate-closure.html">Generating the closure of a graph</a>
    <a class="dropdown-item" href="../articles/graph-examples.html">Common procedures</a>
    <a class="dropdown-item" href="../articles/shortuct-testing.html">Sequentially rejective graphical approaches based on Bonferroni tests</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sequentially rejective graphical approaches based on Bonferroni tests</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/graphicalMCP/blob/HEAD/vignettes/shortuct-testing.Rmd" class="external-link"><code>vignettes/shortuct-testing.Rmd</code></a></small>
      <div class="d-none name"><code>shortuct-testing.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gt.rstudio.com/" class="external-link">gt</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://gsrmtp.r-forge.r-project.org/" class="external-link">gMCP</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://urban-sniffle-p11zlpj.pages.github.io/">graphicalMCP</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'graphicalMCP'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:gMCP':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     fallback</span></span></code></pre></div>
<div class="section level2">
<h2 id="multiple-comparison-problem">Multiple comparison problem<a class="anchor" aria-label="anchor" href="#multiple-comparison-problem"></a>
</h2>
<p>Consider a confirmatory clinical trial comparing a test treatment
(treatment) against the control treatment (control) for a disease. There
are two doses of treatment: the low dose and the high dose. There are
two endpoints included in the multiplicity adjustment strategy, which
are the primary endpoint (PE) and the secondary endpoint (SE). In total,
there are four null hypotheses: <span class="math inline">\(H_1\)</span>
and <span class="math inline">\(H_3\)</span> are the primary and
secondary hypotheses respectively for the low dose versus control; <span class="math inline">\(H_2\)</span> and <span class="math inline">\(H_4\)</span> are the primary and secondary
hypotheses respectively for the high dose versus control.</p>
<p>There are clinical considerations which constrain the structure of
multiple comparison procedures; these considerations can be flexibly
incorporated using graphical approaches. First, the low and the high
doses are considered equally important, which means that rejecting the
primary hypothesis for either dose versus control leads to a successful
trial. Regarding secondary hypotheses, each one is tested only if its
corresponding primary hypothesis has been rejected. This means that
<span class="math inline">\(H_3\)</span> is tested only after <span class="math inline">\(H_1\)</span> has been rejected; <span class="math inline">\(H_4\)</span> is tested only after <span class="math inline">\(H_2\)</span> has been rejected.</p>
<p>In addition, there are some statistical considerations to complete
the graph. The primary hypotheses <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> will have an equal hypothesis weight
of 0.5. The secondary hypotheses will have a hypothesis weight of 0.
When a primary hypothesis has been rejected, its weight will propagate
along two outgoing edges: one to the other primary hypothesis and one to
its descendant secondary hypothesis. The two edges will have an equal
transition weight of 0.5. When both the primary and the secondary
hypotheses have been rejected for a dose-control comparison, their
hypothesis weights will be propagated to the primary hypothesis for the
other dose-control comparison. With these specifications, we can create
the following graph.</p>
</div>
<div class="section level2">
<h2 id="create-a-graph">Create a graph<a class="anchor" aria-label="anchor" href="#create-a-graph"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">hyp_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H1"</span>, <span class="st">"H2"</span>, <span class="st">"H3"</span>, <span class="st">"H4"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_create.html">graph_create</a></span><span class="op">(</span><span class="va">hypotheses</span>, <span class="va">transitions</span>, <span class="va">hyp_names</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">g</span>, layout <span class="op">=</span> <span class="st">"grid"</span>, vertex.size <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code></pre></div>
<p><img src="shortuct-testing_files/figure-html/create-graph-1.png" width="480"></p>
</div>
<div class="section level2">
<h2 id="perform-the-graphical-multiple-comparison-procedure">Perform the graphical multiple comparison procedure<a class="anchor" aria-label="anchor" href="#perform-the-graphical-multiple-comparison-procedure"></a>
</h2>
<p>Given a set of p-values for <span class="math inline">\(H_1, \ldots,
H_4\)</span>, the graphical multiple comparison procedure can be
performed to control the familywise error rate (FWER) at the
significance level <code>alpha</code>. The
<code>graph_test_shortcut</code> function is agnostic to one-sided or
two-sided tests. For one-sided p-values, <code>alpha</code> is often set
to 0.025 (default); for two-sided p-values, <code>alpha</code> is often
set to 0.05. We consider one-sided tests here. A hypothesis is rejected
if its adjusted p-value is less than or equal to <code>alpha</code>.
After running the procedure, hypotheses <span class="math inline">\(H_1\)</span>, <span class="math inline">\(H_2\)</span>, and <span class="math inline">\(H_4\)</span> are rejected with their adjusted
p-value calculated.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.013</span>, <span class="fl">.012</span>, <span class="fl">.105</span>, <span class="fl">.005</span><span class="op">)</span></span>
<span><span class="va">test_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/testing.html">graph_test_shortcut</a></span><span class="op">(</span><span class="va">g</span>, p <span class="op">=</span> <span class="va">p_values</span>, alpha <span class="op">=</span> <span class="fl">0.025</span><span class="op">)</span></span>
<span><span class="va">test_results</span><span class="op">$</span><span class="va">outputs</span> <span class="co"># Adjusted p-values and rejections</span></span>
<span><span class="co">#&gt; $adjusted_p</span></span>
<span><span class="co">#&gt;    H1    H2    H3    H4 </span></span>
<span><span class="co">#&gt; 0.024 0.024 0.105 0.024 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rejected</span></span>
<span><span class="co">#&gt;    H1    H2    H3    H4 </span></span>
<span><span class="co">#&gt;  TRUE  TRUE FALSE  TRUE </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $graph</span></span>
<span><span class="co">#&gt; Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; H1: 0</span></span>
<span><span class="co">#&gt; H2: 0</span></span>
<span><span class="co">#&gt; H3: 1</span></span>
<span><span class="co">#&gt; H4: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;     H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;  H1  0  0  0  0</span></span>
<span><span class="co">#&gt;  H2  0  0  0  0</span></span>
<span><span class="co">#&gt;  H3  0  0  0  0</span></span>
<span><span class="co">#&gt;  H4  0  0  0  0</span></span></code></pre></div>
<div class="section level3">
<h3 id="obtain-final-and-intermediate-graphs-after-rejections">Obtain final and intermediate graphs after rejections<a class="anchor" aria-label="anchor" href="#obtain-final-and-intermediate-graphs-after-rejections"></a>
</h3>
<p>In addition, two graphs are provided: one is the initial graph and
one is the final graph after removing rejected hypotheses <span class="math inline">\(H_1\)</span>, <span class="math inline">\(H_2\)</span>, and <span class="math inline">\(H_4\)</span>. If we are also interested in
intermediate graphs - for example, the graph after <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> are rejected - we can specify
<code>verbose = TRUE</code>. Note that intermediate graphs depends on
the order of rejections, i.e., the sequence of hypotheses being
rejected. The default order is defined by the increasing adjusted
p-values, followed by the earlier hypothesis numbering in the case of
ties. Among all rejected hypotheses, the one with the smallest adjusted
p-value is the first to be rejected and the one with the largest
adjusted p-value is the last to be rejected.</p>
<p>In this example, the default order of rejection is <span class="math inline">\(H_2\rightarrow H_1\rightarrow H_4\)</span>. To
obtain intermediate graphs based on this order of rejection, one can
specify <code>test_results_verbose$details$results</code>. For example,
the graph after <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> being rejected is given by
<code>test_results_verbose$details$results[[3]]</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_results_verbose</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/testing.html">graph_test_shortcut</a></span><span class="op">(</span><span class="va">g</span>, p <span class="op">=</span> <span class="va">p_values</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">test_results_verbose</span><span class="op">$</span><span class="va">details</span><span class="op">$</span><span class="va">results</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="co"># Intermediate graph after H1 and H2 rejected</span></span>
<span><span class="co">#&gt; Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; H1: 0.0</span></span>
<span><span class="co">#&gt; H2: 0.0</span></span>
<span><span class="co">#&gt; H3: 0.5</span></span>
<span><span class="co">#&gt; H4: 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;     H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;  H1  0  0  0  0</span></span>
<span><span class="co">#&gt;  H2  0  0  0  0</span></span>
<span><span class="co">#&gt;  H3  0  0  0  1</span></span>
<span><span class="co">#&gt;  H4  0  0  1  0</span></span></code></pre></div>
<p>The order of rejections may not be unique and not all orders are
valid. For this example, the rejected hypotheses are <span class="math inline">\(H_1\)</span>, <span class="math inline">\(H_2\)</span> and <span class="math inline">\(H_4\)</span>. The default order of rejections is
<span class="math inline">\(H_2 \rightarrow H_1 \rightarrow
H_4\)</span>. Another valid order of rejections is <span class="math inline">\(H_2 \rightarrow H_4 \rightarrow H_1\)</span>.
However, the first rejected hypothesis can not be <span class="math inline">\(H_1\)</span> or <span class="math inline">\(H_4\)</span>. To obtain all possible rejection
orders, one can use the function <code>graph_rejection_orderings</code>.
Initial, intermediate and final graphs can be obtained by using the
function <code>graph_update</code> with a particular order of
rejections.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">orders</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_rejection_orderings.html">graph_rejection_orderings</a></span><span class="op">(</span><span class="va">test_results</span><span class="op">)</span><span class="op">$</span><span class="va">valid_orderings</span> <span class="co"># Obtain all valid orders of rejections</span></span>
<span><span class="va">orders</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; H2 H1 H4 </span></span>
<span><span class="co">#&gt;  2  1  4 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; H2 H4 H1 </span></span>
<span><span class="co">#&gt;  2  4  1</span></span>
<span><span class="fu"><a href="../reference/graph_update.html">graph_update</a></span><span class="op">(</span><span class="va">g</span>, delete <span class="op">=</span> <span class="va">orders</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="co"># Graphs following the order of H2, H4, and H1</span></span>
<span><span class="co">#&gt; Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; H1: 0.5</span></span>
<span><span class="co">#&gt; H2: 0.5</span></span>
<span><span class="co">#&gt; H3: 0.0</span></span>
<span><span class="co">#&gt; H4: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;      H1  H2  H3  H4</span></span>
<span><span class="co">#&gt;  H1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;  H2 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;  H3 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;  H4 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Updated graph after deleting hypotheses 2, 4, 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; H1: NA</span></span>
<span><span class="co">#&gt; H2: NA</span></span>
<span><span class="co">#&gt; H3:  1</span></span>
<span><span class="co">#&gt; H4: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;     H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;  H1 NA NA NA NA</span></span>
<span><span class="co">#&gt;  H2 NA NA NA NA</span></span>
<span><span class="co">#&gt;  H3 NA NA  0 NA</span></span>
<span><span class="co">#&gt;  H4 NA NA NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deletion sequence ($intermediate_graphs) ---------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   H1: 0.5</span></span>
<span><span class="co">#&gt;   H2: 0.5</span></span>
<span><span class="co">#&gt;   H3: 0.0</span></span>
<span><span class="co">#&gt;   H4: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       H1  H2  H3  H4</span></span>
<span><span class="co">#&gt;   H1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   H2 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   H3 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   H4 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Step 1: Updated graph after removing hypothesis 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;     H1: 0.75</span></span>
<span><span class="co">#&gt;     H2:   NA</span></span>
<span><span class="co">#&gt;     H3: 0.00</span></span>
<span><span class="co">#&gt;     H4: 0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     --- Transition weights ---</span></span>
<span><span class="co">#&gt;              H1       H2       H3       H4</span></span>
<span><span class="co">#&gt;     H1 0.000000       NA 0.666667 0.333333</span></span>
<span><span class="co">#&gt;     H2       NA       NA       NA       NA</span></span>
<span><span class="co">#&gt;     H3 0.500000       NA 0.000000 0.500000</span></span>
<span><span class="co">#&gt;     H4 1.000000       NA 0.000000 0.000000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       Step 2: Updated graph after removing hypotheses 2, 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;       H1:  1</span></span>
<span><span class="co">#&gt;       H2: NA</span></span>
<span><span class="co">#&gt;       H3:  0</span></span>
<span><span class="co">#&gt;       H4: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;       --- Transition weights ---</span></span>
<span><span class="co">#&gt;          H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;       H1  0 NA  1 NA</span></span>
<span><span class="co">#&gt;       H2 NA NA NA NA</span></span>
<span><span class="co">#&gt;       H3  1 NA  0 NA</span></span>
<span><span class="co">#&gt;       H4 NA NA NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         Step 3: Updated graph after removing hypotheses 2, 4, 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;         H1: NA</span></span>
<span><span class="co">#&gt;         H2: NA</span></span>
<span><span class="co">#&gt;         H3:  1</span></span>
<span><span class="co">#&gt;         H4: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;         --- Transition weights ---</span></span>
<span><span class="co">#&gt;            H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;         H1 NA NA NA NA</span></span>
<span><span class="co">#&gt;         H2 NA NA NA NA</span></span>
<span><span class="co">#&gt;         H3 NA NA  0 NA</span></span>
<span><span class="co">#&gt;         H4 NA NA NA NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Final updated graph after removing deleted hypotheses</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   H1: NA</span></span>
<span><span class="co">#&gt;   H2: NA</span></span>
<span><span class="co">#&gt;   H3:  1</span></span>
<span><span class="co">#&gt;   H4: NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;      H1 H2 H3 H4</span></span>
<span><span class="co">#&gt;   H1 NA NA NA NA</span></span>
<span><span class="co">#&gt;   H2 NA NA NA NA</span></span>
<span><span class="co">#&gt;   H3 NA NA  0 NA</span></span>
<span><span class="co">#&gt;   H4 NA NA NA NA</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="obtain-adjusted-significance-levels">Obtain adjusted significance levels<a class="anchor" aria-label="anchor" href="#obtain-adjusted-significance-levels"></a>
</h3>
<p>An equivalent way to obtain rejections is by adjusting significance
levels. A hypothesis is rejected if its p-value is less than or equal to
its adjusted significance level. The adjusted significance levels are
calculated in the same order as adjusted p-values: <span class="math inline">\(H_2 \rightarrow H_1 \rightarrow H_4\)</span>, and
there are four steps of checking for rejections. First, <span class="math inline">\(H_2\)</span> is rejected at an adjusted
significance level of <code>0.5 * alpha</code>. Second, <span class="math inline">\(H_1\)</span> is rejected at an adjusted
significance level of <code>0.75 * alpha</code>, after <span class="math inline">\(H_2\)</span> is rejected. Third, <span class="math inline">\(H_4\)</span> is rejected at an adjusted
significance level of <code>0.5 * alpha</code>, after <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> are rejected. Fourth and finally,
<span class="math inline">\(H_3\)</span> cannot be rejected at an
adjusted significance level of <code>alpha</code>, after <span class="math inline">\(H_1\)</span>, <span class="math inline">\(H_2\)</span> and <span class="math inline">\(H_4\)</span> are rejected. These results can be
obtained by specifying <code>test_values = TRUE</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_results_test_values</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="../reference/testing.html">graph_test_shortcut</a></span><span class="op">(</span><span class="va">g</span>, p <span class="op">=</span> <span class="va">p_values</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, test_values <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">test_results_test_values</span><span class="op">$</span><span class="va">test_values</span><span class="op">$</span><span class="va">results</span></span>
<span><span class="co">#&gt;    Step Hypothesis     p &lt;= Weight * Alpha Inequality_holds</span></span>
<span><span class="co">#&gt; H2    1         H2 0.012 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt; H1    2         H1 0.013 &lt;=   0.75 * 0.025             TRUE</span></span>
<span><span class="co">#&gt; H4    3         H4 0.005 &lt;=   0.50 * 0.025             TRUE</span></span>
<span><span class="co">#&gt; H3    4         H3 0.105 &lt;=   1.00 * 0.025            FALSE</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="power-calculation">Power calculation<a class="anchor" aria-label="anchor" href="#power-calculation"></a>
</h2>
<p>Given the above graph, the trial team is often interested in the
power of the trial. For a single null hypothesis, the power is the
probability of a true positive - that is, rejecting the null hypothesis
at the significance level <code>alpha</code> when the alternative
hypothesis is true. For multiple null hypotheses, there could be
multiple versions of power. For example, the power to reject at least
one hypothesis vs the power to reject all hypotheses, given the
alternative hypotheses are true. With the graphical multiple comparison
procedures, it is also important to understand the power to reject each
hypothesis, given the multiplicity adjustment. Sometimes, a team may
want to customize definitions of power to define success. Thus power
calculation is an important aspect of trial design.</p>
<div class="section level3">
<h3 id="input-marginal-power-for-primary-hypotheses">Input: Marginal power for primary hypotheses<a class="anchor" aria-label="anchor" href="#input-marginal-power-for-primary-hypotheses"></a>
</h3>
<p>Assume that the primary endpoint is about the occurrence of an
unfavorable clinical event. To evaluate the treatment effect, the
proportion of patients with this event is calculated, and a lower
proportion is preferred. Assume that the proportions are 0.181 for the
low and the high doses, and 0.3 for control. Using the equal
randomization among the three treatment groups, the clinical trial team
chooses a total sample size of 600 with 200 per group. This leads to a
marginal power of 80% for <span class="math inline">\(H_1\)</span> and
<span class="math inline">\(H_2\)</span>, respectively, using the
two-sample test for difference in proportions with unpooled variance
each at one-sided significance level 0.025. In this calculation, we use
the marginal power to combine the information from the treatment effect,
any nuisance parameter, and sample sizes for each hypothesis. Note that
the significance level used for the marginal power calculation must be
the same as <code>alpha</code>, which is used in the power calculation
as the significance level for the FWER control. In addition, the
marginal power has a one-to-one relationship with the noncentrality
parameter, which is illustrated below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span>
<span><span class="va">prop</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.181</span>, <span class="fl">0.181</span><span class="op">)</span></span>
<span><span class="va">sample_size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="va">unpooled_variance</span> <span class="op">&lt;-</span> <span class="va">prop</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">prop</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">sample_size</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span></span>
<span>  <span class="va">prop</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">prop</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">sample_size</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">noncentrality_parameter_primary</span> <span class="op">&lt;-</span></span>
<span>  <span class="op">-</span><span class="op">(</span><span class="va">prop</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">prop</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">unpooled_variance</span><span class="op">)</span></span>
<span></span>
<span><span class="va">power_marginal_primary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">alpha</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  <span class="va">noncentrality_parameter_primary</span>, <span class="fl">1</span>,</span>
<span>  lower.tail <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">power_marginal_primary</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H1"</span>, <span class="st">"H2"</span><span class="op">)</span></span>
<span><span class="va">power_marginal_primary</span></span>
<span><span class="co">#&gt;        H1        H2 </span></span>
<span><span class="co">#&gt; 0.8028315 0.8028315</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="input-marginal-power-for-secondary-hypotheses">Input: Marginal power for secondary hypotheses<a class="anchor" aria-label="anchor" href="#input-marginal-power-for-secondary-hypotheses"></a>
</h3>
<p>Assume that the secondary endpoint is about the change in total
medication score from baseline, which is a continuous outcome. To
evaluate the treatment effect, the mean change is calculated, and
greater reduction is preferred. Assume that the mean change from
baseline is the reduction of 7.5 and 8.25, respectively for the low and
the high doses, and 5 for control. Further assume a known common
standard deviation of 10. Given the sample size of 200 per treatment
group, the marginal power is 71% and 90% for <span class="math inline">\(H_3\)</span> and <span class="math inline">\(H_4\)</span>, respectively, using the two-sample
<span class="math inline">\(z\)</span>-test for the difference in means
each at the one-sided significance level 0.025.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mean_change</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">7.5</span>, <span class="fl">8.25</span><span class="op">)</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">variance</span> <span class="op">&lt;-</span> <span class="va">sd</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">sample_size</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">sd</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">sample_size</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="va">noncentrality_parameter_secondary</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">mean_change</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">-</span> <span class="va">mean_change</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">variance</span><span class="op">)</span></span>
<span></span>
<span><span class="va">power_marginal_secondary</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">alpha</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>  <span class="va">noncentrality_parameter_secondary</span>, <span class="fl">1</span>,</span>
<span>  lower.tail <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">power_marginal_secondary</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"H3"</span>, <span class="st">"H4"</span><span class="op">)</span></span>
<span><span class="va">power_marginal_secondary</span></span>
<span><span class="co">#&gt;        H3        H4 </span></span>
<span><span class="co">#&gt; 0.7054139 0.9014809</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="input-correlation-structure-to-simulate-test-statistics">Input: Correlation structure to simulate test statistics<a class="anchor" aria-label="anchor" href="#input-correlation-structure-to-simulate-test-statistics"></a>
</h3>
<p>In addition to the marginal power, we also need to make assumptions
about the joint distribution of test statistics. In this example, we
assume that they follow a multivariate normal distribution with means
defined by the noncentrality parameters above and the correlation matrix
<span class="math inline">\(R\)</span>. To obtain the correlations, it
is helpful to understand that there are two types of correlations in
this example. The correlation between two dose-control comparisons for
the same endpoint and the correlation between endpoints. The former
correlation can be calculated as a function of sample size. For example,
the correlation between test statistics for <span class="math inline">\(H_1\)</span> and <span class="math inline">\(H_2\)</span> is <span class="math inline">\(\rho_{12}=\left(\frac{n_1}{n_1+n_0}\right)^{1/2}\left(\frac{n_2}{n_3+n_0}\right)^{1/2}\)</span>.
Under the equal randomization, this correlation is 0.5. The correlation
between test statistics for <span class="math inline">\(H_3\)</span> and
<span class="math inline">\(H_4\)</span> is the same as the above. On
the other hand, the correlation between endpoints for the same
dose-control comparison is often estimated based on prior knowledge or
from previous trials. Without the information, we assume it to be <span class="math inline">\(\rho_{13}=\rho_{24}=0.5\)</span>. In practice, one
could set this correlation as a parameter and try multiple values to
assess the sensitivity of this assumption. Regarding the correlation
between test statistics for <span class="math inline">\(H_1\)</span> and
<span class="math inline">\(H_4\)</span> and for <span class="math inline">\(H_2\)</span> and <span class="math inline">\(H_3\)</span>, they are even more difficult to
estimate. Here we use a simple product rule, which means that this
correlation is a product of correlations of the two previously assumed
correlations. For example, <span class="math inline">\(\rho_{14}=\rho_{12}*\rho_{24}\)</span> and <span class="math inline">\(\rho_{23}=\rho_{12}*\rho_{13}\)</span>. In
practice, one may make further assumptions instead of using the product
rule.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, nrow <span class="op">=</span> <span class="fl">4</span>, ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">corr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">corr</span><span class="op">[</span><span class="fl">3</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span></span>
<span>  <span class="va">sample_size</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">sample_size</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span><span class="va">corr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">corr</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">rho</span></span>
<span><span class="va">corr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">corr</span><span class="op">[</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">corr</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">rho</span></span>
<span><span class="va">corr</span> <span class="op">&lt;-</span> <span class="va">corr</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">corr</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">corr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">corr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">hyp_names</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">corr</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">hyp_names</span></span>
<span><span class="va">corr</span></span>
<span><span class="co">#&gt;      H1   H2   H3   H4</span></span>
<span><span class="co">#&gt; H1 1.00 0.50 0.50 0.25</span></span>
<span><span class="co">#&gt; H2 0.50 1.00 0.25 0.50</span></span>
<span><span class="co">#&gt; H3 0.50 0.25 1.00 0.50</span></span>
<span><span class="co">#&gt; H4 0.25 0.50 0.50 1.00</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="user-defined-success-criteria">User-defined success criteria<a class="anchor" aria-label="anchor" href="#user-defined-success-criteria"></a>
</h3>
<p>As mentioned earlier, there are multiple versions of “power” when
there are multiple hypotheses. Commonly used “power” definitions
include:</p>
<ul>
<li>Local power: The probability of each hypothesis being rejected (with
multiplicity adjustment)</li>
<li>Expected no. of rejections: The expected number of rejections</li>
<li>Power to reject 1 or more: The probability to reject at least one
hypothesis</li>
<li>Power to reject all: The probability to reject all hypotheses</li>
</ul>
<p>These are the default outputs from the
<code>graph_calculate_power</code> function. In addition, a user can
customize success criteria to define other versions of “power”.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Probability to reject H1</span></span>
<span><span class="va">H1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Expected number of rejections</span></span>
<span><span class="va">`Expected no. of rejections`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Probability to reject at least one hypothesis</span></span>
<span><span class="va">`AtLeast1`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">|</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Probability to reject all hypotheses</span></span>
<span><span class="va">`All`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Probability to reject both H1 and H2</span></span>
<span><span class="va">`H1andH2`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># Probability to reject both hypotheses for the low dose or the high dose</span></span>
<span><span class="va">`(H1andH3)or(H2andH4)`</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">succ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="va">H1</span>, <span class="va">`Expected no. of rejections`</span>, <span class="va">`AtLeast1`</span>, <span class="va">`All`</span>, <span class="va">`H1andH2`</span>,</span>
<span>  <span class="va">`(H1andH3)or(H2andH4)`</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">succ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span></span>
<span>  <span class="va">succ</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"H1"</span>, <span class="st">"Expected no. of rejections"</span>, <span class="st">"AtLeast1"</span>, <span class="st">"All"</span>, <span class="st">"H1andH2"</span>,</span>
<span>    <span class="st">"(H1andH3)or(H2andH4)"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="output-calculate-power">Output: Calculate power<a class="anchor" aria-label="anchor" href="#output-calculate-power"></a>
</h3>
<p>Given the above inputs, we can calculate power via simulation for the
graphical multiple comparison procedure at one-sided significance level
<code>alpha = 0.025</code> using <code>sim_n = 1e5</code> simulations
and the seed <code>sim_seed = 1234</code>. The local power is 0.758,
0.765, 0.689, and 0.570, respectively for <span class="math inline">\(H_1, \ldots, H_4\)</span>. Note that the local
power is lower than the marginal power because the former is adjusted
for multiplicity. The power to reject at least one hypothesis is 0.856
and the power to reject all hypotheses is 0.512. The expected number of
rejections is 2.782. For the last two user-defined success criteria, the
probability to reject both <span class="math inline">\(H_1\)</span> and
<span class="math inline">\(H_2\)</span> is 0.667, and the probability
to reject at least one pair of <span class="math inline">\((H_1\)</span>
and <span class="math inline">\(H_3)\)</span> and <span class="math inline">\((H_2\)</span> and <span class="math inline">\(H_4)\)</span> is 0.747.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span><span class="va">g</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>  sim_corr <span class="op">=</span> <span class="va">corr</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  power_marginal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">power_marginal_primary</span>, <span class="va">power_marginal_secondary</span><span class="op">)</span>,</span>
<span>  sim_success <span class="op">=</span> <span class="va">succ</span>,</span>
<span>  sim_seed <span class="op">=</span> <span class="fl">1234</span></span>
<span><span class="op">)</span></span>
<span><span class="va">output</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   H1: 0.5</span></span>
<span><span class="co">#&gt;   H2: 0.5</span></span>
<span><span class="co">#&gt;   H3: 0.0</span></span>
<span><span class="co">#&gt;   H4: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       H1  H2  H3  H4</span></span>
<span><span class="co">#&gt;   H1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   H2 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   H3 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   H4 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (H1, H2, H3, H4)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ($inputs) ------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations - random seed 1234 &amp; multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       H1     H2     H3     H4</span></span>
<span><span class="co">#&gt;   Marginal power: 0.8028 0.8028 0.7054 0.9015</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation:      H1   H2   H3   H4</span></span>
<span><span class="co">#&gt;                H1 1.00 0.50 0.50 0.25</span></span>
<span><span class="co">#&gt;                H2 0.50 1.00 0.25 0.50</span></span>
<span><span class="co">#&gt;                H3 0.50 0.25 1.00 0.50</span></span>
<span><span class="co">#&gt;                H4 0.25 0.50 0.50 1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation ($power) -----------------------------------------------------</span></span>
<span><span class="co">#&gt;                                   H1     H2     H3     H4</span></span>
<span><span class="co">#&gt;                  Local power: 0.7640 0.7589 0.5677 0.6913</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Expected no. of rejections: 2.782</span></span>
<span><span class="co">#&gt;    Power to reject 1 or more: 0.8556</span></span>
<span><span class="co">#&gt;          Power to reject all: 0.5121</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Success measure  Power</span></span>
<span><span class="co">#&gt;                           H1 0.7640</span></span>
<span><span class="co">#&gt;   Expected no. of rejections 2.7818</span></span>
<span><span class="co">#&gt;                     AtLeast1 0.8556</span></span>
<span><span class="co">#&gt;                          All 0.5121</span></span>
<span><span class="co">#&gt;                      H1andH2 0.6673</span></span>
<span><span class="co">#&gt;         (H1andH3)or(H2andH4) 0.7470</span></span></code></pre></div>
<p>To see the detailed outputs of all simulated p-values and rejection
decisions for all hypotheses, specify <code>verbose = TRUE</code>. This
will produce a lot of outputs. To allow flexible printing functions, a
user can change the following:</p>
<ul>
<li>The indented space with the default setting of
<code>indent = 2</code>
</li>
<li>The precision of numeric values (i.e., the number of significant
digits) with the default setting of <code>precision = 4</code>
</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">verbose_output</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/graph_calculate_power.html">graph_calculate_power</a></span><span class="op">(</span><span class="va">g</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">.025</span>,</span>
<span>  sim_corr <span class="op">=</span> <span class="va">corr</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  power_marginal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">power_marginal_primary</span>, <span class="va">power_marginal_secondary</span><span class="op">)</span>,</span>
<span>  sim_success <span class="op">=</span> <span class="va">succ</span>,</span>
<span>  sim_seed <span class="op">=</span> <span class="fl">1234</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">verbose_output</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;   Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;   H1: 0.5</span></span>
<span><span class="co">#&gt;   H2: 0.5</span></span>
<span><span class="co">#&gt;   H3: 0.0</span></span>
<span><span class="co">#&gt;   H4: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   --- Transition weights ---</span></span>
<span><span class="co">#&gt;       H1  H2  H3  H4</span></span>
<span><span class="co">#&gt;   H1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;   H2 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;   H3 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;   H4 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Test types</span></span>
<span><span class="co">#&gt;   bonferroni: (H1, H2, H3, H4)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ($inputs) ------------------------------------------------</span></span>
<span><span class="co">#&gt;   Testing 100,000 simulations - random seed 1234 &amp; multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                       H1     H2     H3     H4</span></span>
<span><span class="co">#&gt;   Marginal power: 0.8028 0.8028 0.7054 0.9015</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlation:      H1   H2   H3   H4</span></span>
<span><span class="co">#&gt;                H1 1.00 0.50 0.50 0.25</span></span>
<span><span class="co">#&gt;                H2 0.50 1.00 0.25 0.50</span></span>
<span><span class="co">#&gt;                H3 0.50 0.25 1.00 0.50</span></span>
<span><span class="co">#&gt;                H4 0.25 0.50 0.50 1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation ($power) -----------------------------------------------------</span></span>
<span><span class="co">#&gt;                                   H1     H2     H3     H4</span></span>
<span><span class="co">#&gt;                  Local power: 0.7640 0.7589 0.5677 0.6913</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Expected no. of rejections: 2.782</span></span>
<span><span class="co">#&gt;    Power to reject 1 or more: 0.8556</span></span>
<span><span class="co">#&gt;          Power to reject all: 0.5121</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;              Success measure  Power</span></span>
<span><span class="co">#&gt;                           H1 0.7640</span></span>
<span><span class="co">#&gt;   Expected no. of rejections 2.7818</span></span>
<span><span class="co">#&gt;                     AtLeast1 0.8556</span></span>
<span><span class="co">#&gt;                          All 0.5121</span></span>
<span><span class="co">#&gt;                      H1andH2 0.6673</span></span>
<span><span class="co">#&gt;         (H1andH3)or(H2andH4) 0.7470</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation details ($details) --------------------------------------------------</span></span>
<span><span class="co">#&gt;     p_sim_H1  p_sim_H2  p_sim_H3  p_sim_H4 rej_H1 rej_H2 rej_H3 rej_H4</span></span>
<span><span class="co">#&gt;    3.082e-02 1.207e-02 4.119e-03 9.324e-02  FALSE   TRUE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;    7.934e-04 6.499e-04 2.452e-02 2.966e-03   TRUE   TRUE   TRUE   TRUE</span></span>
<span><span class="co">#&gt;    3.030e-02 5.954e-02 5.431e-02 2.626e-02  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;    9.743e-03 3.319e-03 7.417e-04 4.025e-04   TRUE   TRUE   TRUE   TRUE</span></span>
<span><span class="co">#&gt;    1.971e-02 8.616e-03 1.642e-02 2.418e-07   TRUE   TRUE   TRUE   TRUE</span></span>
<span><span class="co">#&gt;    3.121e-03 6.702e-03 1.374e-02 2.752e-04   TRUE   TRUE   TRUE   TRUE</span></span>
<span><span class="co">#&gt;    3.022e-02 1.424e-01 6.038e-03 2.117e-02  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;    2.498e-03 2.940e-02 4.143e-04 2.208e-03   TRUE  FALSE   TRUE  FALSE</span></span>
<span><span class="co">#&gt;    6.190e-02 3.873e-02 3.166e-01 5.700e-02  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;    3.678e-01 1.896e-01 7.023e-02 1.190e-02  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;   ... (Use `print(x, rows = &lt;nn&gt;)` for more)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">verbose_output</span>, indent <span class="op">=</span> <span class="fl">4</span>, precision <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test parameters ($inputs) ------------------------------------------------------</span></span>
<span><span class="co">#&gt;     Initial graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt;     H1: 0.5</span></span>
<span><span class="co">#&gt;     H2: 0.5</span></span>
<span><span class="co">#&gt;     H3: 0.0</span></span>
<span><span class="co">#&gt;     H4: 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     --- Transition weights ---</span></span>
<span><span class="co">#&gt;         H1  H2  H3  H4</span></span>
<span><span class="co">#&gt;     H1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt;     H2 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt;     H3 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt;     H4 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Alpha = 0.025</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Test types</span></span>
<span><span class="co">#&gt;     bonferroni: (H1, H2, H3, H4)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation parameters ($inputs) ------------------------------------------------</span></span>
<span><span class="co">#&gt;     Testing 100,000 simulations - random seed 1234 &amp; multivariate normal params:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                           H1       H2       H3       H4</span></span>
<span><span class="co">#&gt;     Marginal power: 0.802831 0.802831 0.705414 0.901481</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Correlation:      H1   H2   H3   H4</span></span>
<span><span class="co">#&gt;                  H1 1.00 0.50 0.50 0.25</span></span>
<span><span class="co">#&gt;                  H2 0.50 1.00 0.25 0.50</span></span>
<span><span class="co">#&gt;                  H3 0.50 0.25 1.00 0.50</span></span>
<span><span class="co">#&gt;                  H4 0.25 0.50 0.50 1.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Power calculation ($power) -----------------------------------------------------</span></span>
<span><span class="co">#&gt;                                      H1      H2      H3      H4</span></span>
<span><span class="co">#&gt;                    Local power: 0.76396 0.75887 0.56767 0.69133</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     Expected no. of rejections: 2.78183</span></span>
<span><span class="co">#&gt;      Power to reject 1 or more: 0.85557</span></span>
<span><span class="co">#&gt;            Power to reject all: 0.51205</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;                Success measure   Power</span></span>
<span><span class="co">#&gt;                             H1 0.76396</span></span>
<span><span class="co">#&gt;     Expected no. of rejections 2.78183</span></span>
<span><span class="co">#&gt;                       AtLeast1 0.85557</span></span>
<span><span class="co">#&gt;                            All 0.51205</span></span>
<span><span class="co">#&gt;                        H1andH2 0.66726</span></span>
<span><span class="co">#&gt;           (H1andH3)or(H2andH4) 0.74695</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulation details ($details) --------------------------------------------------</span></span>
<span><span class="co">#&gt;         p_sim_H1    p_sim_H2    p_sim_H3    p_sim_H4 rej_H1 rej_H2 rej_H3 rej_H4</span></span>
<span><span class="co">#&gt;      3.08204e-02 1.20654e-02 4.11858e-03 9.32434e-02  FALSE   TRUE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;      7.93372e-04 6.49905e-04 2.45178e-02 2.96560e-03   TRUE   TRUE   TRUE   TRUE</span></span>
<span><span class="co">#&gt;      3.02992e-02 5.95396e-02 5.43083e-02 2.62583e-02  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;      9.74332e-03 3.31857e-03 7.41721e-04 4.02469e-04   TRUE   TRUE   TRUE   TRUE</span></span>
<span><span class="co">#&gt;      1.97135e-02 8.61618e-03 1.64183e-02 2.41833e-07   TRUE   TRUE   TRUE   TRUE</span></span>
<span><span class="co">#&gt;      3.12066e-03 6.70231e-03 1.37441e-02 2.75170e-04   TRUE   TRUE   TRUE   TRUE</span></span>
<span><span class="co">#&gt;      3.02208e-02 1.42376e-01 6.03828e-03 2.11740e-02  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;      2.49757e-03 2.94026e-02 4.14273e-04 2.20779e-03   TRUE  FALSE   TRUE  FALSE</span></span>
<span><span class="co">#&gt;      6.18994e-02 3.87257e-02 3.16613e-01 5.69979e-02  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;      3.67792e-01 1.89598e-01 7.02265e-02 1.18965e-02  FALSE  FALSE  FALSE  FALSE</span></span>
<span><span class="co">#&gt;     ... (Use `print(x, rows = &lt;nn&gt;)` for more)</span></span></code></pre></div>
<!--
## Compared with gMCP


```r
g_gMCP <- as_graphMCP(g)
set.seed(1234)
result <- calcPower(
  graph = g_gMCP, mean = c(
    noncentrality_parameter_primary,
    noncentrality_parameter_secondary
  ), f = succ, corr.sim = corr, alpha = 0.025,
  n.sim = 1e+05
)

# Local power
output$power$power_local
#>      H1      H2      H3      H4 
#> 0.76396 0.75887 0.56767 0.69133
result$LocalPower
#>        H1        H2        H3        H4 
#> 0.7646027 0.7587128 0.5681534 0.6901932
# User-defined power
as.numeric(output$power$power_success)
#> [1] 0.76396 2.78183 0.85557 0.51205 0.66726 0.74695
c(result$func1, result$func2, result$func3, result$func4, result$func5, result$func6)
#> NULL
```
-->
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Dong Xi, Ethan Brockmann, Gilead Biostatistics.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
