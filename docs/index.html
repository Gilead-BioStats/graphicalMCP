<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Graphical Approach for Multiple Comparison Procedures â€¢ graphicalMCP</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Graphical Approach for Multiple Comparison Procedures">
<meta property="og:description" content="A multiple comparison procedure (or multiple test procedure)
    is a a statistical analysis method for determining efficacy of
    multiple drugs, or multiple doses of the same drug, in a single
    clinical trial. Bretz, et al (2011) laid out a graph-based approach to
    these multiple comparison procedures, in which the weights of the
    vertices and edges of the graph are determined independently of the
    particular statistical test used to assess results. This package is a
    low-dependency implementation of the methods described in that paper.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">graphicalMCP</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/generate-weights-performance.html">Generating the closure tree</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A multiple comparison procedure (MCP) is a statistical analysis method that allows for assessing the efficacy of multiple endpoints, some of which are dependent on each other, in a single clinical trial. Endpoints can be different doses, treatment of different conditions, or combined superiority &amp; non-inferiority testing.</p>
<p>In <a href="https://onlinelibrary.wiley.com/doi/10.1002/bimj.201000239" class="external-link">Bretz et al (2011)</a>, a graphical method to MCPs was described, which separates the weighting of the dependency graph from the particular statistical test used to assess each endpoint. This package is a low-dependency implementation of those methods.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>graphicalMCP is not on CRAN, so install it from GitHub with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("pak")</span></span>
<span><span class="fu">pak</span><span class="fu">::</span><span class="fu"><a href="http://pak.r-lib.org/reference/pak.html" class="external-link">pak</a></span><span class="op">(</span><span class="st">"Gilead-BioStats/graphicalMCP"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="basic-usage">Basic usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h2>
<div class="section level3">
<h3 id="initial-graph">Initial graph<a class="anchor" aria-label="anchor" href="#initial-graph"></a>
</h3>
<p>The base object in graphicalMCP is an <code>initial_graph</code>, which is a weighted, directed graph represented by a matrix of transition (edge) weights, and a vector of hypothesis (vertex) weights.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">graphicalMCP</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># A graphical multiple comparison procedure with two primary hypotheses (H1</span></span>
<span><span class="co"># and H2) and two secondary hypotheses (H3 and H4)</span></span>
<span><span class="co"># See Figure 1 in Bretz, F., Posch, M., Glimm, E., Klinglmueller, F., Maurer,</span></span>
<span><span class="co"># W., &amp; Rohmeyer, K. (2011). Graphical approaches for multiple comparison</span></span>
<span><span class="co"># procedures using weighted Bonferroni, Simes, or parametric tests. Biometrical</span></span>
<span><span class="co"># Journal, 53(6), 894-913.</span></span>
<span><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span>, <span class="st">"A2"</span>, <span class="st">"B1"</span>, <span class="st">"B2"</span><span class="op">)</span></span>
<span><span class="va">g_dose</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/create_graph.html">create_graph</a></span><span class="op">(</span><span class="va">hypotheses</span>, <span class="va">transitions</span>, <span class="va">names</span><span class="op">)</span></span>
<span></span>
<span><span class="va">g_dose</span></span>
<span><span class="co">#&gt; An MCP graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; A1: (0.5000)</span></span>
<span><span class="co">#&gt; A2: (0.5000)</span></span>
<span><span class="co">#&gt; B1: (0.0000)</span></span>
<span><span class="co">#&gt; B2: (0.0000)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;        A1     A2     B1     B2</span></span>
<span><span class="co">#&gt; A1 0.0000 0.0000 1.0000 0.0000</span></span>
<span><span class="co">#&gt; A2 0.0000 0.0000 0.0000 1.0000</span></span>
<span><span class="co">#&gt; B1 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; B2 1.0000 0.0000 0.0000 0.0000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="update-graph">Update graph<a class="anchor" aria-label="anchor" href="#update-graph"></a>
</h3>
<p>Hypotheses can be rejected from the MCP using <code><a href="reference/update_graph.html">update_graph()</a></code>. Updated weights and transitions are calculated according to the weighting strategy in <a href="https://onlinelibrary.wiley.com/doi/10.1002/bimj.201000239" class="external-link">Bretz et al (2011)</a></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/update_graph.html">update_graph</a></span><span class="op">(</span><span class="va">g_dose</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An MCP graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; A1: (0.5000)</span></span>
<span><span class="co">#&gt; A2: (0.5000)</span></span>
<span><span class="co">#&gt; B1: (0.0000)</span></span>
<span><span class="co">#&gt; B2: (0.0000)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;        A1     A2     B1     B2</span></span>
<span><span class="co">#&gt; A1 0.0000 0.0000 1.0000 0.0000</span></span>
<span><span class="co">#&gt; A2 0.0000 0.0000 0.0000 1.0000</span></span>
<span><span class="co">#&gt; B1 0.0000 1.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; B2 1.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypotheses kept ---</span></span>
<span><span class="co">#&gt;    A1    A2    B1   B2</span></span>
<span><span class="co">#&gt;  TRUE FALSE FALSE TRUE</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; An MCP graph</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Hypothesis weights ---</span></span>
<span><span class="co">#&gt; A1: (0.5000)</span></span>
<span><span class="co">#&gt; A2: (0.0000)</span></span>
<span><span class="co">#&gt; B1: (0.0000)</span></span>
<span><span class="co">#&gt; B2: (0.5000)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Transition weights ---</span></span>
<span><span class="co">#&gt;        A1     A2     B1     B2</span></span>
<span><span class="co">#&gt; A1 0.0000 0.0000 0.0000 1.0000</span></span>
<span><span class="co">#&gt; A2 0.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; B1 0.0000 0.0000 0.0000 0.0000</span></span>
<span><span class="co">#&gt; B2 1.0000 0.0000 0.0000 0.0000</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="generate-weights">Generate weights<a class="anchor" aria-label="anchor" href="#generate-weights"></a>
</h3>
<p>The weights of all subgraphs can be calculated with <code><a href="reference/generate_weights.html">generate_weights()</a></code>. This uses some more efficient code under the hood than <code><a href="reference/update_graph.html">update_graph()</a></code> in order to be performant for larger graphs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="reference/generate_weights.html">generate_weights</a></span><span class="op">(</span><span class="va">g_dose</span><span class="op">)</span></span>
<span><span class="co">#&gt;    A1 A2 B1 B2  A1  A2  B1  B2</span></span>
<span><span class="co">#&gt; 1   1  1  1  1 0.5 0.5 0.0 0.0</span></span>
<span><span class="co">#&gt; 2   0  1  1  1 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt; 3   0  0  1  1 0.0 0.0 0.5 0.5</span></span>
<span><span class="co">#&gt; 4   0  0  0  1 0.0 0.0 0.0 1.0</span></span>
<span><span class="co">#&gt; 5   0  0  1  0 0.0 0.0 1.0 0.0</span></span>
<span><span class="co">#&gt; 6   0  1  0  1 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 7   0  1  0  0 0.0 1.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 8   0  1  1  0 0.0 0.5 0.5 0.0</span></span>
<span><span class="co">#&gt; 9   1  0  1  1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt; 10  1  0  0  1 0.5 0.0 0.0 0.5</span></span>
<span><span class="co">#&gt; 11  1  0  0  0 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 12  1  0  1  0 1.0 0.0 0.0 0.0</span></span>
<span><span class="co">#&gt; 13  1  1  0  1 0.5 0.5 0.0 0.0</span></span>
<span><span class="co">#&gt; 14  1  1  0  0 0.5 0.5 0.0 0.0</span></span>
<span><span class="co">#&gt; 15  1  1  1  0 0.5 0.5 0.0 0.0</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="related-work">Related work<a class="anchor" aria-label="anchor" href="#related-work"></a>
</h2>
<p>These methods were originally implemented in R after the 2011 paper in the gMCP package, which is still available on CRAN today:</p>
<ul>
<li><code>install.packages("gMCP")</code></li>
<li><a href="https://github.com/kornl/gMCP" class="external-link uri">https://github.com/kornl/gMCP</a></li>
</ul>
<p>However, because development has ceased on this original package, we hope to re-implement the methods with a clearer distinction between weighting procedures and test procedures; with fewer dependencies, in particular shedding the Java dependency; with the simpler, more transparent S3 class framework; and with improvements to the accuracy of the parametric tests method.</p>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing graphicalMCP</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Dong Xi <br><small class="roles"> Author, maintainer </small>  </li>
<li>Ethan Brockmann <br><small class="roles"> Author </small>  </li>
<li>Gilead Biostatistics <br><small class="roles"> Copyright holder, funder </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=graphicalMCP" class="external-link"><img src="https://www.r-pkg.org/badges/version/graphicalMCP" alt="CRAN status"></a></li>
<li><a href="https://app.codecov.io/gh/Gilead-BioStats/graphicalMCP?branch=s3-graph_mcp" class="external-link"><img src="https://codecov.io/gh/Gilead-BioStats/graphicalMCP/branch/s3-graph_mcp/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/Gilead-BioStats/graphicalMCP/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/Gilead-BioStats/graphicalMCP/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Dong Xi, Ethan Brockmann, Gilead Biostatistics.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
