<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="It's often difficult to tell how likely a given hypothesis is to be rejected.
This is where power simulations are useful. Under a set of distribution
parameters, many p-values are generated, and the graph is tested against each
one. Any testing strategy can be used. Then probabilities are calculated for
each hypothesis to be rejected, as well as some additional probabilities such
as expected rejections and probability of rejecting any hypothesis"><title>Obtain hypothesis rejection probabilities — graph_calculate_power • graphicalMCP</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Obtain hypothesis rejection probabilities — graph_calculate_power"><meta property="og:description" content="It's often difficult to tell how likely a given hypothesis is to be rejected.
This is where power simulations are useful. Under a set of distribution
parameters, many p-values are generated, and the graph is tested against each
one. Any testing strategy can be used. Then probabilities are calculated for
each hypothesis to be rejected, as well as some additional probabilities such
as expected rejections and probability of rejecting any hypothesis"><meta property="og:image" content="https://urban-sniffle-p11zlpj.pages.github.io/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/graphicalMCP.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/glossary.html">Glossary</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Function reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/shortcut-testing.html">Sequentially rejective graphical multiple comparison procedures based on Bonferroni tests</a>
    <a class="dropdown-item" href="../articles/closed-testing.html">Graphical multiple comparison procedures based on the closure principle</a>
    <a class="dropdown-item" href="../articles/graph-examples.html">Common multiple comparison procedures illustrated using graphicalMCP</a>
    <a class="dropdown-item" href="../articles/comparisons.html">Comparisons with other packages</a>
    <a class="dropdown-item" href="../articles/generate-closure.html">Rationales to generate the closure and the weighting strategy of a graph</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Obtain hypothesis rejection probabilities</h1>
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/graphicalMCP/blob/HEAD/R/graph_calculate_power.R" class="external-link"><code>R/graph_calculate_power.R</code></a></small>
      <div class="d-none name"><code>graph_calculate_power.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>It's often difficult to tell how likely a given hypothesis is to be rejected.
This is where power simulations are useful. Under a set of distribution
parameters, many p-values are generated, and the graph is tested against each
one. Any testing strategy can be used. Then probabilities are calculated for
each hypothesis to be rejected, as well as some additional probabilities such
as expected rejections and probability of rejecting any hypothesis</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">graph_calculate_power</span><span class="op">(</span></span>
<span>  <span class="va">graph</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  power_marginal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">hypotheses</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">hypotheses</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bonferroni"</span><span class="op">)</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">test_types</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  sim_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">hypotheses</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sim_success <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>graph</dt>
<dd><p>An initial graph as returned by <code><a href="graph_create.html">graph_create()</a></code></p></dd>


<dt>alpha</dt>
<dd><p>A numeric scalar specifying the global significance level for
testing</p></dd>


<dt>power_marginal</dt>
<dd><p>A numeric vector of mean values to use when simulating
p-values. Exactly one mean per hypothesis is needed, and p-values will be
sampled from the multivariate normal distribution. See Details for more</p></dd>


<dt>test_groups</dt>
<dd><p>A list of numeric vectors specifying hypotheses to test
together</p></dd>


<dt>test_types</dt>
<dd><p>A character vector of tests to apply to the given groups</p></dd>


<dt>test_corr</dt>
<dd><p>Optional if no <code>test_types</code> are parametric. A numeric matrix
of correlations between hypotheses' test statistics</p></dd>


<dt>sim_n</dt>
<dd><p>An integer scalar specifying how many simulations to run</p></dd>


<dt>sim_corr</dt>
<dd><p>A numeric matrix of correlations between hypotheses used to
sample from the multivariate normal distribution to generate p-values</p></dd>


<dt>sim_success</dt>
<dd><p>A list of user-defined functions to apply to the power
results. Functions must take one simulation's logical vector of results as
an input, and return a length-one logical vector. For instance, if
"success" means rejecting hypotheses 1 and 2, use <code>sim_success = list("1 and 2" = function(x) x[1] &amp;&amp; x[2])</code>. If the list is not named, the function
body will be used as the name. Lambda functions also work starting with R
4.1, e.g. <code>sim_success = list(\(x) x[3] || x[4])</code></p></dd>


<dt>verbose</dt>
<dd><p>A logical scalar specifying whether the full matrix of
simulations and test results should be included in the output or not</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with three elements</p><ul><li><p>inputs - A list of input parameters</p></li>
<li><p>power - A list of measures of how often hypotheses are rejected</p><ul><li><p>power_local - Rejection proportion for each hypothesis individually</p></li>
<li><p>power_expected - Average number of hypotheses rejected in a single
simulation</p></li>
<li><p>power_at_least_1 - Proportion of simulations which reject any
hypothesis</p></li>
<li><p>power_all - Proportion of simulations which reject all hypotheses</p></li>
<li><p>power_success - Proportion of simulations which reject any of the
hypotheses specified in <code>sim_success</code></p></li>
</ul></li>
<li><p>details - An optional list of datasets showing simulated p-values and
results for each simulation</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The parameters of the normal distribution are set with <code>power_marginal</code>
(means) and <code>sim_corr</code> (correlation between test statistics). The mean of
each hypothesis should be set as its marginal power
$$d_i=P_{\xi_i}(p_i\leq\alpha)$$ where \(\xi_i\) is the non-centrality
parameter. The correlation between test statistics is induced by the study
design.</p>
    </div>
    <div class="section level2">
    <h2 id="success">Success<a class="anchor" aria-label="anchor" href="#success"></a></h2>
    <p>Success will mean something different for each trial, so
there's a lot of flexibility in the <code>sim_success</code> parameter. However, this
flexibility means there's very little validation of inputs. It's up to the
user to make sure the function(s) passed mean what they think. From an
implementation perspective, each function will be applied row-wise to the
matrix of test results for the simulation, resulting in a <code>sim_n</code> length
vector. The mean of this vector is returned as "Probability of success"</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bretz, F., Maurer, W., Brannath, W., and Posch, M. (2009). A graphical
approach to sequentially rejective multiple test procedures. Statistics in
Medicine, 28(4), 586–604. <a href="https://doi.org/10.1002/sim.3495" class="external-link">https://doi.org/10.1002/sim.3495</a></p>
<p>Bretz, F., Maurer, W., and Hommel, G. (2011). Test and power considerations
for multiple endpoint analyses using sequentially rejective graphical
procedures. Statistics in Medicine, 30(13), 1489–1501.
<a href="https://doi.org/10.1002/sim.3988" class="external-link">https://doi.org/10.1002/sim.3988</a></p>
<p>Bretz, F., Posch, M., Glimm, E., Klinglmueller, F., Maurer, W., and Rohmeyer,
K. (2011). Graphical approaches for multiple comparison procedures using
weighted Bonferroni, Simes, or parametric tests. Biometrical Journal, 53(6),
894–913. <a href="https://doi.org/10.1002/bimj.201000239" class="external-link">https://doi.org/10.1002/bimj.201000239</a></p>
<p>Lu, K. (2016). Graphical approaches using a Bonferroni mixture of weighted
Simes tests. Statistics in Medicine, 35(22), 4041–4055.
<a href="https://doi.org/10.1002/sim.6985" class="external-link">https://doi.org/10.1002/sim.6985</a></p>
<p>Xi, D., Glimm, E., Maurer, W., and Bretz, F. (2017). A unified framework for
weighted parametric multiple test procedures. Biometrical Journal, 59(5),
918–931. <a href="https://doi.org/10.1002/bimj.201600233" class="external-link">https://doi.org/10.1002/bimj.201600233</a></p>
<p>Xi, D., and Bretz, F. (2019). Symmetric graphs for equally weighted tests,
with application to the Hochberg procedure. Statistics in Medicine, 38(27),
5268–5282. <a href="https://doi.org/10.1002/sim.8375" class="external-link">https://doi.org/10.1002/sim.8375</a></p>
<p>Rohmeyer K, Klinglmueller F (2020). <em>gMCP: Graph Based Multiple Test
Procedures</em>. R package version 0.8-15,
<a href="https://cran.r-project.org/package=gMCP" class="external-link">https://cran.r-project.org/package=gMCP</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">par_gate</span> <span class="op">&lt;-</span> <span class="fu"><a href="example-graphs.html">simple_successive_1</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The default is to test all hypotheses with: Bonferroni testing at alpha</span></span></span>
<span class="r-in"><span><span class="co"># level .025, 0 mean under the alternative, and 0 correlation between</span></span></span>
<span class="r-in"><span><span class="co"># hypotheses under the alternative</span></span></span>
<span class="r-in"><span><span class="co"># The default of 100 simulations will usually need to be increased</span></span></span>
<span class="r-in"><span><span class="fu">graph_calculate_power</span><span class="op">(</span><span class="va">par_gate</span>, sim_n <span class="op">=</span> <span class="fl">1e5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test parameters ($inputs) ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Initial graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Hypothesis weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Transition weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      H1 H2 H3 H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1  0  0  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2  0  0  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3  0  1  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4  1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test types</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bonferroni: (H1, H2, H3, H4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulation parameters ($inputs) ------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Testing 100,000 simulations with multivariate normal params:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      H1    H2    H3    H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Marginal power: 0.025 0.025 0.025 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Correlation:    H1 H2 H3 H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H1  1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H2  0  1  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H3  0  0  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H4  0  0  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power calculation ($power) -----------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                    H1      H2      H3      H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Local power: 0.01201 0.01166 0.00016 0.00019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Expected no. of rejections: 0.02402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Power to reject 1 or more: 0.02349</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Power to reject all: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># But any test group/type combination that works for [graph_test_closure()]</span></span></span>
<span class="r-in"><span><span class="co"># can be used</span></span></span>
<span class="r-in"><span><span class="fu">graph_calculate_power</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">par_gate</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="fl">.025</span>,</span></span>
<span class="r-in"><span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"p"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sim_n <span class="op">=</span> <span class="fl">1e5</span>,</span></span>
<span class="r-in"><span>  sim_success <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="kw">function</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="va">.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">||</span> <span class="va">.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    <span class="kw">function</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="va">.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;&amp;</span> <span class="va">.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test parameters ($inputs) ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Initial graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Hypothesis weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Transition weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      H1 H2 H3 H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1  0  0  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2  0  0  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3  0  1  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4  1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Parametric testing correlation:    H3 H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   H3  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   H4  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test types</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        simes: (H1, H2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parametric: (H3, H4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulation parameters ($inputs) ------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Testing 100,000 simulations with multivariate normal params:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      H1    H2    H3    H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Marginal power: 0.025 0.025 0.025 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Correlation:    H1 H2 H3 H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H1  1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H2  0  1  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H3  0  0  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H4  0  0  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power calculation ($power) -----------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                    H1      H2      H3      H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Local power: 0.01203 0.01215 0.00018 0.00021</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Expected no. of rejections: 0.02457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Power to reject 1 or more: 0.02403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Power to reject all: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Success measure   Power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      .[1] || .[2] 0.02403</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      .[1] &amp;&amp; .[2] 0.00015</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Dong Xi, Ethan Brockmann, Gilead Biostatistics.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

