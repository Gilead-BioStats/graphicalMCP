<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate power values for a graphical multiple comparison procedure — graph_calculate_power • graphicalMCP</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate power values for a graphical multiple comparison procedure — graph_calculate_power"><meta name="description" content='Under the alternative hypotheses, the distribution of test statistics is
assumed to be a multivariate normal distribution. Given this distribution,
this function calculates power values for a graphical multiple comparison
procedure. By default, it calculate the local power, which is the probability
to reject an individual hypothesis, the probability to reject at least one
hypothesis, the probability to reject all hypotheses, the expected number of
rejections, and the probability of user-defined success criteria. See
vignette("shortcut-testing") and vignette("closed-testing") for more
illustration of power calculation.'><meta property="og:description" content='Under the alternative hypotheses, the distribution of test statistics is
assumed to be a multivariate normal distribution. Given this distribution,
this function calculates power values for a graphical multiple comparison
procedure. By default, it calculate the local power, which is the probability
to reject an individual hypothesis, the probability to reject at least one
hypothesis, the probability to reject all hypotheses, the expected number of
rejections, and the probability of user-defined success criteria. See
vignette("shortcut-testing") and vignette("closed-testing") for more
illustration of power calculation.'><meta property="og:image" content="https://gilead-biostats.github.io/graphicalMCP/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/graphicalMCP.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/glossary.html">Glossary</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/shortcut-testing.html">Sequentially rejective graphical multiple comparison procedures based on Bonferroni tests</a></li>
    <li><a class="dropdown-item" href="../articles/closed-testing.html">Graphical multiple comparison procedures based on the closure principle</a></li>
    <li><a class="dropdown-item" href="../articles/graph-examples.html">Common multiple comparison procedures illustrated using graphicalMCP</a></li>
    <li><a class="dropdown-item" href="../articles/comparisons.html">Comparisons with other packages</a></li>
    <li><a class="dropdown-item" href="../articles/generate-closure.html">Rationales to generate the closure and the weighting strategy of a graph</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate power values for a graphical multiple comparison procedure</h1>
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/graphicalMCP/blob/main/R/graph_calculate_power.R" class="external-link"><code>R/graph_calculate_power.R</code></a></small>
      <div class="d-none name"><code>graph_calculate_power.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Under the alternative hypotheses, the distribution of test statistics is
assumed to be a multivariate normal distribution. Given this distribution,
this function calculates power values for a graphical multiple comparison
procedure. By default, it calculate the local power, which is the probability
to reject an individual hypothesis, the probability to reject at least one
hypothesis, the probability to reject all hypotheses, the expected number of
rejections, and the probability of user-defined success criteria. See
<code><a href="../articles/shortcut-testing.html">vignette("shortcut-testing")</a></code> and <code><a href="../articles/closed-testing.html">vignette("closed-testing")</a></code> for more
illustration of power calculation.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">graph_calculate_power</span><span class="op">(</span></span>
<span>  <span class="va">graph</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  power_marginal <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">hypotheses</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">hypotheses</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bonferroni"</span><span class="op">)</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">test_types</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sim_n <span class="op">=</span> <span class="fl">1e+05</span>,</span>
<span>  sim_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">hypotheses</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  sim_success <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>An initial graph as returned by <code><a href="graph_create.html">graph_create()</a></code>.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>A numeric value of the one-sided overall significance level,
which should be between 0 &amp; 1. The default is 0.025 for one-sided
hypothesis testing. Note that only one-sided tests are supported.</p></dd>


<dt id="arg-power-marginal">power_marginal<a class="anchor" aria-label="anchor" href="#arg-power-marginal"></a></dt>
<dd><p>A numeric vector of marginal power values to use when
simulating p-values. See Details for more on the simulation process.</p></dd>


<dt id="arg-test-groups">test_groups<a class="anchor" aria-label="anchor" href="#arg-test-groups"></a></dt>
<dd><p>A list of numeric vectors specifying hypotheses to test
together. Grouping is needed to correctly perform Simes and parametric
tests.</p></dd>


<dt id="arg-test-types">test_types<a class="anchor" aria-label="anchor" href="#arg-test-types"></a></dt>
<dd><p>A character vector of test types to apply to each test
group. This is needed to correctly perform Simes and parametric
tests. The length should match the number of elements in <code>test_groups</code>.</p></dd>


<dt id="arg-test-corr">test_corr<a class="anchor" aria-label="anchor" href="#arg-test-corr"></a></dt>
<dd><p>(Optional) A list of numeric correlation matrices. Each
entry in the list should correspond to each test group. For a test group
using Bonferroni or Simes tests, its corresponding entry in <code>test_corr</code>
should be <code>NA</code>. For a test group using parametric tests, its
corresponding entry in <code>test_corr</code> should be a numeric correlation matrix
specifying the correlation between test statistics for hypotheses in this
test group. The length should match the number of elements in
<code>test_groups</code>.</p></dd>


<dt id="arg-sim-n">sim_n<a class="anchor" aria-label="anchor" href="#arg-sim-n"></a></dt>
<dd><p>An integer scalar specifying the number of simulations. The
default is 1e5.</p></dd>


<dt id="arg-sim-corr">sim_corr<a class="anchor" aria-label="anchor" href="#arg-sim-corr"></a></dt>
<dd><p>A numeric matrix of correlations between test statistics for
all hypotheses. The dimensions should match the number of hypotheses in
<code>graph</code>.</p></dd>


<dt id="arg-sim-success">sim_success<a class="anchor" aria-label="anchor" href="#arg-sim-success"></a></dt>
<dd><p>A list of user-defined functions to specify the success
criteria. Functions must take one simulation's logical vector of results as
an input, and return a length-one logical vector. For instance, if
"success" means rejecting hypotheses 1 and 2, use <code>sim_success = list("1 and 2" = function(x) x[1] &amp;&amp; x[2])</code>. If the list is not named, the function
body will be used as the name. Lambda functions also work starting with R
4.1, e.g. <code>sim_success = list(\(x) x[3] || x[4])</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical scalar specifying whether the details of power
simulations should be included in results. The default is <code>verbose = FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>power_report</code> object with a list of 3 elements:</p><ul><li><p><code>inputs</code> - Input parameters, which is a list of:</p><ul><li><p><code>graph</code> - Initial graph,</p></li>
<li><p><code>alpha</code> - Overall significance level,</p></li>
<li><p><code>test_groups</code> - Groups of hypotheses for different types of tests,</p></li>
<li><p><code>test_types</code> - Different types of tests,</p></li>
<li><p><code>test_corr</code> - Correlation matrices for parametric tests,</p></li>
<li><p><code>sim_n</code> - Number of simulations,</p></li>
<li><p><code>power_marginal</code> - Marginal power of all hypotheses</p></li>
<li><p><code>sim_corr</code> - Correlation matrices for simulations,</p></li>
<li><p><code>sim_success</code> - User-defined success criteria.</p></li>
</ul></li>
<li><p><code>power</code> - A list of power values</p><ul><li><p><code>power_local</code> - Local power of all hypotheses, which is the proportion
of simulations in which each hypothesis is rejected,</p></li>
<li><p><code>rejection_expected</code> - Expected (average) number of rejected hypotheses,</p></li>
<li><p><code>power_at_least_1</code> - Power to reject at least one hypothesis,</p></li>
<li><p><code>power_all</code> - Power to reject all hypotheses,</p></li>
<li><p><code>power_success</code> - Power of user-defined success, which is the
proportion of simulations in which the user-defined success criterion</p></li>
<li><p><code>sim_success</code> is met.</p></li>
</ul></li>
<li><p><code>details</code> - An optional list of datasets showing simulated p-values and
results for each simulation.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="simulation-details">Simulation details<a class="anchor" aria-label="anchor" href="#simulation-details"></a></h2>


<p>The power calculation is based on simulations. The distribution to simulate
from is determined as a multivariate normal distribution by <code>power_marginal</code>
and <code>sim_corr</code>. In particular, <code>power_marginal</code> is a vector of marginal
power values for all hypotheses. The marginal power is the power to reject
the null hypothesis at the significance level <code>alpha</code>
<em>without multiplicity adjustment</em>. This value could be readily available from
standard software and other R packages. Then we can determine the mean of the
multivariate normal distribution as
$$\Phi^{-1}\left(1-\alpha\right)-\Phi^{-1}\left(1-d_i\right)$$,
which is often called the non-centrality parameter or the drift parameter.
Here \(d_i\) is the marginal power <code>power_marginal</code> of hypothesis \(i\).
Given the correlation matrix <code>sim_corr</code>, we can simulate from this
multivariate normal distribution using the <code>mvtnorm</code> R package (Genz and
Bretz, 2009).</p>
<p>Each set simulated values can be used to calculate the corresponding
one-sided p-values. Then this set of p-values are plugged into the graphical
multiple comparison procedure to determine which hypotheses are rejected.
This process is repeated <code>n_sim</code> times to produce the power values as the
proportion of simulations in which a particular success criterion is met.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bretz, F., Posch, M., Glimm, E., Klinglmueller, F., Maurer, W., and
Rohmeyer, K. (2011a). Graphical approaches for multiple comparison
procedures using weighted Bonferroni, Simes, or parametric tests.
<em>Biometrical Journal</em>, 53(6), 894-913.</p>
<p>Bretz, F., Maurer, W., and Hommel, G. (2011b). Test and power
considerations for multiple endpoint analyses using sequentially rejective
graphical procedures. <em>Statistics in Medicine</em>, 30(13), 1489-1501.</p>
<p>Genz, A., and Bretz, F. (2009). <em>Computation of Multivariate Normal
and t Probabilities</em>, series Lecture Notes in Statistics. Springer-Verlag,
Heidelberg.</p>
<p>Lu, K. (2016). Graphical approaches using a Bonferroni mixture of weighted
Simes tests. <em>Statistics in Medicine</em>, 35(22), 4041-4055.</p>
<p>Xi, D., Glimm, E., Maurer, W., and Bretz, F. (2017). A unified framework
for weighted parametric multiple test procedures.
<em>Biometrical Journal</em>, 59(5), 918-931.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># A graphical multiple comparison procedure with two primary hypotheses (H1</span></span></span>
<span class="r-in"><span><span class="co"># and H2) and two secondary hypotheses (H3 and H4)</span></span></span>
<span class="r-in"><span><span class="co"># See Figure 4 in Bretz et al. (2011a).</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span></span>
<span class="r-in"><span><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">delta</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">delta</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">delta</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">delta</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="graph_create.html">graph_create</a></span><span class="op">(</span><span class="va">hypotheses</span>, <span class="va">transitions</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">marginal_power</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">corr1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0.5</span>, nrow <span class="op">=</span> <span class="fl">2</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">corr1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">corr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">corr1</span>, <span class="fl">0.5</span> <span class="op">*</span> <span class="va">corr1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">*</span> <span class="va">corr1</span>, <span class="va">corr1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">success_fns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="co"># Probability to reject both H1 and H2</span></span></span>
<span class="r-in"><span>  `H1andH2` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  <span class="co"># Probability to reject both (H1 and H3) or (H2 and H4)</span></span></span>
<span class="r-in"><span>  `(H1andH3)or(H2andH4)` <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">&amp;</span> <span class="va">x</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Bonferroni tests</span></span></span>
<span class="r-in"><span><span class="co"># Reduce the number of simulations to save time for package compilation</span></span></span>
<span class="r-in"><span><span class="va">power_output</span> <span class="op">&lt;-</span> <span class="fu">graph_calculate_power</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">g</span>,</span></span>
<span class="r-in"><span>  <span class="va">alpha</span>,</span></span>
<span class="r-in"><span>  sim_corr <span class="op">=</span> <span class="va">corr</span>,</span></span>
<span class="r-in"><span>  sim_n <span class="op">=</span> <span class="fl">1e2</span>,</span></span>
<span class="r-in"><span>  power_marginal <span class="op">=</span> <span class="va">marginal_power</span>,</span></span>
<span class="r-in"><span>  sim_success <span class="op">=</span> <span class="va">success_fns</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Parametric tests for H1 and H2; Simes tests for H3 and H4</span></span></span>
<span class="r-in"><span><span class="co"># User-defined success: to reject H1 or H2; to reject H1 and H2</span></span></span>
<span class="r-in"><span><span class="co"># Reduce the number of simulations to save time for package compilation</span></span></span>
<span class="r-in"><span><span class="fu">graph_calculate_power</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">g</span>,</span></span>
<span class="r-in"><span>  <span class="va">alpha</span>,</span></span>
<span class="r-in"><span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parametric"</span>, <span class="st">"simes"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">corr1</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  sim_n <span class="op">=</span> <span class="fl">1e2</span>,</span></span>
<span class="r-in"><span>  sim_success <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="kw">function</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="va">.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">||</span> <span class="va">.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    <span class="kw">function</span><span class="op">(</span><span class="va">.</span><span class="op">)</span> <span class="va">.</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&amp;&amp;</span> <span class="va">.</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test parameters ($inputs) ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Initial graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Hypothesis weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Transition weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       H1  H2  H3  H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 0.0 0.5 0.5 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2 0.5 0.0 0.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3 0.0 1.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4 1.0 0.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Parametric testing correlation:     H1  H2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   H1 1.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                   H2 0.5 1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test types</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parametric: (H1, H2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        simes: (H3, H4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulation parameters ($inputs) ------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Testing 100 simulations with multivariate normal params:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      H1    H2    H3    H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Marginal power: 0.025 0.025 0.025 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Correlation:    H1 H2 H3 H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H1  1  0  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H2  0  1  0  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H3  0  0  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                H4  0  0  0  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Power calculation ($power) -----------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 H1   H2   H3   H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Local power: 0.02 0.01 0.00 0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Expected no. of rejections: 0.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Power to reject 1 or more: 0.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Power to reject all: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Success measure Power</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      .[1] || .[2]  0.03</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      .[1] &amp;&amp; .[2]  0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dong Xi, Ethan Brockmann, Gilead Sciences, Inc..</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

