<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Perform closed graphical multiple comparison procedures — graph_test_closure • graphicalMCP</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Perform closed graphical multiple comparison procedures — graph_test_closure"><meta name="description" content='Closed graphical multiple comparison procedures, or graphical multiple
comparison procedures based on the closure, generate the closure based on a
graph consisting of all intersection hypotheses. It tests each intersection
hypothesis and rejects an individual hypothesis if all intersection
hypotheses involving it have been rejected. An intersection hypothesis
represents the parameter space where individual null hypotheses involved are
true simultaneously.
For a graphical multiple comparison procedure with $m$ hypotheses, there are
\(2^m-1\) intersection hypotheses. For each intersection hypothesis, a test
type could be chosen to determine how to reject the intersection hypothesis.
Current choices of test types include Bonferroni, Simes and parametric. This
implementation offers a more general framework covering Bretz et al. (2011),
Lu (2016), and Xi et al. (2017). See vignette("closed-testing") for more
illustration of closed test procedures and interpretation of their outputs.'><meta property="og:description" content='Closed graphical multiple comparison procedures, or graphical multiple
comparison procedures based on the closure, generate the closure based on a
graph consisting of all intersection hypotheses. It tests each intersection
hypothesis and rejects an individual hypothesis if all intersection
hypotheses involving it have been rejected. An intersection hypothesis
represents the parameter space where individual null hypotheses involved are
true simultaneously.
For a graphical multiple comparison procedure with $m$ hypotheses, there are
\(2^m-1\) intersection hypotheses. For each intersection hypothesis, a test
type could be chosen to determine how to reject the intersection hypothesis.
Current choices of test types include Bonferroni, Simes and parametric. This
implementation offers a more general framework covering Bretz et al. (2011),
Lu (2016), and Xi et al. (2017). See vignette("closed-testing") for more
illustration of closed test procedures and interpretation of their outputs.'><meta property="og:image" content="https://gilead-biostats.github.io/graphicalMCP/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/graphicalMCP.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/glossary.html">Glossary</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/shortcut-testing.html">Sequentially rejective graphical multiple comparison procedures based on Bonferroni tests</a></li>
    <li><a class="dropdown-item" href="../articles/closed-testing.html">Graphical multiple comparison procedures based on the closure principle</a></li>
    <li><a class="dropdown-item" href="../articles/graph-examples.html">Common multiple comparison procedures illustrated using graphicalMCP</a></li>
    <li><a class="dropdown-item" href="../articles/comparisons.html">Comparisons with other packages</a></li>
    <li><a class="dropdown-item" href="../articles/generate-closure.html">Rationales to generate the closure and the weighting strategy of a graph</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Perform closed graphical multiple comparison procedures</h1>
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/graphicalMCP/blob/main/R/graph_test_closure.R" class="external-link"><code>R/graph_test_closure.R</code></a></small>
      <div class="d-none name"><code>graph_test_closure.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Closed graphical multiple comparison procedures, or graphical multiple
comparison procedures based on the closure, generate the closure based on a
graph consisting of all intersection hypotheses. It tests each intersection
hypothesis and rejects an individual hypothesis if all intersection
hypotheses involving it have been rejected. An intersection hypothesis
represents the parameter space where individual null hypotheses involved are
true simultaneously.</p>
<p>For a graphical multiple comparison procedure with $m$ hypotheses, there are
\(2^m-1\) intersection hypotheses. For each intersection hypothesis, a test
type could be chosen to determine how to reject the intersection hypothesis.
Current choices of test types include Bonferroni, Simes and parametric. This
implementation offers a more general framework covering Bretz et al. (2011),
Lu (2016), and Xi et al. (2017). See <code><a href="../articles/closed-testing.html">vignette("closed-testing")</a></code> for more
illustration of closed test procedures and interpretation of their outputs.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">graph_test_closure</span><span class="op">(</span></span>
<span>  <span class="va">graph</span>,</span>
<span>  <span class="va">p</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">graph</span><span class="op">$</span><span class="va">hypotheses</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"bonferroni"</span><span class="op">)</span>,</span>
<span>  test_corr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">test_types</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  test_values <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>An initial graph as returned by <code><a href="graph_create.html">graph_create()</a></code>.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>A numeric vector of p-values (unadjusted, raw), whose values should
be between 0 &amp; 1. The length should match the number of hypotheses in
<code>graph</code>.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>A numeric value of the overall significance level, which should
be between 0 &amp; 1. The default is 0.025 for one-sided hypothesis testing
problems; another common choice is 0.05 for two-sided hypothesis testing
problems. Note when parametric tests are used, only one-sided tests are
supported.</p></dd>


<dt id="arg-test-groups">test_groups<a class="anchor" aria-label="anchor" href="#arg-test-groups"></a></dt>
<dd><p>A list of numeric vectors specifying hypotheses to test
together. Grouping is needed to correctly perform Simes and parametric
tests.</p></dd>


<dt id="arg-test-types">test_types<a class="anchor" aria-label="anchor" href="#arg-test-types"></a></dt>
<dd><p>A character vector of test types to apply to each test
group. This is needed to correctly perform Simes and parametric
tests. The length should match the number of elements in <code>test_groups</code>.</p></dd>


<dt id="arg-test-corr">test_corr<a class="anchor" aria-label="anchor" href="#arg-test-corr"></a></dt>
<dd><p>(Optional) A list of numeric correlation matrices. Each
entry in the list should correspond to each test group. For a test group
using Bonferroni or Simes tests, its corresponding entry in <code>test_corr</code>
should be <code>NA</code>. For a test group using parametric tests, its
corresponding entry in <code>test_corr</code> should be a numeric correlation matrix
specifying the correlation between test statistics for hypotheses in this
test group. The length should match the number of elements in
<code>test_groups</code>.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical scalar specifying whether the details of the
adjusted p-value calculations should be included in results. When
<code>verbose = TRUE</code>, adjusted p-values are provided for each intersection
hypothesis. The default is <code>verbose = FALSE</code>.</p></dd>


<dt id="arg-test-values">test_values<a class="anchor" aria-label="anchor" href="#arg-test-values"></a></dt>
<dd><p>A logical scalar specifying whether adjusted significance
levels should be provided for each hypothesis. When <code>test_values = TRUE</code>,
it provides an equivalent way of performing graphical multiple comparison
procedures by comparing each p-value with its significance level. If the
p-value of a hypothesis is less than or equal to its significance level,
the hypothesis is rejected. The default is <code>test_values = FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>graph_report</code> object with a list of 4 elements:</p><ul><li><p><code>inputs</code> - Input parameters, which is a list of:</p><ul><li><p><code>graph</code> - Initial graph,</p></li>
<li><p><code>p</code> - (Unadjusted or raw) p-values,</p></li>
<li><p><code>alpha</code> - Overall significance level,</p></li>
<li><p><code>test_groups</code> - Groups of hypotheses for different types of tests,</p></li>
<li><p><code>test_types</code> - Different types of tests,</p></li>
<li><p><code>test_corr</code> - Correlation matrices for parametric tests.</p></li>
</ul></li>
<li><p><code>outputs</code> - Output parameters, which is a list of:</p><ul><li><p><code>adjusted_p</code> - Adjusted p-values,</p></li>
<li><p><code>rejected</code> - Rejected hypotheses,</p></li>
<li><p><code>graph</code> - Updated graph after deleting all rejected hypotheses.</p></li>
</ul></li>
<li><p><code>details</code> - Verbose outputs with adjusted p-values for intersection
hypotheses, if <code>verbose = TRUE</code>.</p></li>
<li><p><code>test_values</code> - Adjusted significance levels, if <code>test_values = TRUE</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details-for-test-specification">Details for test specification<a class="anchor" aria-label="anchor" href="#details-for-test-specification"></a></h2>


<p>Test specification includes three components: <code>test_groups</code>, <code>test_types</code>,
and <code>test_corr</code>. Alignment among entries in these components is important
for correct implementation. There are two ways to provide test specification.
The first approach is the "unnamed" approach, which assumes that all 3
components are ordered the same way, i.e., the $n$-th element of <code>test_types</code>
and <code>test_corr</code> should apply to the $n$-th group in <code>test_groups</code>. The
second "named" approach uses the name of each element of each component to
connect the element of <code>test_types</code> and <code>test_corr</code> with the correct element
of <code>test_groups</code>. Consistency should be ensured for correct implementation.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bretz, F., Posch, M., Glimm, E., Klinglmueller, F., Maurer, W., and
Rohmeyer, K. (2011). Graphical approaches for multiple comparison
procedures using weighted Bonferroni, Simes, or parametric tests.
<em>Biometrical Journal</em>, 53(6), 894-913.</p>
<p>Lu, K. (2016). Graphical approaches using a Bonferroni mixture of weighted
Simes tests. <em>Statistics in Medicine</em>, 35(22), 4041-4055.</p>
<p>Xi, D., Glimm, E., Maurer, W., and Bretz, F. (2017). A unified framework
for weighted parametric multiple test procedures.
<em>Biometrical Journal</em>, 59(5), 918-931.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="graph_test_shortcut.html">graph_test_shortcut()</a></code> for shortcut graphical multiple comparison
procedures.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># A graphical multiple comparison procedure with two primary hypotheses</span></span></span>
<span class="r-in"><span><span class="co"># (H1 and H2) and two secondary hypotheses (H3 and H4)</span></span></span>
<span class="r-in"><span><span class="co"># See Figure 4 in Bretz et al. (2011).</span></span></span>
<span class="r-in"><span><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">delta</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">delta</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">delta</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span> <span class="op">-</span> <span class="va">delta</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="graph_create.html">graph_create</a></span><span class="op">(</span><span class="va">hypotheses</span>, <span class="va">transitions</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.018</span>, <span class="fl">0.01</span>, <span class="fl">0.105</span>, <span class="fl">0.006</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.025</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Closed graphical multiple comparison procedure using Bonferroni tests</span></span></span>
<span class="r-in"><span><span class="co"># Same results as `graph_test_shortcut(g, p, alpha)`</span></span></span>
<span class="r-in"><span><span class="fu">graph_test_closure</span><span class="op">(</span><span class="va">g</span>, <span class="va">p</span>, <span class="va">alpha</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test parameters ($inputs) ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Initial graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Hypothesis weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Transition weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       H1  H2  H3  H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 0.0 0.5 0.5 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2 0.5 0.0 0.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3 0.0 1.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4 1.0 0.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           H1    H2    H3    H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Unadjusted p-values: 0.018 0.010 0.105 0.006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test types</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bonferroni: (H1, H2, H3, H4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test summary ($outputs) --------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Hypothesis Adj. P-value Reject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H1        0.024   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H2        0.020   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H3        0.105  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H4        0.024   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Final updated graph after removing rejected hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Hypothesis weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3:  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Transition weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      H1 H2 H3 H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3 NA NA  0 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Closed graphical multiple comparison procedure using parametric tests for</span></span></span>
<span class="r-in"><span><span class="co"># H1 and H2, and Bonferroni tests for H3 and H4</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">corr_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">graph_test_closure</span><span class="op">(</span></span></span>
<span class="r-in"><span>  graph <span class="op">=</span> <span class="va">g</span>,</span></span>
<span class="r-in"><span>  p <span class="op">=</span> <span class="va">p</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="va">alpha</span>,</span></span>
<span class="r-in"><span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"parametric"</span>, <span class="st">"bonferroni"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_corr <span class="op">=</span> <span class="va">corr_list</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test parameters ($inputs) ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Initial graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Hypothesis weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Transition weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       H1  H2  H3  H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 0.0 0.5 0.5 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2 0.5 0.0 0.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3 0.0 1.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4 1.0 0.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           H1    H2    H3    H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Unadjusted p-values: 0.018 0.010 0.105 0.006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Correlation matrix:     H1  H2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       H1 1.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       H2 0.5 1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test types</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parametric: (H1, H2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bonferroni: (H3, H4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test summary ($outputs) --------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Hypothesis Adj. P-value Reject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H1      0.02400   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H2      0.01871   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H3      0.10500  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H4      0.02400   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Final updated graph after removing rejected hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Hypothesis weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3:  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Transition weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      H1 H2 H3 H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3 NA NA  0 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># The "named" approach to obtain the same results</span></span></span>
<span class="r-in"><span><span class="co"># Note that "group2" appears before "group1" in `test_groups`</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">corr_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, group2 <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">graph_test_closure</span><span class="op">(</span></span></span>
<span class="r-in"><span>  graph <span class="op">=</span> <span class="va">g</span>,</span></span>
<span class="r-in"><span>  p <span class="op">=</span> <span class="va">p</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="va">alpha</span>,</span></span>
<span class="r-in"><span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, group2 <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>group2 <span class="op">=</span> <span class="st">"bonferroni"</span>, group1 <span class="op">=</span> <span class="st">"parametric"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_corr <span class="op">=</span> <span class="va">corr_list</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test parameters ($inputs) ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Initial graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Hypothesis weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Transition weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       H1  H2  H3  H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 0.0 0.5 0.5 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2 0.5 0.0 0.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3 0.0 1.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4 1.0 0.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           H1    H2    H3    H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Unadjusted p-values: 0.018 0.010 0.105 0.006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Correlation matrix:     H1  H2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       H1 1.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       H2 0.5 1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test types</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parametric: (H1, H2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   bonferroni: (H3, H4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test summary ($outputs) --------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Hypothesis Adj. P-value Reject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H1      0.02400   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H2      0.01871   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H3      0.10500  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H4      0.02400   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Final updated graph after removing rejected hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Hypothesis weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3:  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Transition weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      H1 H2 H3 H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3 NA NA  0 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Closed graphical multiple comparison procedure using parametric tests for</span></span></span>
<span class="r-in"><span><span class="co"># H1 and H2, and Simes tests for H3 and H4</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">graph_test_closure</span><span class="op">(</span></span></span>
<span class="r-in"><span>  graph <span class="op">=</span> <span class="va">g</span>,</span></span>
<span class="r-in"><span>  p <span class="op">=</span> <span class="va">p</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="va">alpha</span>,</span></span>
<span class="r-in"><span>  test_groups <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>group1 <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, group2 <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_types <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>group1 <span class="op">=</span> <span class="st">"parametric"</span>, group2 <span class="op">=</span> <span class="st">"simes"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test_corr <span class="op">=</span> <span class="va">corr_list</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test parameters ($inputs) ------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Initial graph</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Hypothesis weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2: 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4: 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Transition weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       H1  H2  H3  H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 0.0 0.5 0.5 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2 0.5 0.0 0.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3 0.0 1.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4 1.0 0.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Alpha = 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           H1    H2    H3    H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Unadjusted p-values: 0.018 0.010 0.105 0.006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Correlation matrix:     H1  H2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       H1 1.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       H2 0.5 1.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Test types</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   parametric: (H1, H2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        simes: (H3, H4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Test summary ($outputs) --------------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Hypothesis Adj. P-value Reject</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H1      0.02400   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H2      0.01871   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H3      0.10500  FALSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           H4      0.02400   TRUE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Final updated graph after removing rejected hypotheses</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Hypothesis weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3:  1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   --- Transition weights ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      H1 H2 H3 H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H1 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H2 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H3 NA NA  0 NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   H4 NA NA NA NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dong Xi, Ethan Brockmann, Gilead Sciences, Inc..</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

