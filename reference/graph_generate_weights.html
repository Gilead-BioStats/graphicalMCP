<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate the weighting strategy based on a graphical multiple comparison procedure — graph_generate_weights • graphicalMCP</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate the weighting strategy based on a graphical multiple comparison procedure — graph_generate_weights"><meta name="description" content="A graphical multiple comparison procedure defines a closed test procedure,
which tests each intersection hypothesis and reject an individual hypothesis
if all intersection hypotheses involving it have been rejected. An
intersection hypothesis represents the parameter space where individual null
hypotheses involved are true simultaneously.
The closure based on a graph consists of all updated graphs (corresponding
to intersection hypotheses) after all combinations of hypotheses are deleted.
For a graphical multiple comparison procedure with \(m\) hypotheses, there
are \(2^{m}-1\) updated graphs (intersection hypotheses), including the
initial graph (the overall intersection hypothesis). The weighting strategy
of this graph consists of hypothesis weights from all \(2^{m}-1\) updated
graphs (intersection hypotheses). The algorithm to derive the weighting
strategy is based on Algorithm 1 in Bretz et al. (2011)."><meta property="og:description" content="A graphical multiple comparison procedure defines a closed test procedure,
which tests each intersection hypothesis and reject an individual hypothesis
if all intersection hypotheses involving it have been rejected. An
intersection hypothesis represents the parameter space where individual null
hypotheses involved are true simultaneously.
The closure based on a graph consists of all updated graphs (corresponding
to intersection hypotheses) after all combinations of hypotheses are deleted.
For a graphical multiple comparison procedure with \(m\) hypotheses, there
are \(2^{m}-1\) updated graphs (intersection hypotheses), including the
initial graph (the overall intersection hypothesis). The weighting strategy
of this graph consists of hypothesis weights from all \(2^{m}-1\) updated
graphs (intersection hypotheses). The algorithm to derive the weighting
strategy is based on Algorithm 1 in Bretz et al. (2011)."><meta property="og:image" content="https://gilead-biostats.github.io/graphicalMCP/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">graphicalMCP</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/graphicalMCP.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/glossary.html">Glossary</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Function reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/shortcut-testing.html">Sequentially rejective graphical multiple comparison procedures based on Bonferroni tests</a></li>
    <li><a class="dropdown-item" href="../articles/closed-testing.html">Graphical multiple comparison procedures based on the closure principle</a></li>
    <li><a class="dropdown-item" href="../articles/graph-examples.html">Common multiple comparison procedures illustrated using graphicalMCP</a></li>
    <li><a class="dropdown-item" href="../articles/comparisons.html">Comparisons with other packages</a></li>
    <li><a class="dropdown-item" href="../articles/generate-closure.html">Rationales to generate the closure and the weighting strategy of a graph</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Gilead-BioStats/graphicalMCP/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate the weighting strategy based on a graphical multiple comparison procedure</h1>
      <small class="dont-index">Source: <a href="https://github.com/Gilead-BioStats/graphicalMCP/blob/v0.2.4/R/graph_generate_weights.R" class="external-link"><code>R/graph_generate_weights.R</code></a></small>
      <div class="d-none name"><code>graph_generate_weights.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A graphical multiple comparison procedure defines a closed test procedure,
which tests each intersection hypothesis and reject an individual hypothesis
if all intersection hypotheses involving it have been rejected. An
intersection hypothesis represents the parameter space where individual null
hypotheses involved are true simultaneously.</p>
<p>The closure based on a graph consists of all updated graphs (corresponding
to intersection hypotheses) after all combinations of hypotheses are deleted.
For a graphical multiple comparison procedure with \(m\) hypotheses, there
are \(2^{m}-1\) updated graphs (intersection hypotheses), including the
initial graph (the overall intersection hypothesis). The weighting strategy
of this graph consists of hypothesis weights from all \(2^{m}-1\) updated
graphs (intersection hypotheses). The algorithm to derive the weighting
strategy is based on Algorithm 1 in Bretz et al. (2011).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">graph_generate_weights</span><span class="op">(</span><span class="va">graph</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-graph">graph<a class="anchor" aria-label="anchor" href="#arg-graph"></a></dt>
<dd><p>An initial graph as returned by <code><a href="graph_create.html">graph_create()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A numeric matrix of all intersection hypotheses and their hypothesis
weights. For a graphical multiple comparison procedure with \(m\) hypotheses,
the number of rows is \(2^{m}-1\), each of which corresponds to an intersection
hypothesis. The number of columns is \(2\cdot m\). The first \(m\) columns
indicate which individual hypotheses are included in a given intersection
hypothesis and the second half of columns provide hypothesis weights for each
individual hypothesis for a given intersection hypothesis.</p>
    </div>
    <div class="section level2">
    <h2 id="performance">Performance<a class="anchor" aria-label="anchor" href="#performance"></a></h2>


<p>Generation of intersection hypotheses is closely related to the power set
of a given set of indices. As the number of hypotheses increases, the memory
and time usage can grow quickly (e.g., at a rate of \(O(2^n)\)). There are also
multiple ways to implement Algorithm 1 in Bretz et al. (2011). See
<code><a href="../articles/generate-closure.html">vignette("generate-closure")</a></code> for more information about generating
intersection hypotheses and comparisons of different approaches to calculate
weighting strategies.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Bretz, F., Posch, M., Glimm, E., Klinglmueller, F., Maurer, W., and
Rohmeyer, K. (2011). Graphical approaches for multiple comparison
procedures using weighted Bonferroni, Simes, or parametric tests.
<em>Biometrical Journal</em>, 53(6), 894-913.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="graph_test_closure.html">graph_test_closure()</a></code> for graphical multiple comparison procedures using
the closed test.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># A graphical multiple comparison procedure with two primary hypotheses (H1</span></span></span>
<span class="r-in"><span><span class="co"># and H2) and two secondary hypotheses (H3 and H4)</span></span></span>
<span class="r-in"><span><span class="co"># See Figure 1 in Bretz et al. (2011).</span></span></span>
<span class="r-in"><span><span class="va">hypotheses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">transitions</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="graph_create.html">graph_create</a></span><span class="op">(</span><span class="va">hypotheses</span>, <span class="va">transitions</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">graph_generate_weights</span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    H1 H2 H3 H4  H1  H2  H3  H4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1   1  1  1  1 0.5 0.5 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2   1  1  1  0 0.5 0.5 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3   1  1  0  1 0.5 0.5 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   1  1  0  0 0.5 0.5 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5   1  0  1  1 0.5 0.0 0.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   1  0  1  0 1.0 0.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7   1  0  0  1 0.5 0.0 0.0 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8   1  0  0  0 1.0 0.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9   0  1  1  1 0.0 0.5 0.5 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10  0  1  1  0 0.0 0.5 0.5 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11  0  1  0  1 0.0 1.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12  0  1  0  0 0.0 1.0 0.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13  0  0  1  1 0.0 0.0 0.5 0.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14  0  0  1  0 0.0 0.0 1.0 0.0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15  0  0  0  1 0.0 0.0 0.0 1.0</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dong Xi, Ethan Brockmann, Gilead Sciences, Inc..</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

